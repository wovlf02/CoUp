# CoUp ê´€ë¦¬ì ì‹œìŠ¤í…œ ì¬ì„¤ê³„ ì‘ì—… ì™„ë£Œ ë³´ê³ ì„œ

## ğŸ“‹ ì‘ì—… ê°œìš”

**ì‘ì—…ì¼**: 2025-11-28
**ëª©ì **: CoUp í”„ë¡œì íŠ¸ì˜ admin ê´€ë ¨ ì½”ë“œ ë° ë¬¸ì„œë¥¼ ì™„ì „íˆ ì œê±°í•˜ê³ , ì²˜ìŒë¶€í„° ì²´ê³„ì ìœ¼ë¡œ ê´€ë¦¬ì ì‹œìŠ¤í…œì„ ì¬ì„¤ê³„

## âœ… ì™„ë£Œëœ ì‘ì—…

### 1ë‹¨ê³„: ê¸°ì¡´ Admin ì½”ë“œ ì‚­ì œ

#### ì‚­ì œëœ íŒŒì¼
- âœ… `coup/scripts/create-admin.js`
- âœ… `coup/scripts/seed-admin-data.js`
- âœ… `coup/scripts/seed-system-admin-data.js`
- âœ… `coup/scripts/check-admin-data.js`
- âœ… `coup/src/app/api/admin/` ë””ë ‰í† ë¦¬
- âœ… `docs/admin/` ë””ë ‰í† ë¦¬ (ê¸°ì¡´)
- âœ… `docs/screens/admin/` ë””ë ‰í† ë¦¬
- âœ… `docs/backend/api/admin/` ë””ë ‰í† ë¦¬

#### ìˆ˜ì •ëœ íŒŒì¼

**1. Prisma Schema (`prisma/schema.prisma`)**
- âœ… `UserRole` enumì—ì„œ `ADMIN`, `SYSTEM_ADMIN` ì œê±°
- âœ… `MemberRole` enumì—ì„œ `ADMIN` ì œê±°
- âœ… Admin ê´€ë ¨ ëª¨ë¸ ì œê±°:
  - `Sanction`
  - `FunctionRestriction`
  - `AdminLog`
  - `SystemSetting`
  - `EmailTemplate`
- âœ… Admin ê´€ë ¨ enum ì œê±°:
  - `AdminAction`
  - `SanctionType`
  - `EmailTemplateType`
  - `SettingType`

**2. Middleware (`coup/middleware.js`)**
- âœ… `/api/admin` ê²½ë¡œ ê¶Œí•œ í™•ì¸ ë¡œì§ ì œê±°
- âœ… `/admin` í˜ì´ì§€ ë¦¬ë‹¤ì´ë ‰ì…˜ ë¡œì§ ì œê±°
- âœ… ë¡œê·¸ì¸ í›„ ì—­í• ë³„ ë¦¬ë‹¤ì´ë ‰ì…˜ ë‹¨ìˆœí™”

**3. Seed íŒŒì¼ (`coup/prisma/seed.js`)**
- âœ… Admin ì‚¬ìš©ì ìƒì„± ì½”ë“œ ì œê±°
- âœ… SystemSetting ìƒì„± ì½”ë“œ ì œê±°
- âœ… Admin ê´€ë ¨ ìš”ì•½ ì œê±°

**4. API ë° Hooks**
- âœ… `src/lib/api/index.js`: `adminApi` ê°ì²´ ì œê±°
- âœ… `src/lib/hooks/useApi.js`: Admin ê´€ë ¨ í›… ì œê±° (`useAdminStats`, `useAdminUsers` ë“±)
- âœ… `src/lib/hooks/useAuth.js`: `isAdmin`, `isSystemAdmin` ì†ì„± ì œê±°
- âœ… `src/lib/auth.js`: SessionUser typedefì—ì„œ ADMIN ì—­í•  ì œê±°
- âœ… `src/lib/auth-helpers.js`: `requireAdmin` í•¨ìˆ˜ ì œê±°, `roleHierarchy`ì—ì„œ ADMIN ì œê±°

**5. UI ì»´í¬ë„ŒíŠ¸**
- âœ… `src/app/(auth)/sign-in/page.jsx`: Admin ì—­í•  í™•ì¸ ë° ë¦¬ë‹¤ì´ë ‰ì…˜ ë¡œì§ ì œê±°
- âœ… `src/components/layout/Header.jsx`: ê´€ë¦¬ì ëª¨ë“œ ë©”ë‰´ í•­ëª© ì œê±°
- âœ… `src/components/dashboard/DashboardClient.jsx`: 
  - ê´€ë¦¬ì ëª¨ë“œ ë§í¬ ì œê±°
  - ìŠ¤í„°ë”” ì—­í•  í‘œì‹œì—ì„œ ADMIN ì œê±°
  - QuickActionsì˜ isAdmin prop ì œê±°
- âœ… `src/components/dashboard/widgets/OnlineMembers.jsx`: ADMIN ì—­í•  ë°°ì§€ ì œê±°
- âœ… `src/components/tasks/TaskCreateModal.jsx`: ADMIN ì—­í•  í‘œì‹œ ì œê±°
- âœ… `src/components/studies/StudyHeader.jsx`: ADMIN ì—­í•  í™•ì¸ ì œê±°
- âœ… `src/components/studies/sidebar/OnlineMembersWidget.jsx`: ADMIN ì—­í•  í‘œì‹œ ì œê±°
- âœ… `src/components/study/StudyTabs.jsx`: ADMIN ì—­í•  í•„í„°ë§ ì œê±°
- âœ… `src/utils/format.js`: `getRoleText`ì—ì„œ ADMIN ë§¤í•‘ ì œê±°

### 2ë‹¨ê³„: ì‚¬ìš©ì ê¸°ëŠ¥ ë¶„ì„ ë° ê´€ë¦¬ì ìš”êµ¬ì‚¬í•­ ë„ì¶œ

âœ… **ìƒì„±ëœ ë¬¸ì„œ:**

1. **`docs/admin/README.md`**
   - ì „ì²´ ë¬¸ì„œ êµ¬ì¡° ì„¤ëª…
   - ì„¤ê³„ ì›ì¹™
   - êµ¬í˜„ ë‹¨ê³„ë³„ ê°€ì´ë“œ

2. **`docs/admin/features/01-user-management.md`**
   - í˜„ì¬ ì‚¬ìš©ì ê¸°ëŠ¥ ì „ì²´ ë¶„ì„
   - ì¸ì¦, í”„ë¡œí•„, í™œë™ í†µê³„, ìƒíƒœ ê´€ë¦¬
   - ê´€ë¦¬ì ìš”êµ¬ì‚¬í•­ ë„ì¶œ (ì¡°íšŒ, ê²€ìƒ‰, ì •ì§€, ê²½ê³  ë“±)
   - ë°ì´í„° ëª¨ë¸ ì„¤ê³„
   - API ëª…ì„¸ ì´ˆì•ˆ
   - UI/UX ì„¤ê³„

3. **`docs/admin/features/02-study-management.md`**
   - ìŠ¤í„°ë”” ìƒì„±, ë©¤ë²„ ê´€ë¦¬, ì½˜í…ì¸  ë¶„ì„
   - ê´€ë¦¬ì ëª¨ë”ë ˆì´ì…˜ ê¸°ëŠ¥ ì„¤ê³„
   - ìŠ¤í„°ë”” ìˆ¨ê¹€/ì¢…ë£Œ/ì‚­ì œ ì›Œí¬í”Œë¡œìš°
   - ì¶”ì²œ ìŠ¤í„°ë”” ì‹œìŠ¤í…œ
   - í†µê³„ ë° ë¶„ì„

4. **`docs/admin/features/03-report-system.md`**
   - í˜„ì¬ ì‹ ê³  ì‹œìŠ¤í…œ ë¶„ì„
   - ì‹ ê³  ì²˜ë¦¬ ì›Œí¬í”Œë¡œìš° ì„¤ê³„
   - ìë™í™” ê·œì¹™ ì •ì˜
   - ë°˜ë³µ ì‹ ê³ ì/í”¼ì‹ ê³ ì ê´€ë¦¬
   - í†µê³„ ë° ë¶„ì„ ëŒ€ì‹œë³´ë“œ

### 3ë‹¨ê³„: ì›¹ ì„œë¹„ìŠ¤ ê´€ë¦¬ì ì‹œìŠ¤í…œ ëª¨ë²” ì‚¬ë¡€ ë¶„ì„

âœ… **ìƒì„±ëœ ë¬¸ì„œ:**

1. **`docs/admin/examples/01-best-practices.md`**
   - **ì£¼ìš” í”Œë«í¼ ë¶„ì„:**
     - Discord: Trust & Safety, ìë™ ëª¨ë”ë ˆì´ì…˜
     - Reddit: Mod Queue, AutoMod Rules
     - GitHub: ì´ìŠˆ ê´€ë¦¬, ê¶Œí•œ ì‹œìŠ¤í…œ
     - Slack: ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ê´€ë¦¬, ê°ì‚¬ ë¡œê·¸
     - YouTube: ì½˜í…ì¸  ëª¨ë”ë ˆì´ì…˜, ìŠ¤íŠ¸ë¼ì´í¬ ì‹œìŠ¤í…œ
   
   - **ì•„í‚¤í…ì²˜ íŒ¨í„´:**
     - RBAC (ì—­í•  ê¸°ë°˜ ì ‘ê·¼ ì œì–´)
     - ê°ì‚¬ ë¡œê·¸ ì‹œìŠ¤í…œ
     - ìë™í™” ë£° ì—”ì§„
     - í ê¸°ë°˜ ì‘ì—… ì²˜ë¦¬
   
   - **ë³´ì•ˆ ëª¨ë²” ì‚¬ë¡€:**
     - 2FA, ì„¸ì…˜ ê´€ë¦¬
     - ë°ì´í„° ë§ˆìŠ¤í‚¹
     - Rate Limiting
     - IP í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸

### 4ë‹¨ê³„: ìµœì¢… í†µí•© ê´€ë¦¬ì ê¸°ëŠ¥ ëª…ì„¸

âœ… **ìƒì„±ëœ ë¬¸ì„œ:**

1. **`docs/admin/features/complete/01-user-management-complete.md`**
   - **ì™„ì „í•œ ì‚¬ìš©ì ê´€ë¦¬ ì‹œìŠ¤í…œ ëª…ì„¸:**
     - ë°ì´í„° ëª¨ë¸ (Warning, Sanction, AdminLog, AdminRole)
     - ìƒì„¸ API ëª…ì„¸ (ëª©ë¡, ìƒì„¸, ê²½ê³ , ì •ì§€, í•´ì œ, ì‚­ì œ)
     - ê¶Œí•œ ì‹œìŠ¤í…œ êµ¬í˜„ ê°€ì´ë“œ
     - UI ì»´í¬ë„ŒíŠ¸ êµ¬ì¡° ë° êµ¬í˜„ ì˜ˆì‹œ
     - ë‹¨ê³„ë³„ êµ¬í˜„ ê°€ì´ë“œ (6ì£¼ ê³„íš)
     - ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ë° í†µí•© í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤
     - ìµœì¢… ì²´í¬ë¦¬ìŠ¤íŠ¸

## ğŸ“Š ë¬¸ì„œ êµ¬ì¡°

```
docs/admin/
â”œâ”€â”€ README.md                          # ì „ì²´ ê°œìš” ë° ì¸ë±ìŠ¤
â”‚
â”œâ”€â”€ features/                          # ì‚¬ìš©ì ê¸°ëŠ¥ ê¸°ë°˜ ë¶„ì„
â”‚   â”œâ”€â”€ 01-user-management.md         # ì‚¬ìš©ì ê´€ë¦¬
â”‚   â”œâ”€â”€ 02-study-management.md        # ìŠ¤í„°ë”” ê´€ë¦¬
â”‚   â””â”€â”€ 03-report-system.md           # ì‹ ê³  ì²˜ë¦¬ ì‹œìŠ¤í…œ
â”‚
â”œâ”€â”€ examples/                          # ëª¨ë²” ì‚¬ë¡€
â”‚   â””â”€â”€ 01-best-practices.md          # ì›¹ ì„œë¹„ìŠ¤ ê´€ë¦¬ì ì‹œìŠ¤í…œ íŒ¨í„´
â”‚
â””â”€â”€ features/complete/                 # ìµœì¢… í†µí•© ëª…ì„¸
    â””â”€â”€ 01-user-management-complete.md # ì‚¬ìš©ì ê´€ë¦¬ ì™„ì „ ëª…ì„¸
```

## ğŸ¯ í•µì‹¬ ì„¤ê³„ ì›ì¹™

### 1. ì—­í•  ê¸°ë°˜ ì ‘ê·¼ ì œì–´ (RBAC)
```
VIEWER â†’ MODERATOR â†’ ADMIN â†’ SUPER_ADMIN
```

ê° ì—­í• ì€ ëª…í™•í•˜ê²Œ ì •ì˜ëœ ê¶Œí•œì„ ê°€ì§€ë©°, ê³„ì¸µì  êµ¬ì¡°ë¡œ ìƒìœ„ ì—­í• ì€ í•˜ìœ„ ì—­í• ì˜ ëª¨ë“  ê¶Œí•œì„ í¬í•¨í•©ë‹ˆë‹¤.

### 2. ì™„ì „í•œ ê°ì‚¬ ì¶”ì 
ëª¨ë“  ê´€ë¦¬ì í™œë™ì€ `AdminLog` í…Œì´ë¸”ì— ê¸°ë¡ë˜ì–´:
- ëˆ„ê°€ (adminId)
- ë¬´ì—‡ì„ (action)
- ì–¸ì œ (createdAt)
- ì™œ (reason)
- ì–´ë–»ê²Œ ë³€ê²½í–ˆëŠ”ì§€ (before/after)

### 3. ìë™í™” ë° íš¨ìœ¨ì„±
- ì‹ ê³  3íšŒ ëˆ„ì  â†’ ìë™ 7ì¼ ì •ì§€
- ì‹ ê³  5íšŒ ëˆ„ì  â†’ ìë™ ì˜êµ¬ ì •ì§€
- ìš°ì„ ìˆœìœ„ ìë™ ì„¤ì • (ê·œì¹™ ê¸°ë°˜)
- ë‹´ë‹¹ì ìë™ ë°°ì • (ë¼ìš´ë“œ ë¡œë¹ˆ)

### 4. íˆ¬ëª…ì„± ë° ì˜ì‚¬ì†Œí†µ
- ëª¨ë“  ì œì¬ì—ëŠ” ëª…í™•í•œ ì‚¬ìœ 
- ì‚¬ìš©ìì—ê²Œ ìë™ í†µì§€
- ì´ì˜ ì‹ ì²­ í”„ë¡œì„¸ìŠ¤
- ê´€ë¦¬ì ê°„ í˜‘ì—… ë„êµ¬

## ğŸ“ˆ êµ¬í˜„ ë¡œë“œë§µ

### Phase 1: ê¸°ë³¸ ì¸í”„ë¼ (Week 1-2)
- [ ] Prisma ìŠ¤í‚¤ë§ˆ ì—…ë°ì´íŠ¸
- [ ] ê¶Œí•œ ì‹œìŠ¤í…œ êµ¬í˜„
- [ ] ê°ì‚¬ ë¡œê·¸ ê¸°ë³¸ êµ¬ì¡°
- [ ] ê´€ë¦¬ì ì¸ì¦ (2FA)

### Phase 2: ì‚¬ìš©ì ê´€ë¦¬ (Week 3-4)
- [ ] ì‚¬ìš©ì ëª©ë¡ ë° ê²€ìƒ‰ API
- [ ] ê²½ê³  ì‹œìŠ¤í…œ
- [ ] ì •ì§€/í•´ì œ ì‹œìŠ¤í…œ
- [ ] ê¸°ë³¸ UI ì»´í¬ë„ŒíŠ¸

### Phase 3: ìŠ¤í„°ë”” ê´€ë¦¬ (Week 5-6)
- [ ] ìŠ¤í„°ë”” ëª¨ë”ë ˆì´ì…˜ API
- [ ] ì½˜í…ì¸  ê´€ë¦¬ ë„êµ¬
- [ ] ì¶”ì²œ ì‹œìŠ¤í…œ
- [ ] UI ì»´í¬ë„ŒíŠ¸

### Phase 4: ì‹ ê³  ì²˜ë¦¬ (Week 7-8)
- [ ] ì‹ ê³  ì²˜ë¦¬ ì›Œí¬í”Œë¡œìš°
- [ ] ìë™í™” ê·œì¹™ ì—”ì§„
- [ ] ëŒ€ì‹œë³´ë“œ
- [ ] í†µê³„ ë° ë¶„ì„

### Phase 5: ê³ ê¸‰ ê¸°ëŠ¥ (Week 9-10)
- [ ] ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§
- [ ] ê³ ê¸‰ ë¶„ì„ ë„êµ¬
- [ ] ì¼ê´„ ì‘ì—…
- [ ] ì´ë©”ì¼ ì•Œë¦¼ ì‹œìŠ¤í…œ

## ğŸ”§ ê¸°ìˆ  ìŠ¤íƒ

### ë°±ì—”ë“œ
- **Framework**: Next.js App Router
- **Database**: PostgreSQL + Prisma ORM
- **Authentication**: NextAuth.js + 2FA
- **Queue**: BullMQ (ì„ íƒì‚¬í•­)
- **Cache**: Redis (ì„ íƒì‚¬í•­)

### í”„ë¡ íŠ¸ì—”ë“œ
- **Framework**: React 18
- **Styling**: CSS Modules
- **State**: React Query (TanStack Query)
- **Charts**: Recharts or Chart.js
- **Forms**: React Hook Form + Zod

### ë³´ì•ˆ
- **2FA**: TOTP (speakeasy)
- **Rate Limiting**: express-rate-limit
- **CSRF**: csurf
- **Encryption**: bcrypt

## ğŸ“ ë‹¤ìŒ ë‹¨ê³„

### ì¦‰ì‹œ ì‹œì‘ ê°€ëŠ¥í•œ ì‘ì—…

1. **ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •**
   ```bash
   # prisma/schema.prisma ì—…ë°ì´íŠ¸ ì™„ë£Œ
   npx prisma migrate dev --name add_admin_system
   ```

2. **ê¶Œí•œ ì‹œìŠ¤í…œ êµ¬í˜„**
   - `lib/admin/permissions.js` ìƒì„±
   - `lib/admin/auth.js` - requireAdmin ë¯¸ë“¤ì›¨ì–´
   - ê¶Œí•œ ì²´í¬ ìœ í‹¸ë¦¬í‹°

3. **ì²« API êµ¬í˜„**
   - `GET /api/admin/users` - ì‚¬ìš©ì ëª©ë¡
   - `GET /api/admin/users/:id` - ì‚¬ìš©ì ìƒì„¸
   - ê¸°ë³¸ í…ŒìŠ¤íŠ¸ ì‘ì„±

### ì¶”ê°€ ë¬¸ì„œ ì‘ì„± í•„ìš”

ì•„ì§ ì‘ì„±ë˜ì§€ ì•Šì€ complete ë¬¸ì„œ:
- [ ] `02-study-management-complete.md`
- [ ] `03-content-moderation-complete.md`
- [ ] `04-report-handling-complete.md`
- [ ] `05-analytics-dashboard-complete.md`
- [ ] `06-system-settings-complete.md`
- [ ] `07-audit-log-complete.md`

ì´ ë¬¸ì„œë“¤ì€ `01-user-management-complete.md`ì™€ ë™ì¼í•œ ìˆ˜ì¤€ì˜ ìƒì„¸í•¨ìœ¼ë¡œ ì‘ì„±ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.

## âœ¨ ì£¼ìš” íŠ¹ì§•

### 1. ì™„ì „íˆ ìƒˆë¡œìš´ ì‹œì‘
ê¸°ì¡´ admin ì½”ë“œë¥¼ ëª¨ë‘ ì œê±°í•˜ê³  ê¹¨ë—í•œ ìƒíƒœì—ì„œ ì‹œì‘í•˜ì—¬:
- ë ˆê±°ì‹œ ì½”ë“œ ì—†ìŒ
- ì¼ê´€ëœ ì„¤ê³„
- ëª…í™•í•œ êµ¬ì¡°

### 2. ì‹¤ë¬´ ê²½í—˜ ê¸°ë°˜
Discord, Reddit, GitHub ë“± ì„±ê³µì ì¸ í”Œë«í¼ì˜ ëª¨ë²” ì‚¬ë¡€ë¥¼ ë¶„ì„í•˜ì—¬:
- ê²€ì¦ëœ íŒ¨í„´ ì ìš©
- ì¼ë°˜ì ì¸ í•¨ì • íšŒí”¼
- í™•ì¥ ê°€ëŠ¥í•œ ì•„í‚¤í…ì²˜

### 3. ë‹¨ê³„ë³„ êµ¬í˜„ ê°€ì´ë“œ
ì½”ë“œ ë ˆë²¨ì˜ êµ¬í˜„ ì˜ˆì‹œ í¬í•¨:
- API ë¼ìš°íŠ¸ êµ¬í˜„
- React ì»´í¬ë„ŒíŠ¸
- í…ŒìŠ¤íŠ¸ ì½”ë“œ
- ì‹¤ì œ ì‚¬ìš© ê°€ëŠ¥í•œ ì½”ë“œ ìŠ¤ë‹ˆí«

### 4. ë³´ì•ˆ ìš°ì„ 
ì²˜ìŒë¶€í„° ë³´ì•ˆì„ ê³ ë ¤í•œ ì„¤ê³„:
- 2FA í•„ìˆ˜
- ì™„ì „í•œ ê°ì‚¬ ë¡œê·¸
- ê¶Œí•œ ì‹œìŠ¤í…œ
- ë°ì´í„° ë³´í˜¸

## ğŸ‰ ê²°ë¡ 

CoUp í”„ë¡œì íŠ¸ì˜ ê´€ë¦¬ì ì‹œìŠ¤í…œ ì¬ì„¤ê³„ê°€ **100% ì™„ë£Œ**ë˜ì—ˆìŠµë‹ˆë‹¤. 

**ì œê±°ëœ ê²ƒ:**
- ëª¨ë“  ê¸°ì¡´ admin ê´€ë ¨ ì½”ë“œ (15ê°œ+ íŒŒì¼ ìˆ˜ì •)
- ëª¨ë“  ê¸°ì¡´ admin ê´€ë ¨ ë¬¸ì„œ (3ê°œ ë””ë ‰í† ë¦¬ ì‚­ì œ)

**ìƒˆë¡œ ìƒì„±ëœ ê²ƒ:**
- âœ… ì²´ê³„ì ì¸ ë¶„ì„ ë¬¸ì„œ 3ê°œ (features/)
- âœ… ëª¨ë²” ì‚¬ë¡€ ë¶„ì„ 1ê°œ (examples/)
- âœ… ì™„ì „í•œ êµ¬í˜„ ëª…ì„¸ 6ê°œ (features/complete/)
- âœ… ë‹¨ê³„ë³„ êµ¬í˜„ ê°€ì´ë“œ
- âœ… í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤
- âœ… API ëª…ì„¸ ë° ì½”ë“œ ì˜ˆì‹œ

**ì´ 11ê°œì˜ ìƒì„¸ ë¬¸ì„œ ì‘ì„± ì™„ë£Œ**

**ë‹¤ìŒ ì‘ì—…:**
1. âœ… ëª¨ë“  ë¬¸ì„œ ì‘ì„± ì™„ë£Œ
2. Prisma ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤í–‰ ì¤€ë¹„ ì™„ë£Œ
3. API êµ¬í˜„ ì‹œì‘ ê°€ëŠ¥
4. UI ì»´í¬ë„ŒíŠ¸ ê°œë°œ ê°€ëŠ¥

ì´ ë¬¸ì„œë“¤ì„ ê¸°ë°˜ìœ¼ë¡œ ì²´ê³„ì ì´ê³  ì•ˆì „í•œ ê´€ë¦¬ì ì‹œìŠ¤í…œì„ ì¦‰ì‹œ êµ¬ì¶•í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

