# 관리자 시스템 테스트 체크리스트

> **테스트 대상**: Phase 1 - 사용자 관리 시스템  
> **테스트 일시**: 2025-11-27

---

## 📋 사전 준비

### 1. 관리자 계정 생성
```bash
cd coup
node scripts/create-admin.js admin@coup.com ADMIN
```

- [ ] 스크립트 실행 성공
- [ ] "✅ 기존 사용자의 역할이 업데이트되었습니다" 또는 "✅ 새 관리자 계정이 생성되었습니다" 메시지 확인

### 2. 서버 시작
```bash
npm run dev
```

- [ ] http://localhost:3000 접속 가능
- [ ] 콘솔에 에러 없음

---

## 🔐 인증 & 접근 제어 테스트

### 일반 사용자 (USER)

#### 로그인 & 네비게이션
- [ ] 일반 사용자로 로그인
- [ ] 대시보드 정상 표시
- [ ] 대시보드 헤더에 **관리자 모드 버튼 없음** ✅
- [ ] Header 프로필 → **관리자 모드 메뉴 없음** ✅

#### 직접 접근 시도
- [ ] 브라우저에서 `/admin/dashboard` 입력
- [ ] → `/admin/unauthorized` 페이지로 리다이렉트 ✅
- [ ] 접근 거부 메시지 표시 ("접근 권한이 없습니다")
- [ ] [이전 페이지] 버튼 작동
- [ ] [대시보드로 이동] 버튼 작동

#### API 직접 호출 시도 (선택)
```javascript
fetch('/api/admin/users')
  .then(r => r.json())
  .then(console.log)
```
- [ ] → `{ success: false, error: "관리자 권한이 필요합니다" }` 응답
- [ ] HTTP 상태 코드: 403

---

### 관리자 (ADMIN)

#### 로그인 & 네비게이션
- [ ] 관리자로 로그인 (`admin@coup.com`)
- [ ] 대시보드 정상 표시
- [ ] 대시보드 헤더에 **🛡️ 관리자 모드 버튼 보임** ✅
- [ ] Header 프로필 → **🛡️ 관리자 모드 메뉴 보임** ✅

#### 관리자 모드 접속
- [ ] 대시보드에서 [관리자 모드] 버튼 클릭
- [ ] → `/admin/dashboard` 정상 접속 ✅
- [ ] 관리자 레이아웃 표시 (CoUp Admin 헤더)

---

## 📊 관리자 대시보드 테스트

### 페이지 로딩
- [ ] `/admin/dashboard` 접속
- [ ] 로딩 상태 표시
- [ ] 데이터 정상 로드

### 핵심 지표 카드
- [ ] **전체 사용자** 카드 표시 (활성 수 포함)
- [ ] **활성 사용자** 카드 표시 (정지 수 포함)
- [ ] **전체 스터디** 카드 표시 (활성 수 포함)
- [ ] **미처리 신고** 카드 표시 (오늘 신고 수 포함)

### 최근 활동
- [ ] **미처리 신고 목록** (최근 5건)
  - [ ] 우선순위 표시 (URGENT, HIGH 등)
  - [ ] 대상 타입 표시 (USER, STUDY, MESSAGE)
  - [ ] [처리 →] 링크 표시
- [ ] **최근 제재 내역** (최근 5건)
  - [ ] 제재 타입 아이콘 (⚠️ 경고, ⛔ 정지, ✅ 해제)
  - [ ] 제재 사유 표시
  - [ ] 일시 표시

### 주간 추이 그래프
- [ ] 최근 7일 데이터 표시
- [ ] 날짜별 사용자 가입 수 (파란색 바)
- [ ] 날짜별 스터디 생성 수 (초록색 바)
- [ ] 날짜별 신고 수 (빨간색 바)

### 네비게이션
- [ ] 상단 메뉴: [대시보드] [사용자 관리] [스터디 관리] [신고 관리]
- [ ] [사용자 관리] 클릭 → `/admin/users` 이동
- [ ] [사용자 모드로] 클릭 → `/dashboard` 이동

---

## 👥 사용자 관리 테스트

### 사용자 목록 페이지 (`/admin/users`)

#### 기본 표시
- [ ] 페이지 로딩
- [ ] 요약 통계 표시 ("총 X명 | 활성: X | 정지: X | 탈퇴: X")
- [ ] 사용자 테이블 표시
  - [ ] 프로필 이미지/초성
  - [ ] 이름, 이메일
  - [ ] 역할 뱃지 (USER, ADMIN 등)
  - [ ] 상태 뱃지 (활성, 정지, 탈퇴)
  - [ ] 가입일
  - [ ] 최근 로그인
  - [ ] 참여 스터디 수
  - [ ] [상세보기] 링크

#### 검색 기능
- [ ] 검색창에 이름 입력 → [검색] 버튼
- [ ] 결과 필터링 확인
- [ ] 검색창에 이메일 일부 입력 → 결과 필터링
- [ ] [초기화] 버튼 → 필터 초기화

#### 필터 기능
- [ ] 상태 필터: "활성" 선택 → 활성 사용자만 표시
- [ ] 상태 필터: "정지" 선택 → 정지 사용자만 표시
- [ ] 역할 필터: "ADMIN" 선택 → 관리자만 표시
- [ ] 여러 필터 조합 테스트

#### 페이지네이션
- [ ] 페이지 번호 버튼 표시
- [ ] 다음 페이지 클릭 → 데이터 변경
- [ ] 페이지 정보 표시 ("전체 X개 중 Y-Z")

---

### 사용자 상세 페이지 (`/admin/users/:userId`)

#### 기본 정보
- [ ] [상세보기] 클릭 → 상세 페이지 이동
- [ ] 프로필 사진 또는 초성 표시
- [ ] 이름, 이메일 표시
- [ ] 사용자 ID 표시
- [ ] 역할 뱃지, 상태 뱃지 표시
- [ ] 가입 경로 표시 (이메일/Google/GitHub)
- [ ] 가입일, 최근 로그인 표시

#### 정지된 사용자인 경우
- [ ] 정지 사유 빨간색으로 표시
- [ ] 정지 기간 표시 ("YYYY-MM-DD까지")

#### 활동 통계 카드
- [ ] **참여 스터디** 수 표시
- [ ] **작성 공지** 수 표시
- [ ] **업로드 파일** 수 표시
- [ ] **채팅 메시지** 수 표시

#### 제재 이력
- [ ] 경고 횟수 표시 (노란색)
- [ ] 정지 횟수 표시 (빨간색)
- [ ] 최근 제재 5건 표시
  - [ ] 제재 타입 아이콘
  - [ ] 제재 사유
  - [ ] 정지 기간 (정지인 경우)
  - [ ] 일시

#### 신고 이력
- [ ] 신고당한 횟수 (빨간색 카드)
- [ ] 신고한 횟수 (파란색 카드)

---

### 제재 기능 테스트

#### 경고 발송
- [ ] [⚠️ 경고] 버튼 클릭
- [ ] 모달 표시: "경고 발송"
- [ ] 사유 입력란 (10-200자)
- [ ] 글자 수 카운터 표시
- [ ] 사유 10자 미만 입력 → [확인] 클릭 → 에러 메시지
- [ ] 사유 정상 입력 (예: "부적절한 언어 사용으로 인한 경고입니다")
- [ ] [확인] 클릭
- [ ] 성공 메시지: "경고가 발송되었습니다 (누적: X회)"
- [ ] 페이지 새로고침
- [ ] 제재 이력에 경고 추가 확인

#### 사용자 정지
- [ ] [⛔ 정지] 버튼 클릭
- [ ] 모달 표시: "사용자 정지"
- [ ] 정지 기간 선택 (1일/3일/7일/30일/영구)
- [ ] "3일" 선택
- [ ] 사유 입력 (예: "부적절한 콘텐츠 게시로 인한 3일 정지")
- [ ] [확인] 클릭
- [ ] 성공 메시지: "사용자가 정지되었습니다"
- [ ] 페이지 새로고침
- [ ] 상태 뱃지 "정지"로 변경 확인
- [ ] 정지 사유 표시 확인
- [ ] 정지 기간 표시 확인

#### 정지된 사용자 확인
- [ ] 정지된 사용자로 로그인 시도
- [ ] → 로그인 차단 또는 에러 메시지 확인

#### 정지 해제
- [ ] 정지된 사용자 상세 페이지 접속
- [ ] [✅ 정지 해제] 버튼 표시 확인 (정지 버튼 대신)
- [ ] [정지 해제] 버튼 클릭
- [ ] 모달 표시: "정지 해제"
- [ ] 해제 사유 입력 (예: "재심 요청 승인으로 정지 해제")
- [ ] [확인] 클릭
- [ ] 성공 메시지: "정지가 해제되었습니다"
- [ ] 페이지 새로고침
- [ ] 상태 뱃지 "활성"으로 변경 확인
- [ ] [⛔ 정지] 버튼으로 변경 확인

#### 정지 해제 후 사용자 확인
- [ ] 해제된 사용자로 로그인
- [ ] 정상 로그인 확인
- [ ] 대시보드 접속 확인

---

## 📝 제재 이력 조회 테스트

### API 직접 테스트 (선택)
```javascript
// 브라우저 콘솔에서
fetch('/api/admin/users/:userId/sanctions')
  .then(r => r.json())
  .then(console.log)
```

- [ ] 제재 목록 반환
- [ ] 페이지네이션 정보 포함
- [ ] 요약 통계 포함 (warningCount, suspendCount 등)

---

## 🚀 성능 & UX 테스트

### 로딩 상태
- [ ] 페이지 로딩 시 스켈레톤 또는 로딩 인디케이터 표시
- [ ] API 호출 중 버튼 비활성화 (중복 클릭 방지)

### 반응형
- [ ] 데스크탑 (1920px): 레이아웃 정상
- [ ] 태블릿 (768px): 레이아웃 적응
- [ ] 모바일 (375px): 카드가 세로로 쌓임

### 에러 처리
- [ ] 네트워크 오류 시 에러 메시지 표시
- [ ] 존재하지 않는 사용자 ID 접근 → 404 또는 에러 페이지
- [ ] 권한 없는 API 호출 → 403 에러 메시지

---

## 🔍 데이터베이스 확인

### Sanction 테이블
```sql
SELECT * FROM "Sanction" ORDER BY "createdAt" DESC LIMIT 5;
```

- [ ] 경고 기록 존재
- [ ] 정지 기록 존재
- [ ] 정지 해제 기록 존재
- [ ] adminId, reason 등 모든 필드 정상

### User 테이블
```sql
SELECT id, email, status, "suspendedUntil", "suspendReason" 
FROM "User" 
WHERE status = 'SUSPENDED';
```

- [ ] 정지된 사용자 상태 확인
- [ ] suspendedUntil 날짜 정확
- [ ] suspendReason 기록됨

### AdminLog 테이블
```sql
SELECT * FROM "AdminLog" ORDER BY "createdAt" DESC LIMIT 10;
```

- [ ] 모든 제재 행위가 기록됨
- [ ] action, targetType, targetId 정확
- [ ] ipAddress, userAgent 기록됨

---

## ✅ 최종 체크리스트

### 필수 기능
- [ ] 관리자 계정 생성 스크립트 작동
- [ ] 일반 사용자는 관리자 페이지 접근 불가
- [ ] 관리자는 관리자 페이지 접근 가능
- [ ] 대시보드 데이터 정상 표시
- [ ] 사용자 목록 조회 가능
- [ ] 검색 & 필터 작동
- [ ] 사용자 상세 정보 표시
- [ ] 경고 발송 가능
- [ ] 사용자 정지 가능
- [ ] 정지 해제 가능
- [ ] 제재 이력 조회 가능
- [ ] 모든 제재 행위가 AdminLog에 기록

### 보안
- [ ] 미들웨어에서 권한 체크
- [ ] API에서 requireAdmin() 체크
- [ ] 정지된 사용자는 로그인 불가
- [ ] 관리자 API는 일반 사용자 접근 불가

### UX
- [ ] 직관적인 네비게이션
- [ ] 명확한 에러 메시지
- [ ] 빠른 로딩 속도
- [ ] 반응형 디자인

---

## 📊 테스트 결과

**전체 테스트 항목**: _____ 개  
**통과**: _____ 개  
**실패**: _____ 개  
**성공률**: _____%

### 발견된 이슈
1. 
2. 
3. 

### 개선 사항
1. 
2. 
3. 

---

**테스트 완료일**: _____________  
**테스터**: _____________  
**다음 단계**: Phase 2 - 스터디 관리 시스템 구현

