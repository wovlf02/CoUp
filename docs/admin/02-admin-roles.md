# 관리자 역할 및 권한 정의

> **작성일**: 2025-11-26  
> **목적**: CoUp 플랫폼 관리자의 역할, 책임, 권한을 명확히 정의

---

## 📋 목차

1. [관리자 역할 구분](#1-관리자-역할-구분)
2. [ADMIN 권한](#2-admin-권한)
3. [SYSTEM_ADMIN 권한](#3-system_admin-권한)
4. [권한 매트릭스](#4-권한-매트릭스)
5. [관리자 워크플로우](#5-관리자-워크플로우)

---

## 1. 관리자 역할 구분

### 1.1 USER (일반 사용자)
- **역할**: 플랫폼의 일반 사용자
- **권한**: 스터디 생성, 참여, 콘텐츠 작성, 신고 제출
- **제한**: 관리자 기능 접근 불가

### 1.2 ADMIN (일반 관리자)
- **역할**: 플랫폼의 운영 및 관리 담당자
- **주요 책임**:
  - 사용자 및 콘텐츠 관리
  - 신고 처리 및 제재 결정
  - 스터디 품질 관리
  - 일상적인 운영 업무
- **권한**:
  - ✅ 사용자 조회, 정지, 경고
  - ✅ 스터디 조회, 종료, 숨김
  - ✅ 신고 처리
  - ✅ 콘텐츠 검열 및 삭제
  - ✅ 통계 조회
  - ❌ 시스템 설정 변경 불가
  - ❌ 관리자 권한 부여 불가

### 1.3 SYSTEM_ADMIN (시스템 관리자)
- **역할**: 플랫폼의 최고 관리자
- **주요 책임**:
  - 시스템 전체 설정 관리
  - 관리자 권한 부여/회수
  - 중요 정책 결정
  - 데이터베이스 관리
- **권한**:
  - ✅ ADMIN의 모든 권한
  - ✅ 시스템 설정 변경
  - ✅ 관리자 권한 관리
  - ✅ 데이터베이스 직접 접근
  - ✅ 감사 로그 조회

---

## 2. ADMIN 권한

### 2.1 사용자 관리

#### 2.1.1 사용자 조회
- **권한**: ✅ 허용
- **범위**:
  - 사용자 목록 조회
  - 사용자 상세 정보 조회 (이메일, 프로필, 가입일 등)
  - 사용자 활동 이력 조회 (스터디 참여, 메시지 수 등)
  - 제재 이력 조회

#### 2.1.2 사용자 제재
- **권한**: ✅ 허용
- **조치 유형**:
  - **경고**: 사용자에게 경고 메시지 발송
  - **정지**: 일정 기간 계정 사용 정지
    - 기간: 1일, 3일, 7일, 30일, 영구
  - **기능 제한**: 특정 기능만 제한
    - 채팅 금지, 스터디 생성 금지, 파일 업로드 금지
- **필수 입력**:
  - 제재 사유 (최소 10자)
  - 제재 기간
  - 관련 신고/증거

#### 2.1.3 사용자 복구
- **권한**: ✅ 허용
- **가능 작업**:
  - 정지 해제
  - 제재 이력 주석 추가

#### 2.1.4 사용자 삭제
- **권한**: ❌ 불가 (SYSTEM_ADMIN만 가능)

### 2.2 스터디 관리

#### 2.2.1 스터디 조회
- **권한**: ✅ 허용
- **범위**:
  - 전체 스터디 목록 (공개/비공개 모두)
  - 스터디 상세 정보
  - 멤버 목록 및 역할
  - 채팅 내역 조회
  - 파일 목록 조회

#### 2.2.2 스터디 제재
- **권한**: ✅ 허용
- **조치 유형**:
  - **숨김**: 검색 결과에서 제외
  - **모집 중단**: 신규 멤버 가입 차단
  - **종료**: 스터디 강제 종료
- **필수 입력**:
  - 제재 사유
  - 멤버 알림 여부

#### 2.2.3 스터디 콘텐츠 삭제
- **권한**: ✅ 허용
- **삭제 가능**:
  - 부적절한 메시지
  - 불법 파일
  - 욕설/혐오 발언이 포함된 공지
- **로깅**: 모든 삭제 작업 기록

#### 2.2.4 스터디 추천
- **권한**: ✅ 허용
- **기능**:
  - 우수 스터디 선정
  - 추천 스터디 목록에 표시
  - 배지 부여

### 2.3 신고 관리

#### 2.3.1 신고 조회
- **권한**: ✅ 허용
- **필터**:
  - 상태별 (대기, 처리중, 완료, 기각)
  - 유형별 (사용자, 스터디, 콘텐츠)
  - 우선순위별 (긴급, 높음, 보통, 낮음)

#### 2.3.2 신고 처리
- **권한**: ✅ 허용
- **처리 옵션**:
  - **승인**: 신고 내용 확인 및 제재 실행
  - **기각**: 신고 내용 부적절 또는 증거 부족
  - **보류**: 추가 검토 필요
  - **에스컬레이션**: SYSTEM_ADMIN에게 전달
- **필수 입력**:
  - 처리 결과
  - 관리자 코멘트
  - 조치 사항

#### 2.3.3 신고자/피신고자 알림
- **권한**: ✅ 허용
- **알림 발송**:
  - 신고 접수 확인
  - 처리 완료 통지
  - 제재 내용 안내

### 2.4 콘텐츠 검열

#### 2.4.1 자동 필터링 규칙
- **권한**: ✅ 조회만 가능
- **설정**: ❌ 불가 (SYSTEM_ADMIN만 가능)

#### 2.4.2 수동 검열
- **권한**: ✅ 허용
- **대상**:
  - 신고된 메시지
  - 신고된 공지
  - 신고된 파일
- **조치**:
  - 콘텐츠 삭제
  - 작성자 경고/정지

### 2.5 통계 및 분석

#### 2.5.1 대시보드 조회
- **권한**: ✅ 허용
- **조회 가능 지표**:
  - 사용자 통계 (가입, 활성, 정지)
  - 스터디 통계 (생성, 활성, 종료)
  - 신고 통계 (접수, 처리, 적체)
  - 콘텐츠 통계 (메시지, 파일, 공지)

#### 2.5.2 리포트 생성
- **권한**: ✅ 허용
- **리포트 유형**:
  - 일간/주간/월간 리포트
  - 신고 처리 리포트
  - 사용자 활동 리포트

#### 2.5.3 데이터 익스포트
- **권한**: ⚠️ 제한적 허용
- **제한**:
  - 최대 1,000건까지
  - 개인정보 마스킹 필수
  - 익스포트 로그 기록

### 2.6 공지 및 알림

#### 2.6.1 시스템 공지 발송
- **권한**: ✅ 허용
- **발송 대상**:
  - 전체 사용자
  - 특정 그룹 (활성 사용자, 특정 스터디 멤버)
- **발송 방법**:
  - 인앱 알림
  - 이메일 (선택)

#### 2.6.2 긴급 알림
- **권한**: ✅ 허용
- **사용 사례**:
  - 시스템 점검 안내
  - 보안 이슈 경고
  - 중요 공지

---

## 3. SYSTEM_ADMIN 권한

### 3.1 ADMIN의 모든 권한 + 추가 권한

### 3.2 시스템 설정

#### 3.2.1 플랫폼 설정
- **권한**: ✅ 허용
- **설정 항목**:
  - 회원가입 제한 (이메일 도메인 화이트리스트)
  - 스터디 생성 제한 (최소 가입 기간, 최대 생성 개수)
  - 파일 업로드 제한 (최대 파일 크기, 허용 확장자)
  - 자동 필터링 규칙 (금지어, 필터링 강도)

#### 3.2.2 이메일 템플릿
- **권한**: ✅ 허용
- **템플릿 관리**:
  - 회원가입 환영 이메일
  - 비밀번호 재설정 이메일
  - 제재 알림 이메일
  - 시스템 공지 이메일

#### 3.2.3 서비스 이용약관
- **권한**: ✅ 허용
- **관리**:
  - 이용약관 수정
  - 개인정보 처리방침 수정
  - 버전 관리

### 3.3 관리자 권한 관리

#### 3.3.1 관리자 임명
- **권한**: ✅ 허용
- **절차**:
  - 일반 사용자 → ADMIN 승격
  - ADMIN → SYSTEM_ADMIN 승격
  - 권한 부여 사유 기록

#### 3.3.2 관리자 해임
- **권한**: ✅ 허용
- **절차**:
  - ADMIN → USER 강등
  - SYSTEM_ADMIN → ADMIN 강등
  - 권한 회수 사유 기록

#### 3.3.3 관리자 활동 모니터링
- **권한**: ✅ 허용
- **모니터링**:
  - 관리자별 작업 내역
  - 부적절한 권한 사용 탐지

### 3.4 데이터베이스 관리

#### 3.4.1 백업 및 복구
- **권한**: ✅ 허용
- **작업**:
  - 수동 백업 실행
  - 백업 복구 (긴급 시)

#### 3.4.2 데이터 정리
- **권한**: ✅ 허용
- **작업**:
  - 탈퇴 계정 완전 삭제
  - 오래된 로그 삭제
  - 임시 파일 정리

#### 3.4.3 사용자 완전 삭제
- **권한**: ✅ 허용
- **사용 사례**:
  - GDPR 삭제 요청
  - 법적 사유
- **절차**:
  - 삭제 사유 입력
  - 백업 생성
  - 관련 데이터 완전 삭제

### 3.5 감사 로그

#### 3.5.1 로그 조회
- **권한**: ✅ 허용
- **로그 유형**:
  - 관리자 작업 로그
  - 사용자 활동 로그
  - 시스템 에러 로그
  - 보안 이벤트 로그

#### 3.5.2 로그 분석
- **권한**: ✅ 허용
- **분석**:
  - 비정상 패턴 탐지
  - 권한 남용 탐지
  - 보안 위협 탐지

---

## 4. 권한 매트릭스

| 기능 영역 | 세부 기능 | USER | ADMIN | SYSTEM_ADMIN |
|----------|---------|------|-------|--------------|
| **사용자 관리** ||||
| 사용자 목록 조회 | 전체 | ❌ | ✅ | ✅ |
| 사용자 상세 조회 | 본인 | ✅ | ✅ (전체) | ✅ (전체) |
| 사용자 경고 | | ❌ | ✅ | ✅ |
| 사용자 정지 | | ❌ | ✅ | ✅ |
| 사용자 삭제 | 본인 | ✅ | ❌ | ✅ (모두) |
| 제재 이력 조회 | 본인 | ✅ | ✅ (전체) | ✅ (전체) |
| **스터디 관리** ||||
| 공개 스터디 조회 | | ✅ | ✅ | ✅ |
| 비공개 스터디 조회 | 참여 중 | ✅ | ✅ (전체) | ✅ (전체) |
| 스터디 생성 | | ✅ | ✅ | ✅ |
| 스터디 숨김 | | ❌ | ✅ | ✅ |
| 스터디 종료 | OWNER만 | ✅ | ✅ (전체) | ✅ (전체) |
| 스터디 추천 | | ❌ | ✅ | ✅ |
| 채팅 내역 조회 | 참여 중 | ✅ | ✅ (전체) | ✅ (전체) |
| 콘텐츠 삭제 | 본인 | ✅ | ✅ (전체) | ✅ (전체) |
| **신고 관리** ||||
| 신고 제출 | | ✅ | ✅ | ✅ |
| 신고 목록 조회 | 본인 | ✅ | ✅ (전체) | ✅ (전체) |
| 신고 처리 | | ❌ | ✅ | ✅ |
| 신고 통계 조회 | | ❌ | ✅ | ✅ |
| **통계 및 분석** ||||
| 대시보드 조회 | 개인 | ✅ | ✅ (전체) | ✅ (전체) |
| 사용자 통계 | | ❌ | ✅ | ✅ |
| 스터디 통계 | | ❌ | ✅ | ✅ |
| 리포트 생성 | | ❌ | ✅ | ✅ |
| 데이터 익스포트 | 본인 | ✅ | ⚠️ (제한) | ✅ |
| **시스템 설정** ||||
| 플랫폼 설정 변경 | | ❌ | ❌ | ✅ |
| 이메일 템플릿 수정 | | ❌ | ❌ | ✅ |
| 이용약관 수정 | | ❌ | ❌ | ✅ |
| 자동 필터링 규칙 | | ❌ | ❌ | ✅ |
| **관리자 권한** ||||
| 관리자 임명 | | ❌ | ❌ | ✅ |
| 관리자 해임 | | ❌ | ❌ | ✅ |
| 관리자 활동 조회 | | ❌ | ❌ | ✅ |
| 감사 로그 조회 | | ❌ | ❌ | ✅ |
| **데이터베이스** ||||
| 백업 실행 | | ❌ | ❌ | ✅ |
| 복구 실행 | | ❌ | ❌ | ✅ |
| 데이터 완전 삭제 | | ❌ | ❌ | ✅ |

**범례**:
- ✅ 허용
- ❌ 불가
- ⚠️ 제한적 허용

---

## 5. 관리자 워크플로우

### 5.1 신고 처리 워크플로우

```
┌─────────────────┐
│ 신고 접수        │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ 우선순위 자동 배정│
│ (긴급/높음/보통) │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ 관리자 검토      │
│ - 신고 내용 확인 │
│ - 증거 검토      │
│ - 유사 신고 조회 │
└────────┬────────┘
         │
         ├───────► 기각 (증거 부족)
         │         └─► 신고자 알림
         │
         ├───────► 보류 (추가 조사 필요)
         │         └─► 댓글 추가
         │
         ├───────► 에스컬레이션 (SYSTEM_ADMIN)
         │         └─► 담당자 변경
         │
         ▼
┌─────────────────┐
│ 제재 결정        │
│ - 경고          │
│ - 정지          │
│ - 콘텐츠 삭제   │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ 제재 실행        │
│ - 상태 변경      │
│ - 알림 발송      │
│ - 로그 기록      │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ 완료             │
│ - 신고자 알림    │
│ - 피신고자 알림  │
└─────────────────┘
```

### 5.2 사용자 정지 워크플로우

```
┌─────────────────┐
│ 정지 사유 확인   │
│ (신고, 규칙 위반) │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ 증거 수집        │
│ - 관련 메시지    │
│ - 파일          │
│ - 신고 내역     │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ 제재 수준 결정   │
│ - 경고: 1회     │
│ - 정지: 3일~영구 │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ 정지 실행        │
│ - status: SUSPENDED │
│ - suspendedUntil: Date │
│ - suspendReason: String │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ 사용자 알림      │
│ - 정지 사유      │
│ - 정지 기간      │
│ - 이의 제기 방법 │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ 로그 기록        │
│ - 관리자 ID      │
│ - 제재 내용      │
│ - 타임스탬프     │
└─────────────────┘
```

### 5.3 스터디 종료 워크플로우

```
┌─────────────────┐
│ 종료 사유 확인   │
│ (신고, 규칙 위반,│
│  비활성)        │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ 스터디 검토      │
│ - 콘텐츠 확인    │
│ - 멤버 활동      │
│ - 신고 이력      │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ 멤버 알림 (선택) │
│ - 종료 예정 안내 │
│ - 데이터 백업 권장│
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ 스터디 종료 실행 │
│ - 상태 변경      │
│ - 신규 가입 차단 │
│ - 검색 숨김      │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ 로그 기록        │
│ - 종료 사유      │
│ - 관리자 ID      │
└─────────────────┘
```

---

## 6. 보안 및 감사

### 6.1 관리자 인증

#### 로그인 시
1. 이메일/비밀번호 확인
2. 역할 검증 (ADMIN 또는 SYSTEM_ADMIN)
3. 세션 생성
4. 로그인 로그 기록

#### 작업 수행 시
1. 세션 유효성 검증
2. 권한 확인
3. 작업 실행
4. 작업 로그 기록

### 6.2 감사 로그 구조

```typescript
interface AuditLog {
  id: string
  adminId: string           // 작업 수행 관리자
  action: string            // 작업 유형 (USER_SUSPEND, STUDY_CLOSE 등)
  targetType: string        // 대상 유형 (USER, STUDY, REPORT 등)
  targetId: string          // 대상 ID
  details: object           // 작업 상세 내용
  ipAddress: string         // IP 주소
  userAgent: string         // 브라우저 정보
  result: 'SUCCESS' | 'FAIL' // 결과
  createdAt: Date           // 작업 시간
}
```

### 6.3 알림 대상

#### 사용자에게 알림
- 제재 (경고, 정지)
- 콘텐츠 삭제
- 신고 처리 결과

#### 관리자에게 알림
- 긴급 신고 접수
- 시스템 에러
- 비정상 활동 탐지

---

**다음 문서**: `03-functional-requirements.md` - 관리자 기능 요구사항 상세

