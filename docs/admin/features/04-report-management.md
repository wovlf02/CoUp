# 신고 관리 기능 명세

> **작성일**: 2025-11-26  
> **영역**: 신고 및 제재 관리  
> **목적**: 사용자 신고 접수, 검토, 처리 및 제재 실행

---

## 📋 목차

1. [개요](#1-개요)
2. [신고 목록](#2-신고-목록)
3. [신고 상세](#3-신고-상세)
4. [신고 처리](#4-신고-처리)
5. [신고 통계](#5-신고-통계)

---

## 1. 개요

### 1.1 화면 구성
```
┌─────────────────────────────────────────────────────────┐
│ 신고 관리                [검색] [필터] [통계]            │
├─────────────────────────────────────────────────────────┤
│                                                         │
│ 미처리: 8 | 처리중: 3 | 완료: 245 | 기각: 12           │
│                                                         │
│ ┌─────────────────────────────────────────────────────┐ │
│ │번호│유형  │대상    │상태  │우선│접수일│담당│액션 │ │
│ ├─────────────────────────────────────────────────────┤ │
│ │456│사용자│김철수  │대기  │긴급│11/26 │-   │🔍  │ │
│ │455│스터디│코테..  │처리중│높음│11/25 │관1 │🔍  │ │
│ │454│메시지│욕설..  │완료  │보통│11/24 │관2 │🔍  │ │
│ └─────────────────────────────────────────────────────┘ │
│                                                         │
│ [1] 2 3 ... 12                           20개씩 보기 ▼ │
└─────────────────────────────────────────────────────────┘
```

### 1.2 신고 유형
1. **사용자 신고**: 욕설, 스팸, 사칭, 기타
2. **스터디 신고**: 부적절한 콘텐츠, 스팸, 사기, 기타
3. **콘텐츠 신고**: 메시지, 공지, 파일 등

### 1.3 처리 상태
- **PENDING**: 대기 (미배정)
- **IN_PROGRESS**: 처리중 (담당자 배정됨)
- **RESOLVED**: 완료 (승인 - 제재 실행)
- **REJECTED**: 기각 (신고 부적절)
- **HOLD**: 보류 (추가 검토 필요)

### 1.4 우선순위
- **URGENT**: 긴급 (욕설, 혐오, 불법)
- **HIGH**: 높음 (스팸, 사기)
- **NORMAL**: 보통 (기타)
- **LOW**: 낮음 (경미한 사안)

---

## 2. 신고 목록

### 2.1 검색
```
┌─────────────────────────────────────────┐
│ 🔍 [신고 번호, 신고자, 피신고자로 검색]  │
└─────────────────────────────────────────┘
```

### 2.2 필터
```
┌─────────────────────────────────────────┐
│ 필터                                    │
├─────────────────────────────────────────┤
│ 상태:                                   │
│ ☑ 대기  ☑ 처리중  ☐ 완료  ☐ 기각       │
│                                         │
│ 유형:                                   │
│ ☑ 사용자  ☑ 스터디  ☑ 콘텐츠            │
│                                         │
│ 우선순위:                               │
│ ☑ 긴급  ☑ 높음  ☑ 보통  ☐ 낮음         │
│                                         │
│ 담당자:                                 │
│ ○ 미배정  ○ 내가 처리  ○ 전체           │
│                                         │
│ 접수일:                                 │
│ [최근 7일 ▼]                            │
│                                         │
│ [초기화]  [적용]                        │
└─────────────────────────────────────────┘
```

### 2.3 테이블 컬럼

| 컬럼 | 표시 | 너비 |
|------|------|------|
| 번호 | 신고 ID | 80px |
| 유형 | 사용자/스터디/콘텐츠 | 80px |
| 대상 | 피신고 대상 이름 | 120px |
| 상태 | 배지 | 80px |
| 우선순위 | 배지 | 80px |
| 접수일 | MM-DD HH:mm | 100px |
| 담당 | 담당 관리자 | 80px |
| 액션 | [상세] | 60px |

**상태 배지**:
- 대기: 빨간색 (#EF4444)
- 처리중: 노란색 (#F59E0B)
- 완료: 초록색 (#10B981)
- 기각: 회색 (#6B7280)
- 보류: 파란색 (#3B82F6)

**우선순위 배지**:
- 긴급: 빨간색 + ⚠️
- 높음: 주황색
- 보통: 파란색
- 낮음: 회색

### 2.4 정렬
- 접수일 (최신순/오래된순)
- 우선순위 (긴급 먼저)
- 상태 (대기 먼저)

### 2.5 빠른 액션
- **[미배정 신고 배정받기]**: 대기 중인 신고를 자신에게 배정
- **[긴급 신고만 보기]**: 우선순위 긴급 필터

---

## 3. 신고 상세

### 3.1 화면 구성
```
┌─────────────────────────────────────────────────────────┐
│ ← 신고 목록으로                  [배정] [처리] [댓글]   │
├─────────────────────────────────────────────────────────┤
│                                                         │
│ 신고 #456                                               │
│ ⚠️ 긴급 | 대기 중                                       │
│                                                         │
│ ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ │
│                                                         │
│ 📋 신고 정보                                            │
│ • 신고 유형: 사용자 신고 > 욕설/혐오 발언              │
│ • 접수일: 2025-11-26 10:30                             │
│ • 신고자: 이영희 (user_456) [프로필]                   │
│ • 피신고자: 김철수 (user_123) [프로필]                 │
│ • 담당자: 미배정                                        │
│                                                         │
│ 📝 신고 내용                                            │
│ 채팅에서 지속적으로 욕설을 사용하며 다른 멤버들을        │
│ 비방했습니다. 여러 번 주의를 주었으나 계속되고 있습니다. │
│                                                         │
│ 📎 증거 자료                                            │
│ • 스크린샷1.png [다운로드]                              │
│ • 스크린샷2.png [다운로드]                              │
│                                                         │
│ 🔍 대상 정보                                            │
│ • 이름: 김철수                                          │
│ • 가입일: 2025-11-01                                    │
│ • 참여 스터디: 3개                                      │
│ • 이전 제재 이력: 경고 1회 (2025-11-15)                │
│ • 이전 신고 이력: 2건 (1건 승인, 1건 기각)              │
│                                                         │
│ 🔗 관련 정보                                            │
│ • 스터디: 코딩테스트 마스터 스터디 [보기]               │
│ • 메시지: [욕설 내용...] [보기]                         │
│                                                         │
│ 💬 처리 댓글 (2)                                        │
│ admin1 (11/26 11:00): 증거 확인 중                     │
│ admin2 (11/26 11:30): 유사 신고 1건 추가 접수          │
│                                                         │
│ [댓글 추가] [관련 신고 조회]                            │
└─────────────────────────────────────────────────────────┘
```

### 3.2 자동 우선순위 배정

**알고리즘**:
```javascript
function calculatePriority(report) {
  // 긴급 조건
  if (report.type === 'PROFANITY' || 
      report.type === 'HATE_SPEECH' ||
      report.type === 'ILLEGAL_CONTENT') {
    return 'URGENT'
  }
  
  // 높음 조건
  if (report.type === 'SPAM' || 
      report.type === 'SCAM' ||
      report.duplicateCount >= 3) {
    return 'HIGH'
  }
  
  // 낮음 조건
  if (report.type === 'OTHER') {
    return 'LOW'
  }
  
  // 기본
  return 'NORMAL'
}
```

### 3.3 관련 신고 조회

**기능**: 동일 대상에 대한 다른 신고 자동 표시

```
┌─────────────────────────────────────────┐
│ 🔗 관련 신고 (2건)                       │
├─────────────────────────────────────────┤
│ #457 | 동일 사용자 신고 (스팸)          │
│      접수: 11/25, 상태: 처리중           │
│      [보기]                             │
│                                         │
│ #450 | 동일 사용자 신고 (욕설)          │
│      접수: 11/20, 상태: 완료 (경고)     │
│      [보기]                             │
└─────────────────────────────────────────┘
```

---

## 4. 신고 처리

### 4.1 담당자 배정

**자동 배정** (라운드 로빈):
```javascript
// 미배정 신고를 순차적으로 관리자에게 배정
function autoAssign(report) {
  const activeAdmins = getActiveAdmins()
  const leastBusyAdmin = activeAdmins
    .sort((a, b) => a.assignedCount - b.assignedCount)[0]
  
  return assignToAdmin(report.id, leastBusyAdmin.id)
}
```

**수동 배정**:
```
┌─────────────────────────────────────────┐
│ 담당자 배정                              │
├─────────────────────────────────────────┤
│ 신고 #456                               │
│                                         │
│ 담당자 선택 *                           │
│ ○ 나에게 배정                           │
│ ○ 다른 관리자:                          │
│   [admin1 (처리중 3건) ▼]              │
│                                         │
│ [취소]  [배정]                          │
└─────────────────────────────────────────┘
```

### 4.2 처리 결정

#### 4.2.1 승인 (제재 실행)

**모달**:
```
┌─────────────────────────────────────────┐
│ 신고 승인 및 제재                        │
├─────────────────────────────────────────┤
│ 신고 #456 - 김철수 (사용자)             │
│                                         │
│ 제재 유형 *                             │
│ ◉ 경고                                  │
│ ○ 1일 정지                              │
│ ○ 3일 정지                              │
│ ○ 7일 정지                              │
│ ○ 영구 정지                             │
│                                         │
│ 제재 사유 *                             │
│ ┌─────────────────────────────────────┐ │
│ │ 채팅에서 욕설 사용 및 회원 비방       │ │
│ │ (신고 #456 기반)                     │ │
│ └─────────────────────────────────────┘ │
│ 25/200자                                │
│                                         │
│ 추가 조치:                              │
│ ☑ 해당 메시지 삭제                       │
│ ☐ 스터디에서 강퇴                        │
│                                         │
│ 알림 발송:                              │
│ ☑ 신고자에게 처리 완료 알림              │
│ ☑ 피신고자에게 제재 알림                 │
│                                         │
│ 관리자 코멘트 *                          │
│ ┌─────────────────────────────────────┐ │
│ │ 증거 자료 확인 완료. 이전 경고 이력  │ │
│ │ 고려하여 1일 정지 결정                │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ [취소]  [승인 및 제재 실행]              │
└─────────────────────────────────────────┘
```

**실행 순서**:
1. 제재 실행 (사용자 정지 등)
2. 추가 조치 (콘텐츠 삭제 등)
3. 신고 상태 → RESOLVED
4. 알림 발송 (신고자/피신고자)
5. 로그 기록

#### 4.2.2 기각

**모달**:
```
┌─────────────────────────────────────────┐
│ 신고 기각                                │
├─────────────────────────────────────────┤
│ 신고 #456 - 김철수 (사용자)             │
│                                         │
│ 기각 사유 *                             │
│ ◉ 증거 부족                             │
│ ○ 신고 내용 부적절                       │
│ ○ 규칙 위반 아님                         │
│ ○ 이미 처리된 사안                       │
│ ○ 기타                                  │
│                                         │
│ 상세 사유 *                             │
│ ┌─────────────────────────────────────┐ │
│ │ 제출된 증거로는 욕설 여부를 판단하기  │ │
│ │ 어렵습니다. 추가 증거가 필요합니다.   │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ ☑ 신고자에게 알림 발송                   │
│                                         │
│ [취소]  [기각]                          │
└─────────────────────────────────────────┘
```

#### 4.2.3 보류

**모달**:
```
┌─────────────────────────────────────────┐
│ 신고 보류                                │
├─────────────────────────────────────────┤
│ 신고 #456 - 김철수 (사용자)             │
│                                         │
│ 보류 사유 *                             │
│ ┌─────────────────────────────────────┐ │
│ │ 추가 증거 수집 필요                  │ │
│ │ 관련 멤버 진술 확인 중                │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ 재검토 예정일:                          │
│ [2025-11-28 ▼]                         │
│                                         │
│ [취소]  [보류]                          │
└─────────────────────────────────────────┘
```

#### 4.2.4 에스컬레이션 (SYSTEM_ADMIN에게)

**모달**:
```
┌─────────────────────────────────────────┐
│ 상급자 에스컬레이션                      │
├─────────────────────────────────────────┤
│ 신고 #456 - 김철수 (사용자)             │
│                                         │
│ 에스컬레이션 사유 *                      │
│ ┌─────────────────────────────────────┐ │
│ │ 영구 정지 등 중대한 결정이 필요한    │ │
│ │ 사안으로 판단됩니다.                 │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ 전달 대상:                              │
│ ◉ SYSTEM_ADMIN 전체                    │
│ ○ 특정 관리자: [선택 ▼]                │
│                                         │
│ [취소]  [에스컬레이션]                   │
└─────────────────────────────────────────┘
```

### 4.3 댓글 추가

**기능**: 처리 과정 기록 및 다른 관리자와 소통

```
┌─────────────────────────────────────────┐
│ 댓글 추가                                │
├─────────────────────────────────────────┤
│ ┌─────────────────────────────────────┐ │
│ │ 증거 자료 확인 완료했습니다.         │ │
│ │ 유사 신고 1건 추가 접수되어          │ │
│ │ 제재 강도 상향 검토 중입니다.         │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ [취소]  [댓글 작성]                     │
└─────────────────────────────────────────┘
```

---

## 5. 신고 통계

### 5.1 통계 대시보드

**화면**: `/admin/reports/stats`

```
┌─────────────────────────────────────────────────────────┐
│ 신고 통계                           [기간: 최근 30일 ▼] │
├─────────────────────────────────────────────────────────┤
│                                                         │
│ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐       │
│ │ 총 신고  │ │ 평균     │ │ 처리율  │ │ 평균     │       │
│ │  256    │ │ 처리시간 │ │  95%    │ │ 응답시간 │       │
│ │ +12%    │ │  2.5시간 │ │         │ │  30분    │       │
│ └─────────┘ └─────────┘ └─────────┘ └─────────┘       │
│                                                         │
│ ┌───────────────────────┐ ┌─────────────────────────┐ │
│ │ 📊 유형별 분포         │ │ 📈 처리 추이 (30일)     │ │
│ │                       │ │                         │ │
│ │ [도넛 차트]           │ │ [선 그래프]             │ │
│ │ 사용자: 45%           │ │                         │ │
│ │ 스터디: 30%           │ │                         │ │
│ │ 콘텐츠: 25%           │ │                         │ │
│ └───────────────────────┘ └─────────────────────────┘ │
│                                                         │
│ 👥 관리자별 처리 현황                                    │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ 관리자  │ 처리 건수 │ 평균 시간 │ 승인율           │ │
│ ├─────────────────────────────────────────────────────┤ │
│ │ admin1  │ 85건     │ 2.3시간  │ 92%             │ │
│ │ admin2  │ 72건     │ 3.1시간  │ 88%             │ │
│ │ admin3  │ 99건     │ 1.8시간  │ 95%             │ │
│ └─────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────┘
```

### 5.2 통계 지표

**핵심 지표**:
- 총 신고 건수
- 미처리 신고 수
- 평균 처리 시간
- 처리율 (%)
- 승인/기각 비율
- 평균 응답 시간 (첫 댓글까지)

**유형별 통계**:
- 사용자 신고 (%)
- 스터디 신고 (%)
- 콘텐츠 신고 (%)

**세부 유형**:
- 욕설/혐오: X건
- 스팸: X건
- 사기: X건
- 기타: X건

---

## 6. 데이터 구조

### 6.1 Report 테이블
```prisma
model Report {
  id              String         @id @default(cuid())
  
  // 신고 정보
  reportType      ReportType     // USER, STUDY, CONTENT
  subType         String         // 욕설, 스팸, 사기 등
  reason          String
  evidence        String[]       // 증거 파일 URL
  
  // 대상
  targetType      String         // User, Study, Message, File 등
  targetId        String
  reporterId      String
  
  // 처리 상태
  status          ReportStatus   @default(PENDING)
  priority        Priority       @default(NORMAL)
  assignedTo      String?
  assignedAt      DateTime?
  
  // 처리 결과
  resolution      String?        // APPROVED, REJECTED
  resolutionNote  String?
  resolvedAt      DateTime?
  resolvedBy      String?
  
  // 제재 정보
  sanctionId      String?        // 실행된 제재 ID
  
  createdAt       DateTime       @default(now())
  updatedAt       DateTime       @updatedAt
}

enum ReportType {
  USER
  STUDY
  CONTENT
}

enum ReportStatus {
  PENDING
  IN_PROGRESS
  RESOLVED
  REJECTED
  HOLD
}

enum Priority {
  URGENT
  HIGH
  NORMAL
  LOW
}
```

### 6.2 ReportComment 테이블
```prisma
model ReportComment {
  id        String    @id @default(cuid())
  reportId  String
  adminId   String
  content   String
  createdAt DateTime  @default(now())
}
```

---

## 7. API 연동

### 7.1 신고 목록
```
GET /api/admin/reports?page=1&status=PENDING&priority=URGENT
```

### 7.2 신고 상세
```
GET /api/admin/reports/:reportId
```

### 7.3 담당자 배정
```
POST /api/admin/reports/:reportId/assign
Body: { adminId: string }
```

### 7.4 신고 승인
```
POST /api/admin/reports/:reportId/approve
Body: {
  sanctionType: string
  sanctionReason: string
  additionalActions: string[]
  adminComment: string
}
```

### 7.5 신고 기각
```
POST /api/admin/reports/:reportId/reject
Body: {
  rejectReason: string
  rejectNote: string
}
```

### 7.6 댓글 추가
```
POST /api/admin/reports/:reportId/comments
Body: { content: string }
```

---

## 8. 구현 체크리스트

- [ ] 신고 목록 페이지
- [ ] 검색 및 필터
- [ ] 신고 상세 페이지
- [ ] 담당자 배정 (자동/수동)
- [ ] 승인 모달 (제재 실행)
- [ ] 기각 모달
- [ ] 보류 모달
- [ ] 에스컬레이션
- [ ] 댓글 시스템
- [ ] 관련 신고 조회
- [ ] 통계 대시보드

---

**다음 문서**: `05-content-moderation.md`

