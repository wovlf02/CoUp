# 분석 및 리포트 기능 명세

> **작성일**: 2025-11-26  
> **영역**: 분석 및 리포트  
> **목적**: 플랫폼 통계 분석 및 리포트 생성

---

## 📋 목차

1. [개요](#1-개요)
2. [사용자 분석](#2-사용자-분석)
3. [스터디 분석](#3-스터디-분석)
4. [활동 분석](#4-활동-분석)
5. [리포트 생성](#5-리포트-생성)

---

## 1. 개요

### 1.1 화면 구성
```
┌─────────────────────────────────────────────────────────┐
│ 분석 대시보드                [기간: 최근 30일 ▼]        │
├─────────────────────────────────────────────────────────┤
│                                                         │
│ ┌───────────┐ ┌───────────┐ ┌───────────┐ ┌──────────┐│
│ │ 전체      │ │ 활성      │ │ 신규      │ │ 이탈    ││
│ │ 사용자    │ │ 사용자    │ │ 가입자    │ │ 사용자  ││
│ │ 1,234     │ │  856      │ │   45      │ │   12    ││
│ │ +5%       │ │  +8%      │ │  +12%     │ │  -3%    ││
│ └───────────┘ └───────────┘ └───────────┘ └──────────┘│
│                                                         │
│ ┌───────────────────────┐ ┌─────────────────────────┐ │
│ │ 📈 가입자 추이 (30일)  │ │ 🔥 인기 스터디 TOP 10   │ │
│ │                       │ │                         │ │
│ │ [선 그래프]           │ │ 1. 코테 스터디 (120명)  │ │
│ │                       │ │ 2. 취업 준비 (85명)     │ │
│ │                       │ │ 3. 영어 회화 (68명)     │ │
│ │                       │ │ ...                     │ │
│ └───────────────────────┘ └─────────────────────────┘ │
│                                                         │
│ [사용자 분석] [스터디 분석] [활동 분석] [리포트 생성]   │
└─────────────────────────────────────────────────────────┘
```

### 1.2 권한
- **ADMIN**: ✅ 모든 분석 조회, 리포트 생성 (제한)
- **SYSTEM_ADMIN**: ✅ 모든 기능 + 민감 데이터 익스포트

### 1.3 기간 선택
- 오늘
- 최근 7일
- 최근 30일
- 최근 90일
- 사용자 지정 (시작일 ~ 종료일)

---

## 2. 사용자 분석

### 2.1 화면 구성
```
┌─────────────────────────────────────────────────────────┐
│ 사용자 분석                     [기간: 최근 30일 ▼]     │
├─────────────────────────────────────────────────────────┤
│                                                         │
│ 📊 핵심 지표                                             │
│ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐       │
│ │ 전체    │ │ 활성    │ │ DAU     │ │ MAU     │       │
│ │ 1,234   │ │  856    │ │  320    │ │  890    │       │
│ └─────────┘ └─────────┘ └─────────┘ └─────────┘       │
│                                                         │
│ 📈 가입자 추이                                           │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ [선 그래프]                                         │ │
│ │ - 신규 가입자                                       │ │
│ │ - 탈퇴자                                            │ │
│ └─────────────────────────────────────────────────────┘ │
│                                                         │
│ 🌍 가입 경로 분포                                       │
│ ┌───────────────────────┐ ┌─────────────────────────┐ │
│ │ [도넛 차트]           │ │ 상세 통계               │ │
│ │ 이메일: 45%           │ │ • 이메일: 556명        │ │
│ │ Google: 40%           │ │ • Google: 494명        │ │
│ │ GitHub: 15%           │ │ • GitHub: 185명        │ │
│ └───────────────────────┘ └─────────────────────────┘ │
│                                                         │
│ 📍 지역별 분포 (국가)                                    │
│ 1. 대한민국: 1,100명 (89%)                              │
│ 2. 미국: 80명 (6%)                                      │
│ 3. 일본: 30명 (2%)                                      │
│ ...                                                     │
└─────────────────────────────────────────────────────────┘
```

### 2.2 사용자 상태 분석

**상태 정의**:
- **전체**: 가입된 모든 사용자 (탈퇴 제외)
- **활성**: 최근 7일 내 활동
- **휴면**: 30일 이상 미활동
- **정지**: 현재 정지 중
- **탈퇴**: 계정 삭제

**그래프**:
```
┌─────────────────────────────────────────┐
│ 사용자 상태 분포                         │
├─────────────────────────────────────────┤
│ [적층 막대 그래프 - 일별]               │
│                                         │
│ 2025-11-26 ████████░░                   │
│ 2025-11-25 ███████░░                    │
│ 2025-11-24 ██████░░                     │
│ ...                                     │
│                                         │
│ ■ 활성  □ 휴면                          │
└─────────────────────────────────────────┘
```

### 2.3 코호트 분석

**가입 월별 retention**:
```
┌─────────────────────────────────────────┐
│ 코호트 분석 (가입 월별 유지율)           │
├─────────────────────────────────────────┤
│ 가입월  │ M0  │ M1  │ M2  │ M3  │ M4   │
│ 2025-11 │100% │ -   │ -   │ -   │ -    │
│ 2025-10 │100% │ 85% │ 72% │ 68% │ -    │
│ 2025-09 │100% │ 82% │ 69% │ 64% │ 60%  │
│ 2025-08 │100% │ 78% │ 65% │ 58% │ 55%  │
│                                         │
│ ■ 90%+ ■ 70-90% ■ 50-70% ■ <50%        │
└─────────────────────────────────────────┘
```

### 2.4 사용자 세그먼트

**세그먼트 정의**:
1. **슈퍼 유저**: 스터디 3개 이상 + 활발한 활동
2. **일반 유저**: 스터디 1-2개
3. **관찰자**: 가입했지만 스터디 미참여
4. **이탈 위험**: 14일 이상 미활동

**분포 그래프**:
```
┌─────────────────────────────────────────┐
│ 사용자 세그먼트                          │
├─────────────────────────────────────────┤
│ 슈퍼 유저:    ████████  150명 (12%)     │
│ 일반 유저:    ████████████████  856명   │
│ 관찰자:       ██████  120명 (10%)       │
│ 이탈 위험:    ████  108명 (9%)          │
└─────────────────────────────────────────┘
```

---

## 3. 스터디 분석

### 3.1 화면 구성
```
┌─────────────────────────────────────────────────────────┐
│ 스터디 분석                     [기간: 최근 30일 ▼]     │
├─────────────────────────────────────────────────────────┤
│                                                         │
│ 📊 핵심 지표                                             │
│ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐       │
│ │ 전체    │ │ 활성    │ │ 신규    │ │ 평균    │       │
│ │  456    │ │  420    │ │   15    │ │ 멤버수  │       │
│ │         │ │  (92%)  │ │         │ │  12명   │       │
│ └─────────┘ └─────────┘ └─────────┘ └─────────┘       │
│                                                         │
│ 📈 스터디 생성 추이                                      │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ [막대 그래프 - 일별]                                │ │
│ └─────────────────────────────────────────────────────┘ │
│                                                         │
│ 📊 카테고리별 분포                                       │
│ ┌───────────────────────┐ ┌─────────────────────────┐ │
│ │ [도넛 차트]           │ │ 상세 통계               │ │
│ │ 프로그래밍: 35%       │ │ • 프로그래밍: 160개    │ │
│ │ 취업: 25%             │ │ • 취업: 114개          │ │
│ │ 어학: 20%             │ │ • 어학: 91개           │ │
│ │ 기타: 20%             │ │ • 기타: 91개           │ │
│ └───────────────────────┘ └─────────────────────────┘ │
└─────────────────────────────────────────────────────────┘
```

### 3.2 스터디 활성도 분석

**활성도 정의**:
- **매우 활성**: 일 평균 메시지 20개 이상
- **활성**: 일 평균 메시지 5-20개
- **보통**: 일 평균 메시지 1-5개
- **저활성**: 주 1개 이하

**분포**:
```
┌─────────────────────────────────────────┐
│ 스터디 활성도 분포                       │
├─────────────────────────────────────────┤
│ 매우 활성: ████  45개 (10%)             │
│ 활성:     ████████████  180개 (39%)    │
│ 보통:     ██████████  150개 (33%)      │
│ 저활성:   ████████  81개 (18%)         │
└─────────────────────────────────────────┘
```

### 3.3 인기 스터디 TOP 10

```
┌─────────────────────────────────────────┐
│ 인기 스터디 TOP 10 (멤버 수)             │
├─────────────────────────────────────────┤
│ 1. 💻 코테 마스터 스터디 - 120명        │
│ 2. 📝 취업 준비 스터디 - 85명           │
│ 3. 🌍 영어 회화 스터디 - 68명           │
│ 4. 📊 데이터 분석 스터디 - 52명         │
│ 5. 🎨 디자인 스터디 - 48명              │
│ 6. 💼 창업 준비 스터디 - 42명           │
│ 7. 📱 앱 개발 스터디 - 38명             │
│ 8. 🔬 머신러닝 스터디 - 35명            │
│ 9. 📖 독서 스터디 - 32명                │
│ 10. 💪 운동 루틴 스터디 - 28명          │
└─────────────────────────────────────────┘
```

### 3.4 스터디 생명주기 분석

```
┌─────────────────────────────────────────┐
│ 스터디 생명주기 (평균)                   │
├─────────────────────────────────────────┤
│ 생성 후 생존율:                         │
│ • 1주 후: 95% (15개 종료)               │
│ • 1개월 후: 85% (69개 종료)             │
│ • 3개월 후: 70% (137개 종료)            │
│ • 6개월 후: 55% (205개 종료)            │
│                                         │
│ 평균 활동 기간: 142일                   │
│ 중앙값: 89일                            │
└─────────────────────────────────────────┘
```

---

## 4. 활동 분석

### 4.1 화면 구성
```
┌─────────────────────────────────────────────────────────┐
│ 활동 분석                       [기간: 최근 30일 ▼]     │
├─────────────────────────────────────────────────────────┤
│                                                         │
│ 📊 활동 통계                                             │
│ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐       │
│ │ 메시지  │ │ 공지    │ │ 파일    │ │ 일정    │       │
│ │ 12,450  │ │  245    │ │  568    │ │  123    │       │
│ │ +15%    │ │  +8%    │ │  +22%   │ │  +5%    │       │
│ └─────────┘ └─────────┘ └─────────┘ └─────────┘       │
│                                                         │
│ 📈 일별 활동 추이                                        │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ [복합 선 그래프]                                    │ │
│ │ - 메시지 (주황)                                     │ │
│ │ - 공지 (파랑)                                       │ │
│ │ - 파일 (초록)                                       │ │
│ └─────────────────────────────────────────────────────┘ │
│                                                         │
│ ⏰ 시간대별 활동 분포                                    │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ [막대 그래프 - 시간별]                              │ │
│ │ 가장 활발한 시간: 오후 9시-11시                     │ │
│ └─────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────┘
```

### 4.2 요일별 활동 패턴

```
┌─────────────────────────────────────────┐
│ 요일별 활동 분포                         │
├─────────────────────────────────────────┤
│ 월: ███████████ 2,100건                 │
│ 화: █████████████ 2,350건               │
│ 수: ██████████████ 2,480건              │
│ 목: ████████████████ 2,890건            │
│ 금: ████████████ 2,200건                │
│ 토: ██████ 1,100건                      │
│ 일: ████ 750건                          │
│                                         │
│ 가장 활발한 요일: 목요일                │
└─────────────────────────────────────────┘
```

### 4.3 사용자 참여도

**참여도 기준**:
- **매우 높음**: 일 10회 이상 활동
- **높음**: 일 5-10회
- **보통**: 일 1-5회
- **낮음**: 주 1-2회
- **매우 낮음**: 월 1-2회

```
┌─────────────────────────────────────────┐
│ 사용자 참여도 분포                       │
├─────────────────────────────────────────┤
│ 매우 높음: ██  45명 (4%)                │
│ 높음:     ████████  180명 (15%)        │
│ 보통:     ████████████████  420명 (34%)│
│ 낮음:     ████████████  320명 (26%)    │
│ 매우 낮음: ████████████  269명 (21%)   │
└─────────────────────────────────────────┘
```

---

## 5. 리포트 생성

### 5.1 리포트 생성 화면

**화면**: `/admin/analytics/reports/create`

```
┌─────────────────────────────────────────────────────────┐
│ 리포트 생성                                              │
├─────────────────────────────────────────────────────────┤
│                                                         │
│ 리포트 유형 *                                            │
│ ◉ 일간 리포트                                           │
│ ○ 주간 리포트                                           │
│ ○ 월간 리포트                                           │
│ ○ 사용자 지정 리포트                                    │
│                                                         │
│ 기간 *                                                  │
│ [2025-11-01] ~ [2025-11-30]                            │
│                                                         │
│ 포함할 데이터 *                                          │
│ ☑ 사용자 통계                                           │
│ ☑ 스터디 통계                                           │
│ ☑ 활동 통계                                             │
│ ☑ 신고 처리 현황                                        │
│ ☑ 제재 현황                                             │
│                                                         │
│ 추가 옵션                                               │
│ ☑ 그래프 포함                                           │
│ ☑ 상세 데이터 테이블                                    │
│ ☐ 사용자 목록 (SYSTEM_ADMIN만)                         │
│                                                         │
│ 출력 형식 *                                             │
│ ◉ PDF                                                   │
│ ○ Excel                                                 │
│ ○ HTML                                                  │
│                                                         │
│ [취소]  [미리보기]  [생성]                              │
└─────────────────────────────────────────────────────────┘
```

### 5.2 리포트 템플릿

#### 일간 리포트
```
============================================
CoUp 일간 리포트
2025년 11월 26일

============================================

📊 핵심 지표
----------------------------------------
• 전체 사용자: 1,234명 (+5, +0.4%)
• 활성 사용자: 320명 (DAU)
• 신규 가입: 5명
• 신규 스터디: 2개
• 미처리 신고: 3건

📈 어제 대비 변화
----------------------------------------
• 가입자: +5명 (+0.4%)
• 활동: +8명 (+2.6%)
• 메시지: +250개 (+5.2%)

🚨 주의 사항
----------------------------------------
• 미처리 신고 3건 대기 중
• 이탈 위험 사용자 12명

📋 처리 현황
----------------------------------------
• 처리한 신고: 8건
• 실행한 제재: 4건
• 삭제한 콘텐츠: 12개

============================================
```

#### 주간 리포트
```
============================================
CoUp 주간 리포트
2025년 11월 20일 ~ 11월 26일

============================================

📊 핵심 지표
----------------------------------------
• 전체 사용자: 1,234명 (+45, +3.8%)
• 평균 DAU: 298명
• 신규 가입: 45명
• 신규 스터디: 15개
• 처리한 신고: 42건

📈 성장률
----------------------------------------
• 사용자: +3.8% (전주 +2.5%)
• DAU: +8.2%
• 스터디: +3.4%

🔥 TOP 10
----------------------------------------
1. 코테 마스터 스터디 (+12명)
2. 취업 준비 스터디 (+8명)
...

⚠️ 이슈
----------------------------------------
• 스팸 신고 15건 처리
• 부적절한 콘텐츠 23개 삭제

============================================
```

### 5.3 리포트 히스토리

**화면**: `/admin/analytics/reports/history`

```
┌─────────────────────────────────────────────────────────┐
│ 리포트 히스토리                         [새 리포트]     │
├─────────────────────────────────────────────────────────┤
│                                                         │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ 📄 월간 리포트 - 2025년 11월                        │ │
│ │ 생성: 2025-11-26 by admin1                          │ │
│ │ 크기: 2.5MB (PDF)                                   │ │
│ │ [다운로드] [미리보기]                               │ │
│ └─────────────────────────────────────────────────────┘ │
│                                                         │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ 📄 주간 리포트 - 2025년 11월 3주차                  │ │
│ │ 생성: 2025-11-20 by admin2                          │ │
│ │ [다운로드] [미리보기]                               │ │
│ └─────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────┘
```

### 5.4 자동 리포트 예약 (SYSTEM_ADMIN)

```
┌─────────────────────────────────────────┐
│ 자동 리포트 예약                         │
├─────────────────────────────────────────┤
│ ☑ 일간 리포트                           │
│   • 생성 시간: 매일 오전 9시            │
│   • 수신자: admin1@coup.com             │
│                                         │
│ ☑ 주간 리포트                           │
│   • 생성 시간: 매주 월요일 오전 9시     │
│   • 수신자: admin1@, admin2@            │
│                                         │
│ ☐ 월간 리포트                           │
│   • 생성 시간: 매월 1일 오전 9시        │
│                                         │
│ [저장]                                  │
└─────────────────────────────────────────┘
```

---

## 6. 데이터 구조

### 6.1 Analytics 집계 테이블
```prisma
model DailyAnalytics {
  id            String   @id @default(cuid())
  date          DateTime @unique
  
  // 사용자
  totalUsers    Int
  activeUsers   Int
  newUsers      Int
  deletedUsers  Int
  
  // 스터디
  totalStudies  Int
  activeStudies Int
  newStudies    Int
  
  // 활동
  messages      Int
  notices       Int
  files         Int
  events        Int
  
  // 신고/제재
  reports       Int
  sanctions     Int
  
  createdAt     DateTime @default(now())
}
```

### 6.2 Report 테이블
```prisma
model AnalyticsReport {
  id          String   @id @default(cuid())
  type        String   // DAILY, WEEKLY, MONTHLY, CUSTOM
  startDate   DateTime
  endDate     DateTime
  format      String   // PDF, EXCEL, HTML
  fileUrl     String?
  fileSize    Int?
  
  createdBy   String
  createdAt   DateTime @default(now())
}
```

---

## 7. API 연동

### 7.1 분석 데이터 조회
```
GET /api/admin/analytics/users?startDate=2025-11-01&endDate=2025-11-30
GET /api/admin/analytics/studies?period=30d
GET /api/admin/analytics/activities?period=7d
```

### 7.2 리포트 생성
```
POST /api/admin/analytics/reports
Body: {
  type: 'WEEKLY',
  startDate: Date,
  endDate: Date,
  format: 'PDF',
  includeData: string[]
}
```

### 7.3 리포트 다운로드
```
GET /api/admin/analytics/reports/:id/download
```

---

## 8. 구현 체크리스트

- [ ] 분석 대시보드 (통합)
- [ ] 사용자 분석 페이지
- [ ] 스터디 분석 페이지
- [ ] 활동 분석 페이지
- [ ] 리포트 생성 페이지
- [ ] 리포트 히스토리
- [ ] 차트 라이브러리 (Recharts)
- [ ] PDF 생성 (jsPDF)
- [ ] Excel 생성 (xlsx)
- [ ] 자동 리포트 예약 (SYSTEM_ADMIN)

---

**문서 완료**: 관리자 기능 명세 7개 전부 완료

