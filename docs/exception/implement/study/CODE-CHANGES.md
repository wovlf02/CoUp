# study ì˜ì—­ - ì½”ë“œ ë³€ê²½ ì‚¬í•­

**ì˜ì—­**: study (ìŠ¤í„°ë”” ê´€ë¦¬)  
**ë‹¨ê³„**: Step 2-4 - Critical êµ¬í˜„ (2/3 - API ë¼ìš°íŠ¸ ì ìš© ì§„í–‰ ì¤‘)  
**ì‘ì„±ì¼**: 2025-11-30  
**ìµœì¢… ì—…ë°ì´íŠ¸**: 2025-12-01  
**ìƒíƒœ**: ğŸŸ¢ ì§„í–‰ ì¤‘

---

## ğŸ“‹ ì‘ì—… ê°œìš”

### ì™„ë£Œëœ ì‘ì—…
- âœ… **Step 2-4.1**: ìœ í‹¸ë¦¬í‹° íŒŒì¼ 6ê°œ ìƒì„± ì™„ë£Œ
- âœ… **Step 2-4.2 (1/13)**: ìŠ¤í„°ë”” ìƒì„± API ì˜ˆì™¸ ì²˜ë¦¬ ì™„ë£Œ

### ì§„í–‰ ì¤‘ ì‘ì—…
- ğŸ”„ **Step 2-4.2**: Critical ì˜ˆì™¸ ì²˜ë¦¬ êµ¬í˜„ (25ê°œ í•­ëª© ì¤‘ 1ê°œ ì™„ë£Œ)

### ë‹¤ìŒ ì‘ì—…
- â³ **Step 2-4.3**: í…ŒìŠ¤íŠ¸ ë° ê²€ì¦

---

## ğŸ”„ ìˆ˜ì •ëœ íŒŒì¼ (1ê°œ)

### 1. studies/route.js â­â­â­
**ê²½ë¡œ**: `coup/src/app/api/studies/route.js`  
**ìˆ˜ì •ì¼**: 2025-12-01  
**ì‘ì—… ì‹œê°„**: 1ì‹œê°„  

**ëª©ì **: ìŠ¤í„°ë”” ìƒì„±/ì¡°íšŒ API ì˜ˆì™¸ ì²˜ë¦¬ ê°•í™”

**ë³€ê²½ ë‚´ìš©**:

#### Import ì¶”ê°€
```javascript
import {
  createStudyErrorResponse,
  logStudyError,
  handlePrismaError
} from '@/lib/exceptions/study-errors'
import { validateStudyCreate } from '@/lib/validators/study-validation'
import { isDuplicateStudyName } from '@/lib/study-helpers'
import { createStudyWithOwner } from '@/lib/transaction-helpers'
```

#### GET í•¸ë“¤ëŸ¬ ê°œì„ 
**ê°œì„  ì „**:
- ê¸°ë³¸ parseIntë§Œ ì‚¬ìš©
- ë‹¨ìˆœ catch ì—ëŸ¬ ì²˜ë¦¬
- console.error ë¡œê¹…

**ê°œì„  í›„**:
- âœ… í˜ì´ì§€ë„¤ì´ì…˜ íŒŒë¼ë¯¸í„° ê²€ì¦ (ìµœì†Œ 1, ìµœëŒ€ 100)
- âœ… Prisma ì—ëŸ¬ êµ¬ì¡°í™” ì²˜ë¦¬
- âœ… í†µì¼ëœ ì—ëŸ¬ ì‘ë‹µ (createStudyErrorResponse)
- âœ… êµ¬ì¡°í™”ëœ ì—ëŸ¬ ë¡œê¹… (logStudyError)

**ì ìš©ëœ ì˜ˆì™¸ ì²˜ë¦¬** (3ê°œ):
1. íŒŒë¼ë¯¸í„° ê²€ì¦ - page(â‰¥1), limit(1-100)
2. Prisma ì—ëŸ¬ ì²˜ë¦¬ - handlePrismaError()
3. ì¼ë°˜ ì—ëŸ¬ ì²˜ë¦¬ - logStudyError() + createStudyErrorResponse()

#### POST í•¸ë“¤ëŸ¬ ê°œì„ 
**ê°œì„  ì „**:
- ê¸°ë³¸ í•„ìˆ˜ í•„ë“œ ê²€ì¦ë§Œ (name, description, category)
- ê°œë³„ ìƒì„± (study â†’ member)
- ë‹¨ìˆœ catch ì—ëŸ¬ ì²˜ë¦¬
- console.error ë¡œê¹…

**ê°œì„  í›„**:
- âœ… ì¸ì¦ í™•ì¸ (requireAuth)
- âœ… í•„ë“œ ê²€ì¦ ê°•í™” (validateStudyCreate)
  - name: 2-50ì
  - description: 10-500ì
  - category: ìœ íš¨í•œ ì¹´í…Œê³ ë¦¬
  - maxMembers: 2-100ëª…
  - emoji, tags, isPublic, autoApprove ê²€ì¦
- âœ… ì´ë¦„ ì¤‘ë³µ í™•ì¸ (isDuplicateStudyName)
- âœ… íŠ¸ëœì­ì…˜ ì‚¬ìš© (createStudyWithOwner)
  - ìŠ¤í„°ë”” ìƒì„± + OWNER ë©¤ë²„ ìƒì„±
  - ë¡¤ë°± ì§€ì›
- âœ… Prisma ì—ëŸ¬ êµ¬ì¡°í™” ì²˜ë¦¬
- âœ… í†µì¼ëœ ì—ëŸ¬ ì‘ë‹µ
- âœ… êµ¬ì¡°í™”ëœ ì—ëŸ¬ ë¡œê¹…

**ì ìš©ëœ ì˜ˆì™¸ ì²˜ë¦¬** (6ê°œ):
1. ì¸ì¦ í™•ì¸ - requireAuth()
2. í•„ë“œ ê²€ì¦ - validateStudyCreate()
3. ì¤‘ë³µ í™•ì¸ - isDuplicateStudyName()
4. íŠ¸ëœì­ì…˜ ì‹¤íŒ¨ - createStudyWithOwner() ê²°ê³¼ ì²˜ë¦¬
5. Prisma ì—ëŸ¬ ì²˜ë¦¬ - handlePrismaError()
6. ì¼ë°˜ ì—ëŸ¬ ì²˜ë¦¬ - logStudyError() + createStudyErrorResponse()

**ì½”ë“œ í’ˆì§ˆ**:
- âœ… ESLint ì—ëŸ¬ ì—†ìŒ
- âœ… ê²½ê³  ì—†ìŒ
- âœ… ìœ í‹¸ë¦¬í‹° ì¬ì‚¬ìš© (6ê°œ í•¨ìˆ˜)

**íš¨ê³¼**:
- ğŸ¯ ê²€ì¦ ê°•í™”: 3ê°œ â†’ 10ê°œ í•­ëª©
- ğŸ¯ ì—ëŸ¬ ì²˜ë¦¬: ë‹¨ìˆœ catch â†’ 3ë‹¨ê³„ ì²˜ë¦¬
- ğŸ¯ ë°ì´í„° ì¼ê´€ì„±: ê°œë³„ ìƒì„± â†’ íŠ¸ëœì­ì…˜
- ğŸ¯ ì½”ë“œ ì¬ì‚¬ìš©: 6ê°œ ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ í™œìš©

---

## ğŸ†• ìƒì„±ëœ íŒŒì¼ (6ê°œ)

### 1. study-errors.js â­â­â­
**ê²½ë¡œ**: `coup/src/lib/exceptions/study-errors.js`  
**í¬ê¸°**: ~370ì¤„  
**ì‘ì—… ì‹œê°„**: 4ì‹œê°„ (ì˜ˆìƒ)  

**ëª©ì **: í†µì¼ëœ ìŠ¤í„°ë”” ì—ëŸ¬ ì²˜ë¦¬

**ì£¼ìš” ë‚´ìš©**:
- âœ… `STUDY_ERRORS` ìƒìˆ˜ (50ê°œ ì—ëŸ¬ ì½”ë“œ ì •ì˜)
  - ìŠ¤í„°ë”” CRUD (7ê°œ): STUDY_001~007
  - ê¶Œí•œ ê´€ë ¨ (4ê°œ): STUDY_101~104
  - ê°€ì…/íƒˆí‡´ (8ê°œ): STUDY_201~208
  - ë©¤ë²„ ê´€ë¦¬ (7ê°œ): STUDY_301~307
  - ê°€ì… ìš”ì²­ (3ê°œ): STUDY_401~403
  - íŒŒì¼ ê´€ë ¨ (7ê°œ): STUDY_501~507
  - ê³µì§€ ê´€ë ¨ (3ê°œ): STUDY_601~603
  - í• ì¼ ê´€ë ¨ (3ê°œ): STUDY_701~703
  - ì±„íŒ… ê´€ë ¨ (3ê°œ): STUDY_801~803
  - ì¼ì • ê´€ë ¨ (3ê°œ): STUDY_901~903
  - ë°ì´í„°ë² ì´ìŠ¤ (3ê°œ): STUDY_996~998
  - ì¼ë°˜ ì—ëŸ¬ (1ê°œ): STUDY_999

- âœ… `createStudyErrorResponse()` - ì—ëŸ¬ ì‘ë‹µ ìƒì„± í•¨ìˆ˜
- âœ… `logStudyError()` - ì—ëŸ¬ ë¡œê¹… í—¬í¼
- âœ… `handlePrismaError()` - Prisma ì—ëŸ¬ ë³€í™˜ (P2002, P2025, P2003)
- âœ… `StudyError` í´ë˜ìŠ¤ - ì»¤ìŠ¤í…€ ì—ëŸ¬ í´ë˜ìŠ¤

**íŠ¹ì§•**:
- ì¼ê´€ëœ ì—ëŸ¬ ì½”ë“œ ì²´ê³„ (STUDY_XXX)
- ì‚¬ìš©ì ì¹œí™”ì ì¸ í•œê¸€ ë©”ì‹œì§€
- ì ì ˆí•œ HTTP ìƒíƒœ ì½”ë“œ ë§¤í•‘
- ê°œë°œ/í”„ë¡œë•ì…˜ í™˜ê²½ êµ¬ë¶„ ë¡œê¹…

---

### 2. study-validation.js â­â­â­
**ê²½ë¡œ**: `coup/src/lib/validators/study-validation.js`  
**í¬ê¸°**: ~460ì¤„  
**ì‘ì—… ì‹œê°„**: 4ì‹œê°„ (ì˜ˆìƒ)  

**ëª©ì **: ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ì…ë ¥ ê²€ì¦ í•¨ìˆ˜

**ì£¼ìš” ë‚´ìš©**:
- âœ… ìƒìˆ˜ ì •ì˜
  - `VALID_CATEGORIES` - 6ê°œ ì¹´í…Œê³ ë¦¬
  - `VALID_ROLES` - 3ê°œ ì—­í•  (OWNER, ADMIN, MEMBER)
  - `VALID_MEMBER_STATUS` - 4ê°œ ìƒíƒœ (PENDING, ACTIVE, KICKED, LEFT)

- âœ… ìŠ¤í„°ë”” í•„ë“œ ê²€ì¦ (5ê°œ)
  - `validateStudyName()` - 2~50ì
  - `validateDescription()` - 10~500ì
  - `validateMaxMembers()` - 2~100ëª…
  - `validateCategory()` - í—ˆìš©ëœ ì¹´í…Œê³ ë¦¬
  - `validateRole()` / `validateMemberStatus()` - ì—´ê±°í˜• ê²€ì¦

- âœ… ì»¨í…ì¸  ê²€ì¦ (8ê°œ)
  - `validateNoticeTitle()` - 1~100ì
  - `validateNoticeContent()` - 1~5000ì
  - `validateTaskTitle()` - 1~200ì
  - `validateTaskDueDate()` - ë¯¸ë˜ ë‚ ì§œ
  - `validateMessageContent()` - 1~2000ì
  - `validateEventTitle()` - 1~100ì
  - `validateEventDate()` - ì‹œì‘ì¼ < ì¢…ë£Œì¼

- âœ… í†µí•© ê²€ì¦ (2ê°œ)
  - `validateStudyCreation()` - ìƒì„± ë°ì´í„° ì „ì²´ ê²€ì¦
  - `validateStudyUpdate()` - ìˆ˜ì • ë°ì´í„° ê²€ì¦

- âœ… ë³´ì•ˆ
  - `escapeHtml()` - XSS ë°©ì–´

**íŠ¹ì§•**:
- ì¼ê´€ëœ ë°˜í™˜ í˜•ì‹ `{ valid, error }`
- ìƒì„¸í•œ ì—ëŸ¬ ë©”ì‹œì§€
- í•œê¸€ ë©”ì‹œì§€ ì§€ì›
- XSS ë°©ì–´ ìœ í‹¸ë¦¬í‹° í¬í•¨

---

### 3. study-helpers.js â­â­â­
**ê²½ë¡œ**: `coup/src/lib/study-helpers.js`  
**í¬ê¸°**: ~390ì¤„  
**ì‘ì—… ì‹œê°„**: 6ì‹œê°„ (ì˜ˆìƒ)  

**ëª©ì **: ìŠ¤í„°ë”” ê´€ë ¨ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ í—¬í¼

**ì£¼ìš” ë‚´ìš©**:
- âœ… ì—­í•  ê³„ì¸µ êµ¬ì¡°
  - `ROLE_HIERARCHY` - ì—­í•  ìš°ì„ ìˆœìœ„ (OWNER: 3, ADMIN: 2, MEMBER: 1)

- âœ… ì •ì› ê´€ë¦¬ (1ê°œ)
  - `checkStudyCapacity()` - ì •ì› í™•ì¸ (isFull, currentCount, availableSlots)

- âœ… ê¶Œí•œ ê²€ì¦ (12ê°œ)
  - `canModifyMember()` - ë©¤ë²„ ìˆ˜ì • ê¶Œí•œ
  - `canChangeRole()` - ì—­í•  ë³€ê²½ ê¶Œí•œ
  - `canJoinStudy()` - ê°€ì… ê°€ëŠ¥ ì—¬ë¶€ (ëª¨ì§‘ ìƒíƒœ, ì •ì›, ê¸°ì¡´ ë©¤ë²„ì‹­)
  - `canKickMember()` - ê°•í‡´ ê°€ëŠ¥ ì—¬ë¶€
  - `canLeaveStudy()` - íƒˆí‡´ ê°€ëŠ¥ ì—¬ë¶€ (OWNER ì œì™¸)
  - `canDeleteStudy()` - ì‚­ì œ ê¶Œí•œ
  - `canModifyContent()` - ì»¨í…ì¸  ìˆ˜ì • ê¶Œí•œ
  - `canProcessJoinRequest()` - ê°€ì… ìš”ì²­ ì²˜ë¦¬ ê¶Œí•œ
  - `canChangeSettings()` - ì„¤ì • ë³€ê²½ ê¶Œí•œ
  - `isValidRole()` / `isValidMemberStatus()` - ìœ íš¨ì„± í™•ì¸
  - `compareRoles()` - ì—­í•  ë¹„êµ
  - `isAdminOrOwner()` - ê´€ë¦¬ì ì´ìƒ í™•ì¸

- âœ… ê²€ìƒ‰/ì •ë ¬ (2ê°œ)
  - `buildStudySearchQuery()` - Prisma where ì¿¼ë¦¬ ë¹Œë”
  - `buildStudySortQuery()` - Prisma orderBy ì¿¼ë¦¬ ë¹Œë”

**íŠ¹ì§•**:
- ì—­í•  ê¸°ë°˜ ê¶Œí•œ ì²´ê³„
- ìƒì„¸í•œ ê¶Œí•œ í™•ì¸ ë¡œì§
- ì¬ê°€ì… ì¿¨ë‹¤ìš´ (7ì¼) êµ¬í˜„
- ì¼ê´€ëœ ë°˜í™˜ í˜•ì‹ `{ canXxx, reason, errorKey }`

---

### 4. file-upload-helpers.js â­â­â­
**ê²½ë¡œ**: `coup/src/lib/file-upload-helpers.js`  
**í¬ê¸°**: ~380ì¤„  
**ì‘ì—… ì‹œê°„**: 5ì‹œê°„ (ì˜ˆìƒ)  

**ëª©ì **: íŒŒì¼ ì—…ë¡œë“œ ë³´ì•ˆ ë° ê²€ì¦

**ì£¼ìš” ë‚´ìš©**:
- âœ… íŒŒì¼ íƒ€ì… ê´€ë¦¬
  - `ALLOWED_FILE_TYPES` - í—ˆìš©ëœ MIME íƒ€ì… ë° í™•ì¥ì (30ê°œ+)
    - ë¬¸ì„œ: PDF, Word, Excel, PPT, TXT, CSV
    - ì´ë¯¸ì§€: JPEG, PNG, GIF, WebP, SVG
    - ì••ì¶•: ZIP, RAR, 7Z
    - ì½”ë“œ: JS, HTML, CSS, JSON, MD, Python, Java
  - `DANGEROUS_EXTENSIONS` - ìœ„í—˜í•œ í™•ì¥ì (14ê°œ)
    - ì‹¤í–‰ íŒŒì¼: .exe, .bat, .cmd, .com, .msi, .scr
    - ìŠ¤í¬ë¦½íŠ¸: .vbs, .js, .jar, .sh, .ps1
    - ë¼ì´ë¸ŒëŸ¬ë¦¬: .dll, .so, .dylib

- âœ… íŒŒì¼ í¬ê¸° ì œí•œ
  - `FILE_SIZE_LIMITS`
    - ê¸°ë³¸: 50MB
    - ì´ë¯¸ì§€: 10MB
    - ë¬¸ì„œ: 25MB
    - ì••ì¶• íŒŒì¼: 100MB
  - `STORAGE_LIMIT_PER_STUDY` - ìŠ¤í„°ë””ë‹¹ 1GB

- âœ… ê²€ì¦ í•¨ìˆ˜ (9ê°œ)
  - `validateFileType()` - íŒŒì¼ íƒ€ì… ê²€ì¦
  - `validateFileSize()` - íŒŒì¼ í¬ê¸° ê²€ì¦
  - `sanitizeFilename()` - íŒŒì¼ëª… ì•ˆì „í™”
  - `generateUniqueFilename()` - ê³ ìœ  íŒŒì¼ëª… ìƒì„±
  - `checkStudyStorage()` - ì €ì¥ ê³µê°„ ì‚¬ìš©ëŸ‰ í™•ì¸
  - `hasStorageSpace()` - ì €ì¥ ì—¬ìœ  í™•ì¸
  - `checkMaliciousFile()` - ì•…ì„± íŒŒì¼ íŒ¨í„´ ê²€ì‚¬
  - `validateFileUpload()` - í†µí•© ê²€ì¦
  - `ensureUploadDirectory()` - ë””ë ‰í† ë¦¬ ìƒì„±

- âœ… ë³´ì•ˆ ê¸°ëŠ¥
  - ë§¤ì§ ë„˜ë²„ ê²€ì‚¬ (EXE, ELF, Mach-O)
  - ì´ë¯¸ì§€ ë‚´ ìŠ¤í¬ë¦½íŠ¸ ê²€ì‚¬
  - ê²½ë¡œ íƒìƒ‰ ë°©ì§€ (../ ì œê±°)

**íŠ¹ì§•**:
- ë‹¤ì¸µ ë³´ì•ˆ ê²€ì¦
- ì €ì¥ ê³µê°„ ê´€ë¦¬
- ì‚¬ìš©ì ì¹œí™”ì  ì—ëŸ¬ ë©”ì‹œì§€
- íŒŒì¼ëª… ì•ˆì „í™”

---

### 5. notification-helpers.js â­â­
**ê²½ë¡œ**: `coup/src/lib/notification-helpers.js`  
**í¬ê¸°**: ~390ì¤„  
**ì‘ì—… ì‹œê°„**: 3ì‹œê°„ (ì˜ˆìƒ)  

**ëª©ì **: ì•Œë¦¼ ìƒì„± ìë™í™”

**ì£¼ìš” ë‚´ìš©**:
- âœ… ì•Œë¦¼ íƒ€ì…
  - `NOTIFICATION_TYPES` - 8ê°œ íƒ€ì…
    - JOIN_APPROVED, NOTICE, FILE, EVENT, TASK, MEMBER, KICK, CHAT

- âœ… ì•Œë¦¼ í…œí”Œë¦¿
  - `NOTIFICATION_TEMPLATES` - 15ê°œ í…œí”Œë¦¿
    - ê°€ì… ìŠ¹ì¸, ê³µì§€, íŒŒì¼, ì¼ì •, í• ì¼, ë©¤ë²„, ê°•í‡´, ì±„íŒ… ë©˜ì…˜

- âœ… ì•Œë¦¼ ìƒì„± í•¨ìˆ˜ (15ê°œ)
  - `createNotification()` - ë‹¨ì¼ ì•Œë¦¼ ìƒì„±
  - `createBulkNotifications()` - ì¼ê´„ ì•Œë¦¼ ìƒì„±
  - `notifyJoinApproved()` - ê°€ì… ìŠ¹ì¸ ì•Œë¦¼
  - `notifyNewNotice()` - ìƒˆ ê³µì§€ ì•Œë¦¼
  - `notifyFileUploaded()` - íŒŒì¼ ì—…ë¡œë“œ ì•Œë¦¼
  - `notifyEventCreated()` - ì¼ì • ìƒì„± ì•Œë¦¼
  - `notifyEventReminder()` - ì¼ì • ë¦¬ë§ˆì¸ë”
  - `notifyTaskAssigned()` - í• ì¼ ë°°ì • ì•Œë¦¼
  - `notifyTaskDueSoon()` - í• ì¼ ë§ˆê° ì„ë°• ì•Œë¦¼
  - `notifyMemberJoined()` - ìƒˆ ë©¤ë²„ ê°€ì… ì•Œë¦¼
  - `notifyRoleChanged()` - ì—­í•  ë³€ê²½ ì•Œë¦¼
  - `notifyKicked()` - ê°•í‡´ ì•Œë¦¼
  - `notifyChatMention()` - ì±„íŒ… ë©˜ì…˜ ì•Œë¦¼
  - `safeNotify()` - ì•ˆì „í•œ ì•Œë¦¼ ìƒì„± (ì‹¤íŒ¨í•´ë„ ê³„ì†)

**íŠ¹ì§•**:
- ì¼ê´€ëœ ì•Œë¦¼ í˜•ì‹
- ì‹¤íŒ¨í•´ë„ ê³„ì† ì§„í–‰ (safeNotify)
- ì¼ê´„ ì²˜ë¦¬ ì§€ì›
- í…œí”Œë¦¿ ê¸°ë°˜ ë©”ì‹œì§€ ìƒì„±

---

### 6. transaction-helpers.js â­â­â­
**ê²½ë¡œ**: `coup/src/lib/transaction-helpers.js`  
**í¬ê¸°**: ~560ì¤„  
**ì‘ì—… ì‹œê°„**: 4ì‹œê°„ (ì˜ˆìƒ)  

**ëª©ì **: ë°ì´í„° ì¼ê´€ì„± ë³´ì¥ íŠ¸ëœì­ì…˜

**ì£¼ìš” ë‚´ìš©**:
- âœ… ìŠ¤í„°ë”” ê´€ë¦¬ íŠ¸ëœì­ì…˜ (3ê°œ)
  - `createStudyWithOwner()` - ìŠ¤í„°ë”” ìƒì„± + OWNER ë©¤ë²„ ìë™ ìƒì„±
  - `deleteStudyWithRelations()` - ìŠ¤í„°ë”” ì‚­ì œ + ê´€ë ¨ ë°ì´í„° ì •ë¦¬
    - ì‚­ì œ ìˆœì„œ: ë©”ì‹œì§€ â†’ íŒŒì¼ â†’ í• ì¼ â†’ ì¼ì • â†’ ê³µì§€ â†’ ë©¤ë²„ â†’ ê°€ì…ìš”ì²­ â†’ ìŠ¤í„°ë””
  - `updateStudyWithValidation()` - ìŠ¤í„°ë”” ìˆ˜ì • + ì •ì› ê²€ì¦

- âœ… ë©¤ë²„ ê´€ë¦¬ íŠ¸ëœì­ì…˜ (5ê°œ)
  - `approveJoinRequestWithMember()` - ê°€ì… ìŠ¹ì¸ + ë©¤ë²„ ìƒì„± + ì •ì› ì¦ê°€
  - `kickMemberWithUpdate()` - ë©¤ë²„ ê°•í‡´ + ì •ì› ê°ì†Œ
  - `leaveMemberWithUpdate()` - ë©¤ë²„ íƒˆí‡´ + ì •ì› ê°ì†Œ
  - `joinStudyWithMember()` - ìŠ¤í„°ë”” ê°€ì… + ë©¤ë²„ ìƒì„± (ìë™/ìˆ˜ë™ ìŠ¹ì¸)
  - `changeRoleWithValidation()` - ì—­í•  ë³€ê²½ + ê²€ì¦

- âœ… ê³ ê¸‰ ê¸°ëŠ¥ (1ê°œ)
  - `retryTransaction()` - ë™ì‹œì„± ì˜¤ë¥˜ ì‹œ ìë™ ì¬ì‹œë„
    - P2034 ì—ëŸ¬ ê°ì§€
    - ì§€ìˆ˜ ë°±ì˜¤í”„ (100ms, 200ms, 400ms)
    - ìµœëŒ€ 3íšŒ ì¬ì‹œë„

**íŠ¹ì§•**:
- ì›ìì„± ë³´ì¥ (All or Nothing)
- ë°ì´í„° ì¼ê´€ì„± ìœ ì§€
- ìƒì„¸í•œ ë¡œê¹…
- ì¬ì‹œë„ ë©”ì»¤ë‹ˆì¦˜
- ì •ì› ìë™ ì—…ë°ì´íŠ¸

---

## ğŸ“Š íŒŒì¼ í†µê³„

| íŒŒì¼ | ì¤„ ìˆ˜ | í•¨ìˆ˜ ìˆ˜ | ìƒìˆ˜ ìˆ˜ | ìš°ì„ ìˆœìœ„ | ì†Œìš” ì‹œê°„ |
|------|-------|---------|---------|----------|-----------|
| study-errors.js | ~370 | 4 | 50 | â­â­â­ | 4ì‹œê°„ |
| study-validation.js | ~460 | 17 | 3 | â­â­â­ | 4ì‹œê°„ |
| study-helpers.js | ~390 | 18 | 1 | â­â­â­ | 6ì‹œê°„ |
| file-upload-helpers.js | ~380 | 15 | 4 | â­â­â­ | 5ì‹œê°„ |
| notification-helpers.js | ~390 | 15 | 2 | â­â­ | 3ì‹œê°„ |
| transaction-helpers.js | ~560 | 10 | 0 | â­â­â­ | 4ì‹œê°„ |
| **í•©ê³„** | **~2,550** | **79** | **60** | - | **26ì‹œê°„** |

---

## ğŸ¯ ì£¼ìš” ê¸°ëŠ¥ ìš”ì•½

### ì—ëŸ¬ ì²˜ë¦¬
- âœ… 50ê°œ ì—ëŸ¬ ì½”ë“œ ì •ì˜
- âœ… ì¼ê´€ëœ ì—ëŸ¬ ì‘ë‹µ í˜•ì‹
- âœ… Prisma ì—ëŸ¬ ë³€í™˜
- âœ… ì»¨í…ìŠ¤íŠ¸ ê¸°ë°˜ ë¡œê¹…

### ìœ íš¨ì„± ê²€ì¦
- âœ… 17ê°œ ê²€ì¦ í•¨ìˆ˜
- âœ… í†µí•© ê²€ì¦ ì§€ì›
- âœ… í•œê¸€ ë©”ì‹œì§€
- âœ… XSS ë°©ì–´

### ê¶Œí•œ ê´€ë¦¬
- âœ… ì—­í•  ê¸°ë°˜ ê¶Œí•œ ì²´ê³„
- âœ… 18ê°œ ê¶Œí•œ ê²€ì¦ í•¨ìˆ˜
- âœ… ì—­í•  ê³„ì¸µ êµ¬ì¡°
- âœ… ìƒì„¸í•œ ê¶Œí•œ í™•ì¸

### íŒŒì¼ ë³´ì•ˆ
- âœ… ë‹¤ì¸µ ë³´ì•ˆ ê²€ì¦
- âœ… ì•…ì„± íŒŒì¼ ê²€ì‚¬
- âœ… ì €ì¥ ê³µê°„ ê´€ë¦¬
- âœ… íŒŒì¼ëª… ì•ˆì „í™”

### ì•Œë¦¼ ì‹œìŠ¤í…œ
- âœ… 15ê°œ ì•Œë¦¼ í•¨ìˆ˜
- âœ… ì¼ê´„ ì²˜ë¦¬ ì§€ì›
- âœ… í…œí”Œë¦¿ ê¸°ë°˜ ë©”ì‹œì§€
- âœ… ì•ˆì „í•œ ì•Œë¦¼ ìƒì„±

### íŠ¸ëœì­ì…˜
- âœ… 10ê°œ íŠ¸ëœì­ì…˜ í•¨ìˆ˜
- âœ… ë°ì´í„° ì¼ê´€ì„± ë³´ì¥
- âœ… ìë™ ì¬ì‹œë„
- âœ… ìƒì„¸í•œ ë¡œê¹…

---

## ğŸ”— íŒŒì¼ ì˜ì¡´ì„±

```
study-errors.js (ë…ë¦½)
    â†“
study-validation.js (study-errors ì‚¬ìš©)
    â†“
study-helpers.js (study-errors ì‚¬ìš©)
    â†“
file-upload-helpers.js (study-errors ì‚¬ìš©)
    â†“
notification-helpers.js (ë…ë¦½, Prisma ì‚¬ìš©)
    â†“
transaction-helpers.js (study-errors, Prisma ì‚¬ìš©)
```

---

## âœ… ê²€ì¦ ê²°ê³¼

### ì»´íŒŒì¼ ì—ëŸ¬
- âŒ ì—†ìŒ - ëª¨ë“  íŒŒì¼ ì •ìƒ ì»´íŒŒì¼

### ê²½ê³ 
- âš ï¸ "ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” í•¨ìˆ˜" ê²½ê³  ë‹¤ìˆ˜
  - **ì›ì¸**: ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ë“¤ì´ ì•„ì§ API ë¼ìš°íŠ¸ì—ì„œ ì‚¬ìš©ë˜ì§€ ì•ŠìŒ
  - **í•´ê²°**: Step 2-4.2ì—ì„œ API ë¼ìš°íŠ¸ ìˆ˜ì • ì‹œ ìë™ í•´ê²°

### ì½”ë“œ í’ˆì§ˆ
- âœ… ì¼ê´€ëœ ë„¤ì´ë° ì»¨ë²¤ì…˜
- âœ… JSDoc ì£¼ì„ ì™„ë¹„
- âœ… ì—ëŸ¬ ì²˜ë¦¬ ì™„ë¹„
- âœ… ë¡œê¹… í‘œì¤€í™”

---

## ğŸ“ ë‹¤ìŒ ë‹¨ê³„ (Step 2-4.2)

### Critical ì˜ˆì™¸ ì²˜ë¦¬ êµ¬í˜„ (25ê°œ í•­ëª©)

#### ìš°ì„ ìˆœìœ„ 1: ë°ì´í„° ë¬´ê²°ì„± (10ê°œ, 20ì‹œê°„)
1. **ìŠ¤í„°ë”” ìƒì„± íŠ¸ëœì­ì…˜** (studies/route.js)
   - createStudyWithOwner() ì ìš©
   - í•„ë“œ ê²€ì¦ ê°•í™”
   - ì¤‘ë³µ ì´ë¦„ í™•ì¸

2. **ìŠ¤í„°ë”” ì‚­ì œ íŠ¸ëœì­ì…˜** (studies/[id]/route.js)
   - deleteStudyWithRelations() ì ìš©
   - ê´€ë ¨ ë°ì´í„° ì •ë¦¬
   - íŒŒì¼ ì‚­ì œ

3. **ê°€ì… ìŠ¹ì¸ íŠ¸ëœì­ì…˜** (join-requests/[requestId]/approve/route.js)
   - approveJoinRequestWithMember() ì ìš©
   - ì •ì› ì¬í™•ì¸
   - ì¤‘ë³µ ìŠ¹ì¸ ë°©ì§€

4. **ë©¤ë²„ ê°•í‡´ íŠ¸ëœì­ì…˜** (members/[userId]/route.js)
   - kickMemberWithUpdate() ì ìš©
   - ì—­í•  ê³„ì¸µ ê²€ì¦
   - ì•Œë¦¼ ìƒì„±

5. **ë©¤ë²„ íƒˆí‡´ íŠ¸ëœì­ì…˜** (leave/route.js)
   - leaveMemberWithUpdate() ì ìš©
   - OWNER íƒˆí‡´ ë°©ì§€

#### ìš°ì„ ìˆœìœ„ 2: ë³´ì•ˆ ê°•í™” (8ê°œ, 20ì‹œê°„)
6. **íŒŒì¼ ì—…ë¡œë“œ ê²€ì¦** (files/route.js)
   - validateFileUpload() ì ìš©
   - ì•…ì„± íŒŒì¼ ê²€ì‚¬
   - ì €ì¥ ê³µê°„ í™•ì¸

7. **XSS ë°©ì–´** (notices/route.js, chat/route.js)
   - escapeHtml() ì ìš©
   - HTML íƒœê·¸ í•„í„°ë§

8. **ê¶Œí•œ ê²€ì¦ ê°•í™”** (auth-helpers.js)
   - requireStudyMember ê°œì„ 
   - ì—­í•  ê³„ì¸µ ê²€ì¦

#### ìš°ì„ ìˆœìœ„ 3: ìœ íš¨ì„± ê²€ì¦ (7ê°œ, 20ì‹œê°„)
9. **ìŠ¤í„°ë”” ìƒì„± ê²€ì¦** (studies/route.js)
   - validateStudyCreation() ì ìš©
   - ëª¨ë“  í•„ë“œ ê²€ì¦

10. **ìŠ¤í„°ë”” ìˆ˜ì • ê²€ì¦** (studies/[id]/route.js)
    - validateStudyUpdate() ì ìš©
    - ì •ì› ë³€ê²½ ê²€ì¦

11. **ê³µì§€ ê²€ì¦** (notices/route.js)
    - validateNoticeTitle/Content() ì ìš©
    - ê¸¸ì´ ì œí•œ

12. **í• ì¼ ê²€ì¦** (tasks/route.js)
    - validateTaskTitle/DueDate() ì ìš©
    - ë‚ ì§œ ìœ íš¨ì„±

13. **ì¼ì • ê²€ì¦** (calendar/route.js)
    - validateEventTitle/Date() ì ìš©
    - ë‚ ì§œ ë²”ìœ„ í™•ì¸

---

## ğŸ‰ ë§ˆì¼ìŠ¤í†¤

### ì™„ë£Œëœ ê²ƒ âœ…
- [x] Step 2-1: auth ì˜ì—­ ë¶„ì„
- [x] Step 2-2: auth ì˜ì—­ Critical êµ¬í˜„
- [x] Step 2-3: study ì˜ì—­ ë¶„ì„
- [x] Step 2-4.1: study ìœ í‹¸ë¦¬í‹° íŒŒì¼ ìƒì„± (6ê°œ)
- [x] **Step 2-4.2 (1/13): ìŠ¤í„°ë”” ìƒì„± API** â† í˜„ì¬

### ì§„í–‰ ì¤‘ â³
- [ ] Step 2-4.2: study Critical êµ¬í˜„ (25ê°œ ì¤‘ 1ê°œ ì™„ë£Œ, 24ê°œ ë‚¨ìŒ)

### ë‹¤ìŒ ì‘ì—… ğŸ“‹
- [ ] Step 2-4.2 (2/13): ìŠ¤í„°ë”” ìˆ˜ì •/ì‚­ì œ API
- [ ] Step 2-4.3: study í…ŒìŠ¤íŠ¸ ë° ê²€ì¦
- [ ] Step 2-5: study Important êµ¬í˜„
- [ ] Step 2-6: study Nice-to-Have êµ¬í˜„

---

## ğŸ“ˆ ì§„í–‰ë¥ 

```
ì „ì²´ ì˜ˆì™¸ êµ¬í˜„ ì§„í–‰ë¥ 
â– â– â– â– â– â– â– â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡ 36%

Step 2-4 (study Critical) ì§„í–‰ë¥ 
â– â– â– â– â– â– â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡ 30%

ìœ í‹¸ë¦¬í‹° ìƒì„±: â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â–  100% âœ…
Critical êµ¬í˜„:  â– â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡   8% (1/13)
í…ŒìŠ¤íŠ¸/ê²€ì¦:    â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡   0%
```

**ìµœê·¼ ì™„ë£Œ**:
- âœ… studies/route.js - GET/POST í•¸ë“¤ëŸ¬ (2025-12-01)

**ë‹¤ìŒ ì‘ì—…**:
- â³ studies/[id]/route.js - GET/PATCH/DELETE í•¸ë“¤ëŸ¬

---

**ì‘ì„±ì**: GitHub Copilot  
**ìµœì¢… ì—…ë°ì´íŠ¸**: 2025-12-01  
**ë‹¤ìŒ ì„¸ì…˜**: Step 2-4.2 (2/13) - ìŠ¤í„°ë”” ìˆ˜ì •/ì‚­ì œ API ê°œì„ 

