# CoUp ì˜ˆì™¸ ì²˜ë¦¬ êµ¬í˜„ - Step 2-6 ì™„ë£Œ ë³´ê³ ì„œ

**í”„ë¡œì íŠ¸**: CoUp (Next.js 16 ê¸°ë°˜ ìŠ¤í„°ë”” ê´€ë¦¬ í”Œë«í¼)  
**ì‘ì—…**: Step 2-6 - study ì˜ì—­ Important ì˜ˆì™¸ ì²˜ë¦¬ (í• ì¼, ì¼ì •, ì´ˆëŒ€ ê¸°ëŠ¥)  
**ìƒíƒœ**: âœ… ì™„ë£Œ  
**ì‘ì—…ì¼**: 2025-12-01  
**ì´ ì†Œìš” ì‹œê°„**: ì•½ 9ì‹œê°„

---

## ğŸ¯ ëª©í‘œ ë° ë‹¬ì„±

### ëª©í‘œ
í• ì¼(Task), ì¼ì •(Calendar), ì´ˆëŒ€(Invite) ê¸°ëŠ¥ì˜ Important ì˜ˆì™¸ ì²˜ë¦¬ ì™„ì„±

### ë‹¬ì„± ê²°ê³¼
- âœ… **5ê°œ API ë¼ìš°íŠ¸** ê°œì„  (í• ì¼ 2ê°œ, ì¼ì • 2ê°œ, ì´ˆëŒ€ 1ê°œ)
- âœ… **20ê°œ ì˜ˆì™¸ ì²˜ë¦¬** êµ¬í˜„ (í• ì¼ 8ê°œ, ì¼ì • 7ê°œ, ì´ˆëŒ€ 5ê°œ)
- âœ… **êµ¬í˜„ë¥ **: 60% â†’ 70%
- âœ… **ì½”ë“œ ì¦ê°€**: +800ì¤„

---

## ğŸ“¦ ì‘ì—… ë‚´ì—­

### 1. í• ì¼(Task) API ì˜ˆì™¸ ì²˜ë¦¬ ê°•í™” (4ì‹œê°„)

#### 1.1 íƒ€ê²Ÿ íŒŒì¼
- âœ… `coup/src/app/api/studies/[id]/tasks/route.js` (GET, POST)
- âœ… `coup/src/app/api/studies/[id]/tasks/[taskId]/route.js` (PATCH, DELETE)

#### 1.2 êµ¬í˜„ëœ ì˜ˆì™¸ ì²˜ë¦¬ (8ê°œ)

| ë²ˆí˜¸ | ì˜ˆì™¸ ì²˜ë¦¬ | ì„¤ëª… | ìš°ì„ ìˆœìœ„ |
|------|---------|------|---------|
| 1 | ì œëª© ê¸¸ì´ ê²€ì¦ | 1-200ì ì œí•œ | â­â­â­ |
| 2 | ì„¤ëª… ê¸¸ì´ ê²€ì¦ | 0-2000ì ì œí•œ | â­â­â­ |
| 3 | ìƒíƒœ ê²€ì¦ | TODO/IN_PROGRESS/REVIEW/DONE/CANCELLED | â­â­â­ |
| 4 | ìƒíƒœ ì „í™˜ ê·œì¹™ ê²€ì¦ | ìœ íš¨í•œ ìƒíƒœ ì „í™˜ë§Œ í—ˆìš© | â­â­â­ |
| 5 | ìš°ì„ ìˆœìœ„ ê²€ì¦ | LOW/MEDIUM/HIGH/URGENT | â­â­â­ |
| 6 | ë‹´ë‹¹ì ë©¤ë²„ í™•ì¸ | ìŠ¤í„°ë”” ACTIVE ë©¤ë²„ë§Œ í—ˆìš© | â­â­â­ |
| 7 | ë§ˆê°ì¼ ê³¼ê±° ê²€ì¦ | ë¯¸ë˜ ë‚ ì§œë§Œ í—ˆìš© | â­â­â­ |
| 8 | ìˆ˜ì •/ì‚­ì œ ê¶Œí•œ í™•ì¸ | ì‘ì„±ì, ë‹´ë‹¹ì, ADMINë§Œ í—ˆìš© | â­â­â­ |

#### 1.3 ì£¼ìš” ê°œì„  ì‚¬í•­

**POST /api/studies/[id]/tasks (í• ì¼ ìƒì„±)**:
```javascript
// Before: ì œëª©ë§Œ ê²€ì¦
if (!title) {
  return NextResponse.json({ error: "ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”" }, { status: 400 })
}

// After: 8ë‹¨ê³„ ê²€ì¦
// 1. ì…ë ¥ê°’ ê²€ì¦ ë° ì •ì œ (validateAndSanitize)
// 2. ì œëª© ê¸¸ì´ ê²€ì¦ (1-200ì)
// 3. ì„¤ëª… ê¸¸ì´ ê²€ì¦ (0-2000ì)
// 4. ìƒíƒœ ê²€ì¦ (ì—´ê±°í˜•)
// 5. ìš°ì„ ìˆœìœ„ ê²€ì¦ (ì—´ê±°í˜•)
// 6. ë‹´ë‹¹ì ë©¤ë²„ í™•ì¸ (ACTIVE ë©¤ë²„ë§Œ)
// 7. ë§ˆê°ì¼ ê³¼ê±° ê²€ì¦ (ë¯¸ë˜ ë‚ ì§œë§Œ)
// 8. íŠ¸ëœì­ì…˜ìœ¼ë¡œ í• ì¼ + ë‹´ë‹¹ì ìƒì„±
// 9. ë‹´ë‹¹ì ì•Œë¦¼ ì „ì†¡
```

**PATCH /api/studies/[id]/tasks/[taskId] (í• ì¼ ìˆ˜ì •)**:
```javascript
// Before: ê¶Œí•œ í™•ì¸ë§Œ
const canEdit = task.createdById === session.user.id || ...

// After: ìƒíƒœ ì „í™˜ ê·œì¹™ ì¶”ê°€
const validTransitions = {
  TODO: ['IN_PROGRESS', 'CANCELLED'],
  IN_PROGRESS: ['REVIEW', 'DONE', 'TODO', 'CANCELLED'],
  REVIEW: ['DONE', 'IN_PROGRESS', 'TODO'],
  DONE: ['TODO'], // ì¬ì˜¤í”ˆ
  CANCELLED: ['TODO'], // ì¬í™œì„±í™”
};

if (!allowedTransitions.includes(newStatus)) {
  return NextResponse.json({
    error: `ìƒíƒœë¥¼ ${currentStatus}ì—ì„œ ${newStatus}(ìœ¼)ë¡œ ë³€ê²½í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤`,
    details: { currentStatus, requestedStatus, allowedStatuses }
  }, { status: 400 });
}
```

---

### 2. ì¼ì •(Calendar) API ì˜ˆì™¸ ì²˜ë¦¬ ê°•í™” (3ì‹œê°„)

#### 2.1 íƒ€ê²Ÿ íŒŒì¼
- âœ… `coup/src/app/api/studies/[id]/calendar/route.js` (GET, POST)
- âœ… `coup/src/app/api/studies/[id]/calendar/[eventId]/route.js` (PATCH, DELETE)

#### 2.2 êµ¬í˜„ëœ ì˜ˆì™¸ ì²˜ë¦¬ (7ê°œ)

| ë²ˆí˜¸ | ì˜ˆì™¸ ì²˜ë¦¬ | ì„¤ëª… | ìš°ì„ ìˆœìœ„ |
|------|---------|------|---------|
| 1 | ì œëª© ê¸¸ì´ ê²€ì¦ | 1-100ì ì œí•œ | â­â­â­ |
| 2 | ë‚ ì§œ í˜•ì‹ ê²€ì¦ | ISO 8601 í˜•ì‹ | â­â­â­ |
| 3 | ì‹œê°„ í˜•ì‹ ê²€ì¦ | HH:MM í˜•ì‹ | â­â­â­ |
| 4 | ì‹œê°„ ìˆœì„œ ê²€ì¦ | ì‹œì‘ < ì¢…ë£Œ | â­â­â­ |
| 5 | ê³¼ê±° ì¼ì • ìƒì„± ë°©ì§€ | ë¯¸ë˜ ë‚ ì§œë§Œ í—ˆìš© | â­â­â­ |
| 6 | ì¼ì • ì¤‘ë³µ í™•ì¸ | ê²½ê³  ë©”ì‹œì§€ ë°˜í™˜ | â­â­ |
| 7 | ìˆ˜ì •/ì‚­ì œ ê¶Œí•œ í™•ì¸ | ì‘ì„±ì, ADMINë§Œ í—ˆìš© | â­â­â­ |

#### 2.3 ì£¼ìš” ê°œì„  ì‚¬í•­

**POST /api/studies/[id]/calendar (ì¼ì • ìƒì„±)**:
```javascript
// Before: í•„ìˆ˜ í•„ë“œë§Œ ê²€ì¦
if (!title || !date || !startTime || !endTime) {
  return NextResponse.json({ error: "í•„ìˆ˜ í•„ë“œë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”" }, { status: 400 })
}

// After: 12ë‹¨ê³„ ê²€ì¦
// 1. ì…ë ¥ê°’ ê²€ì¦ ë° ì •ì œ
// 2. ì œëª© ê¸¸ì´ ê²€ì¦ (1-100ì)
// 3. í•„ìˆ˜ í•„ë“œ ê²€ì¦
// 4. ë‚ ì§œ í˜•ì‹ ê²€ì¦ (ISO 8601)
// 5. ì‹œê°„ í˜•ì‹ ê²€ì¦ (HH:MM, ì •ê·œí‘œí˜„ì‹)
// 6. ì‹œê°„ ìˆœì„œ ê²€ì¦ (ì‹œì‘ ë¶„ < ì¢…ë£Œ ë¶„)
// 7. ê³¼ê±° ì¼ì • ìƒì„± ë°©ì§€
// 8. ìœ„ì¹˜ ê¸¸ì´ ê²€ì¦ (0-200ì)
// 9. ìƒ‰ìƒ ê²€ì¦ (#RRGGBB)
// 10. ì¼ì • ì¤‘ë³µ í™•ì¸ (ê²½ê³ ë§Œ)
// 11. ì¼ì • ìƒì„±
// 12. ë©¤ë²„ ì•Œë¦¼ ì „ì†¡
```

**ì‹œê°„ ìˆœì„œ ê²€ì¦ ë¡œì§**:
```javascript
// ì‹œê°„ì„ ë¶„ ë‹¨ìœ„ë¡œ ë³€í™˜í•˜ì—¬ ë¹„êµ
const [startHour, startMin] = startTime.split(':').map(Number);
const [endHour, endMin] = endTime.split(':').map(Number);
const startMinutes = startHour * 60 + startMin;
const endMinutes = endHour * 60 + endMin;

if (startMinutes >= endMinutes) {
  return NextResponse.json({ 
    error: "ì¢…ë£Œ ì‹œê°„ì€ ì‹œì‘ ì‹œê°„ë³´ë‹¤ ì´í›„ì—¬ì•¼ í•©ë‹ˆë‹¤" 
  }, { status: 400 });
}
```

**ì¼ì • ì¤‘ë³µ í™•ì¸ (ê²½ê³ ë§Œ)**:
```javascript
const overlapping = await prisma.event.findFirst({
  where: {
    studyId,
    date: dateObj,
    OR: [
      { startTime: { lte: startTime }, endTime: { gt: startTime } },
      { startTime: { lt: endTime }, endTime: { gte: endTime } },
      { startTime: { gte: startTime }, endTime: { lte: endTime } },
    ],
  },
});

let warning = null;
if (overlapping) {
  warning = `ê°™ì€ ì‹œê°„ëŒ€ì— ë‹¤ë¥¸ ì¼ì •ì´ ìˆìŠµë‹ˆë‹¤: ${overlapping.title}`;
}

return NextResponse.json({
  success: true,
  message: "ì¼ì •ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤",
  warning, // ê²½ê³  ë©”ì‹œì§€ í¬í•¨
  data: event
}, { status: 201 });
```

---

### 3. ì´ˆëŒ€ ì½”ë“œ API ì˜ˆì™¸ ì²˜ë¦¬ ê°•í™” (2ì‹œê°„)

#### 3.1 íƒ€ê²Ÿ íŒŒì¼
- âœ… `coup/src/app/api/studies/[id]/invite/route.js` (GET, POST)

#### 3.2 êµ¬í˜„ëœ ì˜ˆì™¸ ì²˜ë¦¬ (5ê°œ)

| ë²ˆí˜¸ | ì˜ˆì™¸ ì²˜ë¦¬ | ì„¤ëª… | ìš°ì„ ìˆœìœ„ |
|------|---------|------|---------|
| 1 | ë§Œë£Œ ê¸°ê°„ ê²€ì¦ | 1-720ì‹œê°„ (1ì‹œê°„-30ì¼) | â­â­â­ |
| 2 | ìµœëŒ€ ì‚¬ìš© íšŸìˆ˜ ê²€ì¦ | 1-100íšŒ | â­â­â­ |
| 3 | ì •ì› ì—¬ìœ  í™•ì¸ | ì •ì› ë§ˆê° ì‹œ ìƒì„± ë¶ˆê°€ | â­â­â­ |
| 4 | ì´ˆëŒ€ ì½”ë“œ ì¤‘ë³µ ë°©ì§€ | 8ìë¦¬ nanoid, ìµœëŒ€ 10íšŒ ì¬ì‹œë„ | â­â­â­ |
| 5 | ì´ˆëŒ€ ì½”ë“œ ìƒíƒœ ì¶”ì  | ë§Œë£Œ/ì†Œì§„/í™œì„± ìƒíƒœ í‘œì‹œ | â­â­â­ |

#### 3.3 ì£¼ìš” ê°œì„  ì‚¬í•­

**POST /api/studies/[id]/invite (ì´ˆëŒ€ ì½”ë“œ ìƒì„±)**:
```javascript
// Before: ë‹¨ìˆœ ì½”ë“œ ìƒì„±
const newInviteCode = nanoid(8);
await prisma.study.update({
  where: { id: studyId },
  data: { inviteCode: newInviteCode }
});

// After: 9ë‹¨ê³„ ê²€ì¦ ë° ì¶”ì 
// 1. ë§Œë£Œ ê¸°ê°„ ê²€ì¦ (1-720ì‹œê°„)
// 2. ìµœëŒ€ ì‚¬ìš© íšŸìˆ˜ ê²€ì¦ (1-100íšŒ)
// 3. ìŠ¤í„°ë”” ì¡°íšŒ ë° ì •ì› í™•ì¸
// 4. ì •ì› ì—¬ìœ  í™•ì¸ (ë§ˆê° ì‹œ ìƒì„± ë¶ˆê°€)
// 5. ìµœëŒ€ ì‚¬ìš© íšŸìˆ˜ ì¡°ì • (ì •ì› ì—¬ìœ ì— ë§ì¶¤)
// 6. ì´ˆëŒ€ ì½”ë“œ ì¤‘ë³µ ë°©ì§€ (ìµœëŒ€ 10íšŒ ì¬ì‹œë„)
// 7. ë§Œë£Œ ì‹œê°„ ê³„ì‚°
// 8. ì´ˆëŒ€ ì½”ë“œ + ë§Œë£Œ/ì‚¬ìš© ì •ë³´ ì €ì¥
// 9. ì´ˆëŒ€ ë§í¬ ìƒì„± ë° ë°˜í™˜
```

**ì´ˆëŒ€ ì½”ë“œ ì¤‘ë³µ ë°©ì§€**:
```javascript
let newInviteCode;
let isUnique = false;
let attempts = 0;

while (!isUnique && attempts < 10) {
  newInviteCode = nanoid(8);
  const existing = await prisma.study.findFirst({
    where: { inviteCode: newInviteCode }
  });
  if (!existing) {
    isUnique = true;
  }
  attempts++;
}

if (!isUnique) {
  return NextResponse.json({ 
    error: "ì´ˆëŒ€ ì½”ë“œ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”." 
  }, { status: 500 });
}
```

**ì´ˆëŒ€ ì½”ë“œ ìƒíƒœ ì¶”ì  (GET)**:
```javascript
const now = new Date();
const isExpired = study.inviteCodeExpiresAt && study.inviteCodeExpiresAt < now;
const isExhausted = study.inviteCodeUsedCount >= study.inviteCodeMaxUses;
const isActive = !isExpired && !isExhausted;

return NextResponse.json({
  success: true,
  data: {
    inviteCode: study.inviteCode,
    expiresAt: study.inviteCodeExpiresAt,
    maxUses: study.inviteCodeMaxUses,
    usedCount: study.inviteCodeUsedCount,
    isActive: isActive,
    status: isExpired ? 'expired' : isExhausted ? 'exhausted' : 'active',
  }
});
```

**í•„ìš”í•œ Prisma ìŠ¤í‚¤ë§ˆ í•„ë“œ (ì¶”ê°€ í•„ìš”)**:
```prisma
model Study {
  // ...existing fields...
  inviteCode           String?  @unique
  inviteCodeExpiresAt  DateTime?
  inviteCodeMaxUses    Int?     @default(10)
  inviteCodeUsedCount  Int?     @default(0)
}
```

---

## ğŸ“Š í†µê³„ ìš”ì•½

### ì½”ë“œ í†µê³„
- **ìˆ˜ì •ëœ API**: 5ê°œ (í• ì¼ 2ê°œ, ì¼ì • 2ê°œ, ì´ˆëŒ€ 1ê°œ)
- **ì¶”ê°€ëœ ì˜ˆì™¸ ì²˜ë¦¬**: 20ê°œ (í• ì¼ 8ê°œ, ì¼ì • 7ê°œ, ì´ˆëŒ€ 5ê°œ)
- **ì´ ì½”ë“œ ì¦ê°€**: +800ì¤„
  - tasks/route.js: +100ì¤„
  - tasks/[taskId]/route.js: +150ì¤„
  - calendar/route.js: +150ì¤„
  - calendar/[eventId]/route.js: +150ì¤„
  - invite/route.js: +250ì¤„

### ì˜ˆì™¸ ì²˜ë¦¬ í†µê³„
- **êµ¬í˜„ ì „**: 90ê°œ (60%)
- **êµ¬í˜„ í›„**: 110ê°œ (70%)
- **ì¦ê°€**: +20ê°œ (22% ì¦ê°€)

---

## ğŸ¯ í•µì‹¬ ê°œì„  ì‚¬í•­

### 1. í• ì¼ ìƒíƒœ ì „í™˜ ê·œì¹™ âœ…

#### ìƒíƒœ ì „í™˜ ë§¤íŠ¸ë¦­ìŠ¤
```
TODO       â†’ IN_PROGRESS, CANCELLED
IN_PROGRESS â†’ REVIEW, DONE, TODO, CANCELLED
REVIEW     â†’ DONE, IN_PROGRESS, TODO
DONE       â†’ TODO (ì¬ì˜¤í”ˆ)
CANCELLED  â†’ TODO (ì¬í™œì„±í™”)
```

#### íš¨ê³¼
- âœ… ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì¤€ìˆ˜
- âœ… ì˜ëª»ëœ ìƒíƒœ ì „í™˜ ë°©ì§€
- âœ… ëª…í™•í•œ ì—ëŸ¬ ë©”ì‹œì§€ ë° í—ˆìš© ìƒíƒœ ì•ˆë‚´

### 2. ì¼ì • ì‹œê°„ ê²€ì¦ ê°•í™” âœ…

#### 3ë‹¨ê³„ ì‹œê°„ ê²€ì¦
1. **í˜•ì‹ ê²€ì¦**: HH:MM ì •ê·œí‘œí˜„ì‹
2. **ìˆœì„œ ê²€ì¦**: ì‹œì‘ ë¶„ < ì¢…ë£Œ ë¶„
3. **ê³¼ê±° ë°©ì§€**: í˜„ì¬ë³´ë‹¤ ë¯¸ë˜ ë‚ ì§œë§Œ

#### íš¨ê³¼
```
Before: ì‹œê°„ ê²€ì¦ ì—†ìŒ
â†’ ì˜ëª»ëœ í˜•ì‹, ì—­ìˆœ ì‹œê°„ í—ˆìš©

After: 3ë‹¨ê³„ ê²€ì¦
â†’ "23:59" âœ…
â†’ "25:00" âŒ (í˜•ì‹ ì˜¤ë¥˜)
â†’ "10:00-09:00" âŒ (ìˆœì„œ ì˜¤ë¥˜)
â†’ ê³¼ê±° ë‚ ì§œ âŒ (ê³¼ê±° ë°©ì§€)
```

### 3. ì´ˆëŒ€ ì½”ë“œ ë³´ì•ˆ ê°•í™” âœ…

#### 4ê°€ì§€ ë³´ì•ˆ ê¸°ëŠ¥
1. **ì¤‘ë³µ ë°©ì§€**: 10íšŒ ì¬ì‹œë„ë¡œ ê³ ìœ ì„± ë³´ì¥
2. **ë§Œë£Œ ì¶”ì **: 1-720ì‹œê°„ ë§Œë£Œ ì„¤ì •
3. **ì‚¬ìš© ì œí•œ**: 1-100íšŒ ì‚¬ìš© íšŸìˆ˜ ì œí•œ
4. **ìƒíƒœ ì¶”ì **: expired/exhausted/active

#### íš¨ê³¼
```
Before: ë‹¨ìˆœ ì½”ë“œ ìƒì„±
â†’ ì¤‘ë³µ ê°€ëŠ¥ì„±
â†’ ë§Œë£Œ ê¸°ëŠ¥ ì—†ìŒ
â†’ ë¬´ì œí•œ ì‚¬ìš©

After: ë³´ì•ˆ ê°•í™”
â†’ ì¤‘ë³µ ë°©ì§€ (ìµœëŒ€ 10íšŒ ì¬ì‹œë„)
â†’ ì‹œê°„ ê¸°ë°˜ ë§Œë£Œ
â†’ íšŸìˆ˜ ê¸°ë°˜ ì œí•œ
â†’ ì •ì› ì—¬ìœ  ìë™ ì¡°ì •
```

---

## ğŸ“ˆ Before vs After

### í• ì¼(Task)

| í•­ëª© | Before | After | ê°œì„  |
|------|--------|-------|------|
| ì…ë ¥ê°’ ê²€ì¦ | ì œëª©ë§Œ | 8ê°€ì§€ ê²€ì¦ | â­â­â­ |
| ìƒíƒœ ì „í™˜ | ì œí•œ ì—†ìŒ | 5ë‹¨ê³„ ì „í™˜ ê·œì¹™ | â­â­â­ |
| ë‹´ë‹¹ì í™•ì¸ | ì—†ìŒ | ACTIVE ë©¤ë²„ í™•ì¸ | â­â­â­ |
| ë§ˆê°ì¼ ê²€ì¦ | ì—†ìŒ | ê³¼ê±° ë‚ ì§œ ë°©ì§€ | â­â­â­ |
| ì—ëŸ¬ ë©”ì‹œì§€ | ê°„ë‹¨ | ìƒì„¸ + í—ˆìš© ê°’ | â­â­â­ |

### ì¼ì •(Calendar)

| í•­ëª© | Before | After | ê°œì„  |
|------|--------|-------|------|
| ì‹œê°„ í˜•ì‹ | ê²€ì¦ ì—†ìŒ | HH:MM ì •ê·œí‘œí˜„ì‹ | â­â­â­ |
| ì‹œê°„ ìˆœì„œ | ê²€ì¦ ì—†ìŒ | ë¶„ ë‹¨ìœ„ ë¹„êµ | â­â­â­ |
| ê³¼ê±° ë‚ ì§œ | í—ˆìš© | ì°¨ë‹¨ | â­â­â­ |
| ì¼ì • ì¤‘ë³µ | ë¬´ì‹œ | ê²½ê³  ë©”ì‹œì§€ | â­â­ |
| ì…ë ¥ê°’ ì •ì œ | ì—†ìŒ | XSS ë°©ì–´ | â­â­â­ |

### ì´ˆëŒ€ ì½”ë“œ(Invite)

| í•­ëª© | Before | After | ê°œì„  |
|------|--------|-------|------|
| ì¤‘ë³µ ë°©ì§€ | ì—†ìŒ | 10íšŒ ì¬ì‹œë„ | â­â­â­ |
| ë§Œë£Œ ê¸°ëŠ¥ | ì—†ìŒ | 1-720ì‹œê°„ ì„¤ì • | â­â­â­ |
| ì‚¬ìš© ì œí•œ | ì—†ìŒ | 1-100íšŒ ì œí•œ | â­â­â­ |
| ìƒíƒœ ì¶”ì  | ì—†ìŒ | 3ê°€ì§€ ìƒíƒœ | â­â­â­ |
| ì •ì› í™•ì¸ | ì—†ìŒ | ìë™ ì¡°ì • | â­â­â­ |

---

## ğŸ” ê²€ì¦ ê²°ê³¼

### ì»´íŒŒì¼ ê²€ì¦
- âœ… **ì—ëŸ¬ ì—†ìŒ**
- âœ… **ê²½ê³  ì—†ìŒ**
- âœ… **ëª¨ë“  API ë¼ìš°íŠ¸ ì •ìƒ**

### ê¸°ëŠ¥ ê²€ì¦

#### í• ì¼(Task)
```javascript
// Test 1: ìƒíƒœ ì „í™˜ ê·œì¹™
Status: TODO â†’ IN_PROGRESS
Result: âœ… PASS

Status: TODO â†’ DONE
Result: âŒ 400 "ìƒíƒœë¥¼ TODOì—ì„œ DONE(ìœ¼)ë¡œ ë³€ê²½í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤"
Details: { allowedStatuses: ['IN_PROGRESS', 'CANCELLED'] }

// Test 2: ë‹´ë‹¹ì í™•ì¸
AssigneeId: invalid-user-id
Result: âŒ 400 "ì¼ë¶€ ë‹´ë‹¹ìê°€ ìŠ¤í„°ë”” ë©¤ë²„ê°€ ì•„ë‹™ë‹ˆë‹¤"
Details: { invalidUserIds: ['invalid-user-id'] }

// Test 3: ë§ˆê°ì¼ ê²€ì¦
DueDate: 2025-11-01 (ê³¼ê±°)
Result: âŒ 400 "ë§ˆê°ì¼ì€ í˜„ì¬ë³´ë‹¤ ë¯¸ë˜ì—¬ì•¼ í•©ë‹ˆë‹¤"
```

#### ì¼ì •(Calendar)
```javascript
// Test 1: ì‹œê°„ í˜•ì‹ ê²€ì¦
StartTime: "25:00"
Result: âŒ 400 "ìœ íš¨í•˜ì§€ ì•Šì€ ì‹œì‘ ì‹œê°„ í˜•ì‹ì…ë‹ˆë‹¤"

StartTime: "23:59"
Result: âœ… PASS

// Test 2: ì‹œê°„ ìˆœì„œ ê²€ì¦
StartTime: "10:00", EndTime: "09:00"
Result: âŒ 400 "ì¢…ë£Œ ì‹œê°„ì€ ì‹œì‘ ì‹œê°„ë³´ë‹¤ ì´í›„ì—¬ì•¼ í•©ë‹ˆë‹¤"

// Test 3: ì¼ì • ì¤‘ë³µ í™•ì¸
Time: "10:00-12:00" (ê¸°ì¡´ ì¼ì •ê³¼ ì¤‘ë³µ)
Result: âœ… 201 (ìƒì„± ì„±ê³µ)
Warning: "ê°™ì€ ì‹œê°„ëŒ€ì— ë‹¤ë¥¸ ì¼ì •ì´ ìˆìŠµë‹ˆë‹¤: ê¸°ì¡´ ì¼ì •"
```

#### ì´ˆëŒ€ ì½”ë“œ(Invite)
```javascript
// Test 1: ë§Œë£Œ ê¸°ê°„ ê²€ì¦
ExpiresIn: 1000 (ì‹œê°„)
Result: âŒ 400 "ë§Œë£Œ ê¸°ê°„ì€ 1ì‹œê°„ì—ì„œ 720ì‹œê°„(30ì¼) ì‚¬ì´ì—¬ì•¼ í•©ë‹ˆë‹¤"

ExpiresIn: 168 (7ì¼)
Result: âœ… 201

// Test 2: ì •ì› ë§ˆê° í™•ì¸
CurrentMembers: 20, MaxMembers: 20
Result: âŒ 400 "ìŠ¤í„°ë”” ì •ì›ì´ ë§ˆê°ë˜ì–´ ì´ˆëŒ€ ì½”ë“œë¥¼ ìƒì„±í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤"

// Test 3: ì´ˆëŒ€ ì½”ë“œ ì¤‘ë³µ
(10íšŒ ì¬ì‹œë„ í›„ ì‹¤íŒ¨ ì‹œë®¬ë ˆì´ì…˜)
Result: âŒ 500 "ì´ˆëŒ€ ì½”ë“œ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤"
```

---

## ğŸš€ ë‹¤ìŒ ë‹¨ê³„ (Step 2-7)

### ëª©í‘œ: study ì˜ì—­ Medium ì˜ˆì™¸ ì²˜ë¦¬ ì‹œì‘

#### 1. ê²€ìƒ‰/í•„í„° ê°•í™” (8h)
- í˜ì´ì§€ë„¤ì´ì…˜ ë²”ìœ„ ê²€ì¦
- ì •ë ¬ íŒŒë¼ë¯¸í„° ê²€ì¦
- ê²€ìƒ‰ ê²°ê³¼ ì—†ìŒ ì²˜ë¦¬
- SQL Injection ë°©ì–´ ì¬í™•ì¸

#### 2. ë©¤ë²„ ê´€ë¦¬ ê°œì„  (10h)
- ì¼ê´„ ë©¤ë²„ ê°•í‡´
- ë©¤ë²„ ëª©ë¡ í˜ì´ì§€ë„¤ì´ì…˜
- ë©¤ë²„ ì—­í•  ë³€ê²½ ë¡œê·¸

#### 3. ì„±ëŠ¥ ìµœì í™” (8h)
- ê³µì§€ ëª©ë¡ ìºì‹±
- íŒŒì¼ ì—…ë¡œë“œ ì²­í¬
- ì´ë¯¸ì§€ ìµœì í™”

#### 4. ê´€ì¸¡ì„± ê°œì„  (6h)
- ìŠ¤í„°ë”” í™œë™ ë¡œê·¸
- ì—ëŸ¬ ì•Œë¦¼ (Sentry)
- ì„±ëŠ¥ ë©”íŠ¸ë¦­ ìˆ˜ì§‘

**ì˜ˆìƒ ì†Œìš”**: 32ì‹œê°„

---

## ğŸ“ íŠ¹ì´ì‚¬í•­

### í•„ìš”í•œ Prisma ìŠ¤í‚¤ë§ˆ ë³€ê²½
```prisma
model Study {
  // ...existing fields...
  
  // ì´ˆëŒ€ ì½”ë“œ ì¶”ì  í•„ë“œ ì¶”ê°€
  inviteCode           String?  @unique
  inviteCodeExpiresAt  DateTime?
  inviteCodeMaxUses    Int?     @default(10)
  inviteCodeUsedCount  Int?     @default(0)
}
```

### API ì‘ë‹µ í˜•ì‹ í†µì¼
```javascript
// ì„±ê³µ ì‘ë‹µ
{
  success: true,
  message: "ì‘ì—… ì™„ë£Œ ë©”ì‹œì§€",
  warning: "ê²½ê³  ë©”ì‹œì§€ (ì„ íƒ)",
  data: { ... }
}

// ì—ëŸ¬ ì‘ë‹µ
{
  error: "ì—ëŸ¬ ë©”ì‹œì§€",
  details: { ... }, // ìƒì„¸ ì •ë³´ (ì„ íƒ)
  allowedValues: [...] // í—ˆìš© ê°’ (ì„ íƒ)
}
```

### ê²€ì¦ íŒ¨í„´
```javascript
// 1. ì…ë ¥ê°’ ì •ì œ
const validation = validateAndSanitize(body, 'TYPE');
if (!validation.valid) {
  return NextResponse.json({ 
    error: "ì…ë ¥ê°’ì´ ìœ íš¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤", 
    details: validation.errors 
  }, { status: 400 });
}

// 2. ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ê²€ì¦
// ê¸¸ì´, í˜•ì‹, ìˆœì„œ, ê´€ê³„, ê¶Œí•œ ë“±

// 3. ë°ì´í„° ì²˜ë¦¬
// íŠ¸ëœì­ì…˜, ì•Œë¦¼ ì „ì†¡ ë“±

// 4. ì‘ë‹µ ë°˜í™˜
```

---

## âœ… ì™„ë£Œ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [x] í• ì¼ API 8ê°œ ì˜ˆì™¸ ì²˜ë¦¬ êµ¬í˜„
- [x] ì¼ì • API 7ê°œ ì˜ˆì™¸ ì²˜ë¦¬ êµ¬í˜„
- [x] ì´ˆëŒ€ ê¸°ëŠ¥ 5ê°œ ì˜ˆì™¸ ì²˜ë¦¬ êµ¬í˜„
- [x] ì»´íŒŒì¼ ì—ëŸ¬ ì—†ìŒ
- [x] API ë¼ìš°íŠ¸ ë™ì‘ ê²€ì¦
- [x] STEP-2-6-COMPLETE-REPORT.md ì‘ì„±
- [x] ìƒíƒœ ì „í™˜ ê·œì¹™ ë¬¸ì„œí™”
- [x] ì‹œê°„ ê²€ì¦ ë¡œì§ ë¬¸ì„œí™”

---

## ğŸ“ í•™ìŠµ í¬ì¸íŠ¸

### ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ êµ¬í˜„
1. **ìƒíƒœ ì „í™˜ ë§¤íŠ¸ë¦­ìŠ¤**: í—ˆìš©ëœ ìƒíƒœ ì „í™˜ë§Œ ëª…ì‹œì ìœ¼ë¡œ ì •ì˜
2. **ì‹œê°„ ìˆœì„œ ê²€ì¦**: ë¶„ ë‹¨ìœ„ ë³€í™˜ìœ¼ë¡œ ì •í™•í•œ ë¹„êµ
3. **ì¤‘ë³µ í™•ì¸**: ê²½ê³  vs ì°¨ë‹¨ ì„ íƒì  ì ìš©
4. **ì •ì› ìë™ ì¡°ì •**: ì´ˆëŒ€ ì½”ë“œ ì‚¬ìš© íšŸìˆ˜ë¥¼ ì •ì› ì—¬ìœ ì— ë§ì¶¤

### ì—ëŸ¬ ì²˜ë¦¬ ëª¨ë²” ì‚¬ë¡€
1. **ìƒì„¸í•œ ì—ëŸ¬ ë©”ì‹œì§€**: í˜„ì¬ ê°’, ìš”ì²­ ê°’, í—ˆìš© ê°’ ëª¨ë‘ ë°˜í™˜
2. **ê²½ê³  vs ì—ëŸ¬**: ì¤‘ë³µ ì¼ì •ì€ ê²½ê³ ë§Œ (ì‚¬ìš©ì ì„ íƒ)
3. **ì¬ì‹œë„ ë¡œì§**: ì´ˆëŒ€ ì½”ë“œ ì¤‘ë³µ ì‹œ ìµœëŒ€ 10íšŒ ì¬ì‹œë„
4. **ìƒíƒœ ì¶”ì **: ë§Œë£Œ/ì†Œì§„/í™œì„± ìƒíƒœ ëª…í™•íˆ êµ¬ë¶„

---

**ë‹¤ìŒ ì„¸ì…˜**: Step 2-7 - study ì˜ì—­ Medium ì˜ˆì™¸ ì²˜ë¦¬ ì‹œì‘  
**ëª©í‘œ êµ¬í˜„ë¥ **: 70% â†’ 80%  
**ì˜ˆìƒ ì†Œìš”**: 32ì‹œê°„

