# 07. 스터디 프리뷰 (Search Study Preview)

> **화면 ID**: `SEARCH-03`  
> **라우트**: `/studies/[studyId]`  
> **레이아웃**: 좌측 네비게이션(15%) + 우측 콘텐츠(85%)  
> **렌더링**: SSR (SEO 최적화)  
> **사용자 상태**: **미가입 (탐색 중)**

---

## 🎯 페이지 목적

**공개 스터디의 제한된 정보를 미리보기하여 가입 여부를 결정하도록 돕는 페이지**

- 가입 전 스터디의 기본 정보 확인
- 제한된 공지, 멤버 정보 제공
- 큰 "가입하기" 버튼으로 전환 유도
- 가입 후 → `/my-studies/[studyId]`로 자동 이동

---

## 📐 화면 구조

```
┌────────┬───────────────────────────────────────────────────────────────┐
│        │  Header                                                       │
│        ├───────────────────────────────────────────────────────────────┤
│        │  ← 스터디 탐색으로                                             │
│  Nav   │                                                               │
│  Bar   │  ┌─────────────────────────────────────────────────────────┐  │
│        │  │ 📚 코딩테스트 마스터 스터디                [🔍 탐색중]  │  │
│ 🏠     │  │                                                         │  │
│ 🔍 탐색│  │ OWNER: 김철수 | 12/20명 | 프로그래밍                   │  │
│ 👥 스터디│  │                                                         │  │
│ 📋     │  │ ⭐⭐⭐⭐⭐ 4.8 (24명 평가)                            │  │
│ 🔔     │  │                                                         │  │
│ 👤     │  │ [💚 가입하기 - 자동 승인]                              │  │
│        │  └─────────────────────────────────────────────────────────┘  │
│        │                                                               │
│        │  ┌───────────────────────────┬───────────────────────────┐  │
│        │  │ [메인 콘텐츠 70%]         │ [우측 위젯 30%]          │  │
│        │  │                           │                           │  │
│        │  │ 📝 스터디 소개            │ 👥 멤버 미리보기 (5명)    │  │
│        │  │ 매일 아침 알고리즘...     │ • 김철수 (OWNER)         │  │
│        │  │                           │ • 이영희 (ADMIN)         │  │
│        │  │ 📌 최근 공지 (2개)        │ • 박민수                 │  │
│        │  │ • 이번 주 일정 안내       │ • ...외 7명              │  │
│        │  │ • 참고 자료 공유          │                           │  │
│        │  │   [더보기는 가입 후]      │ 📊 스터디 정보           │  │
│        │  │                           │ • 생성일: 2025.10.01     │  │
│        │  │ 🏷️ 태그                  │ • 활동: 매일             │  │
│        │  │ #알고리즘 #코테 #매일     │ • 공개: 전체 공개        │  │
│        │  │                           │                           │  │
│        │  │ ⚠️ 참고                   │ 🎯 유사한 스터디         │  │
│        │  │ 가입 후 전체 기능 이용    │ • 알고리즘 스터디        │  │
│        │  │                           │ • 코딩 면접 대비         │  │
│        │  └───────────────────────────┴───────────────────────────┘  │
│        │                                                               │
└────────┴───────────────────────────────────────────────────────────────┘
```

---

## 🎨 섹션별 상세 설계

### 1. 상단 뒤로가기
```
← 스터디 탐색으로
```
- 클릭 → `/studies` (탐색 목록)

---

### 2. 스터디 헤더 카드
```
┌───────────────────────────────────────────────────────────┐
│ 📚 코딩테스트 마스터 스터디                    [🔍 탐색중] │
│                                                           │
│ OWNER: 김철수  |  12/20명  |  프로그래밍                  │
│                                                           │
│ ⭐⭐⭐⭐⭐ 4.8 (24명 평가)                              │
│                                                           │
│ [💚 가입하기 - 자동 승인]                                 │
│                                                           │
│ ⚠️ 가입 후 채팅, 파일, 캘린더 등 모든 기능을 이용할 수 있습니다 │
└───────────────────────────────────────────────────────────┘
```

**구성 요소**:
- 카테고리 이모지 (48px)
- 스터디명 (text-2xl, Bold)
- 상태 배지: `[🔍 탐색중]` (회색)
- 메타 정보: 그룹장, 멤버 수, 카테고리
- 평점 (선택 사항)
- **가입하기 버튼** (Primary, Large, 전체 너비)
  - 자동 승인: `[💚 가입하기 - 자동 승인]`
  - 수동 승인: `[📝 가입 신청하기]`
- 안내 메시지 (노란 배경)

---

### 3. 메인 콘텐츠 (70%)

#### 3-1. 스터디 소개
```
📝 스터디 소개
───────────────────────────────────
매일 아침 알고리즘 문제를 풀고 
서로의 풀이를 공유하며 성장하는 스터디입니다.

• 매일 오전 9시 문제 공유
• 저녁 8시 코드 리뷰
• 주 1회 모의 코딩테스트
```

**표시 내용**:
- 전체 설명 (제한 없음)
- 운영 방식
- 목표

---

#### 3-2. 최근 공지 (2개만)
```
📌 최근 공지
───────────────────────────────────
┌─────────────────────────────────┐
│ 📢 이번 주 일정 안내             │
│ 김철수 • 2시간 전               │
│                                 │
│ 이번 주는 백준 골드 문제로...    │
│ (미리보기 2줄)                   │
│                                 │
│ 🔒 전체 내용은 가입 후 확인      │
└─────────────────────────────────┘

┌─────────────────────────────────┐
│ 📢 참고 자료 공유                │
│ 이영희 • 1일 전                  │
│                                 │
│ 알고리즘 학습에 도움되는...      │
│ (미리보기 2줄)                   │
│                                 │
│ 🔒 전체 내용은 가입 후 확인      │
└─────────────────────────────────┘

⚠️ 가입하면 모든 공지를 확인할 수 있습니다
```

**표시 제한**:
- 최근 2개만 표시
- 제목 + 작성자 + 시간
- 내용은 2줄까지만 (나머지는 `...`)
- 🔒 잠금 표시로 제한 강조

---

#### 3-3. 태그
```
🏷️ 태그
───────────────────────────────────
#알고리즘  #코딩테스트  #매일  #백준  #프로그래머스
```

---

#### 3-4. 가입 안내
```
⚠️ 참고 사항
───────────────────────────────────
• 가입 후 모든 기능(채팅, 파일, 캘린더 등)을 이용할 수 있습니다
• 이 스터디는 자동 승인됩니다
• 언제든 탈퇴할 수 있습니다
```

---

### 4. 우측 위젯 (30%)

#### 4-1. 멤버 미리보기
```
┌─────────────────────────────────┐
│ 👥 멤버 미리보기                 │
│                                 │
│ 🟢 김철수 (OWNER)               │
│ 🟢 이영희 (ADMIN)               │
│ ⚪ 박민수                        │
│ ⚪ 최지은                        │
│ ⚪ 정소현                        │
│                                 │
│ ... 외 7명                       │
│                                 │
│ 🔒 전체 멤버는 가입 후 확인      │
└─────────────────────────────────┘
```

**표시 제한**:
- 상위 5명만 표시
- 그룹장(OWNER), 관리자(ADMIN) 표시
- 온라인 상태: 🟢 (온라인은 표시하지 않음, 모두 ⚪)
- 나머지 멤버 수 표시

---

#### 4-2. 스터디 정보
```
┌─────────────────────────────────┐
│ 📊 스터디 정보                   │
│                                 │
│ 📅 생성일: 2025.10.01           │
│ 🔥 활동: 매일                    │
│ 👁️ 공개: 전체 공개              │
│ ✅ 승인: 자동 승인               │
│ 🏷️ 카테고리: 프로그래밍         │
│                                 │
└─────────────────────────────────┘
```

---

#### 4-3. 유사한 스터디 추천
```
┌─────────────────────────────────┐
│ 🎯 유사한 스터디                 │
│                                 │
│ 📚 알고리즘 정복 스터디          │
│    15/20명 • 프로그래밍          │
│                                 │
│ 💼 코딩 면접 대비 스터디         │
│    8/15명 • 취업준비             │
│                                 │
│ [더 많은 스터디 보기 →]          │
└─────────────────────────────────┘
```

---

## 🎬 인터랙션

### 가입하기 버튼 클릭
```javascript
const handleJoinStudy = async () => {
  try {
    setIsJoining(true)
    
    // API 호출
    const response = await api.post(`/api/v1/studies/${studyId}/join`, {
      message: joinMessage // 선택 사항
    })
    
    // 성공 시
    if (response.data.autoApprove) {
      toast.success('가입이 완료되었습니다!')
      router.push(`/my-studies/${studyId}`) // 즉시 이동
    } else {
      toast.success('가입 신청이 완료되었습니다. 승인을 기다려주세요.')
      router.push(`/my-studies/${studyId}`) // 대기 상태로 이동
    }
    
  } catch (error) {
    if (error.code === 'ALREADY_JOINED') {
      // 이미 가입된 경우
      toast.info('이미 가입된 스터디입니다')
      router.push(`/my-studies/${studyId}`)
    } else {
      toast.error('가입 신청 중 오류가 발생했습니다')
    }
  } finally {
    setIsJoining(false)
  }
}
```

### 가입 여부 체크 (페이지 진입 시)
```javascript
useEffect(() => {
  const checkMembership = async () => {
    const membership = await api.get(`/api/v1/studies/${studyId}/my-membership`)
    
    if (membership) {
      // 이미 가입된 스터디 → 자동 리다이렉트
      toast.info('이미 가입된 스터디입니다')
      router.replace(`/my-studies/${studyId}`)
    }
  }
  
  checkMembership()
}, [studyId])
```

---

## 🔒 미가입자 정보 접근 권한 상세 설정

### 전체 접근 가능 정보 (100% 공개)

#### 1. 기본 정보
```
✅ 스터디명 (전체)
✅ 스터디 설명 (전체 - 제한 없음)
✅ 카테고리 / 서브 카테고리
✅ 태그 (전체)
✅ 생성일
✅ 그룹장 정보 (이름, 프로필 사진, 간단 소개)
✅ 멤버 수 (현재/최대)
✅ 공개 설정 (공개/비공개)
✅ 가입 승인 방식 (자동/수동)
✅ 활동 빈도 (매일/주2-3회/주1회 등)
✅ 스터디 이모지/아이콘
```

**이유**: 가입 결정에 필요한 핵심 정보로, 스터디의 성격을 파악할 수 있어야 함

---

#### 2. 공지사항 (제한적 공개)
```
✅ 최근 공지 2개
   - 공지 제목 (전체)
   - 작성자 이름
   - 작성 시간
   - 내용 미리보기 (최대 2줄, 약 100자)
   - 첨부파일 개수 표시 (파일명/내용은 숨김)

❌ 제한 사항:
   - 3개 이상의 공지는 숨김
   - 공지 전체 내용 접근 불가
   - 첨부파일 다운로드 불가
   - 댓글 보기 불가
   - 공지 검색 불가
```

**표시 예시**:
```
📢 이번 주 스터디 일정 안내
김철수 • 2시간 전 • 📎 1개

이번 주는 백준 골드 문제로 진행합니다. 
월요일 오전 9시까지 풀이를...

🔒 전체 내용 및 첨부파일은 가입 후 확인 가능
```

---

#### 3. 멤버 정보 (매우 제한적)
```
✅ 상위 5명만 표시
   - 그룹장 (OWNER) 1명 - 필수 표시
   - 관리자 (ADMIN) - 있는 경우 표시
   - 일반 멤버 - 나머지를 채움
   
✅ 각 멤버당 표시 정보:
   - 이름
   - 프로필 사진 (있는 경우)
   - 역할 (OWNER/ADMIN만 표시, MEMBER는 숨김)
   
❌ 제한 사항:
   - 온라인/오프라인 상태 숨김
   - 연락처 숨김
   - 가입일 숨김
   - 활동 통계 숨김
   - 멤버 프로필 상세 접근 불가
   - 멤버 검색 불가
   - 6번째 이후 멤버 숨김 ("...외 N명" 표시)
```

**표시 예시**:
```
👥 멤버 미리보기

⚪ 김철수 (OWNER)
⚪ 이영희 (ADMIN)
⚪ 박민수
⚪ 최지은
⚪ 정소현

... 외 7명

🔒 전체 멤버 및 상세 정보는 가입 후 확인
```

---

#### 4. 활동 통계 (요약만 공개)
```
✅ 전체 공지 개수 (숫자만)
✅ 전체 파일 개수 (숫자만)
✅ 이번 주 활동 횟수 (공지/파일 기준)
✅ 스터디 생성 후 경과 일수

❌ 제한 사항:
   - 채팅 메시지 수 숨김
   - 멤버별 활동 통계 숨김
   - 출석률 숨김
   - 할일 완료율 숨김
```

**표시 예시**:
```
📊 활동 현황 (요약)

• 운영 기간: 36일 (2025.10.01~)
• 공지: 총 12개
• 공유 파일: 총 28개
• 이번 주 활동: 5회

🔒 상세 통계는 가입 후 확인
```

---

### 전혀 접근 불가 정보 (0% 공개)

#### 1. 실시간 커뮤니케이션
```
❌ 채팅 내용 (전체 숨김)
❌ 채팅 참여자 목록
❌ 채팅 메시지 수
❌ 채팅 방 존재 여부
```

**미가입자에게 표시**:
```
💬 채팅

🔒 채팅은 가입 후 이용할 수 있습니다
가입하면 실시간으로 스터디원들과 소통할 수 있어요
```

---

#### 2. 파일 저장소
```
❌ 파일 목록 (전체 숨김)
❌ 파일명
❌ 파일 크기
❌ 업로드 날짜
❌ 파일 다운로드
❌ 폴더 구조
```

**미가입자에게 표시**:
```
📁 파일

🔒 파일 저장소는 가입 후 이용할 수 있습니다

현재 28개의 파일이 공유되어 있습니다
(자료, 문제풀이, 참고자료 등)
```

---

#### 3. 캘린더 / 일정
```
❌ 일정 목록 (전체 숨김)
❌ 일정 제목
❌ 일정 날짜/시간
❌ 참석자 정보
```

**미가입자에게 표시**:
```
📅 캘린더

🔒 일정은 가입 후 확인할 수 있습니다

정기 모임: 매주 월/수/금 오후 8시
```

---

#### 4. 할 일 관리
```
❌ 할일 목록 (전체 숨김)
❌ 할일 제목
❌ 담당자
❌ 마감일
❌ 완료 상태
```

**미가입자에게 표시**:
```
✅ 할 일

🔒 할 일은 가입 후 확인할 수 있습니다

스터디에서 함께 목표를 설정하고 관리할 수 있어요
```

---

#### 5. 화상 통화
```
❌ 화상 통화 기록 숨김
❌ 참여자 정보 숨김
❌ 통화 예약 숨김
```

**미가입자에게 표시**:
```
📹 화상 스터디

🔒 화상 통화는 가입 후 이용할 수 있습니다

가입하면 멤버들과 실시간으로 화상 스터디를 진행할 수 있어요
```

---

#### 6. 설정 / 관리
```
❌ 모든 설정 페이지 접근 불가
❌ 멤버 관리 불가
❌ 권한 설정 불가
```

---

### 부분 공개 정보 (미리보기)

#### 1. 스터디 규칙 (있는 경우)
```
✅ 규칙 제목 (전체)
✅ 규칙 요약 (최대 5개 항목)

❌ 상세 규칙 내용 숨김
```

**표시 예시**:
```
📜 스터디 규칙

• 매일 오전 9시까지 문제 풀이 제출
• 주 1회 코드 리뷰 참여 필수
• 결석 시 사전 공지
• 서로 존중하는 태도
• 학습 자료 적극 공유

🔒 상세 규칙은 가입 후 확인
```

---

#### 2. FAQ (자주 묻는 질문)
```
✅ 공개 FAQ (그룹장이 설정)
   - 질문 전체 공개
   - 답변 전체 공개
   
❌ 멤버 전용 FAQ 숨김
```

**표시 예시**:
```
❓ 자주 묻는 질문

Q: 초보자도 참여할 수 있나요?
A: 네! 알고리즘 기초부터 함께 학습합니다.

Q: 매일 참여해야 하나요?
A: 주 3회 이상 참여를 권장하지만 강제는 아닙니다.

Q: 비용이 있나요?
A: 무료 스터디입니다.
```

---

### 정보 표시 우선순위

#### Priority 1 (필수 - 항상 표시)
```
1. 스터디명
2. 스터디 설명
3. 카테고리
4. 그룹장 정보
5. 멤버 수
6. 가입 버튼
```

#### Priority 2 (중요 - 공간 있으면 표시)
```
7. 최근 공지 2개
8. 상위 멤버 5명
9. 태그
10. 활동 빈도
11. 스터디 규칙 요약
```

#### Priority 3 (참고 - 추가 정보)
```
12. 활동 통계 (요약)
13. FAQ
14. 생성일
15. 유사 스터디 추천
```

---

## 🎨 정보 제한 시각적 표현

### 1. 그라디언트 페이드 아웃
```css
/* 공지 내용 미리보기 */
.previewContent {
  max-height: 60px;
  overflow: hidden;
  position: relative;
}

.previewContent::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 30px;
  background: linear-gradient(
    to bottom, 
    rgba(255,255,255,0), 
    rgba(255,255,255,1)
  );
}
```

### 2. 블러 효과
```css
/* 멤버 6번째 이후 */
.hiddenMembers {
  filter: blur(8px);
  opacity: 0.3;
  pointer-events: none;
}
```

### 3. 잠금 오버레이
```css
/* 접근 불가 섹션 */
.lockedSection {
  position: relative;
  opacity: 0.6;
}

.lockedSection::before {
  content: '🔒';
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 48px;
  z-index: 10;
}
```

### 4. 안내 배너
```css
/* 가입 유도 메시지 */
.joinPrompt {
  background: linear-gradient(
    135deg, 
    var(--primary-500), 
    var(--primary-600)
  );
  color: white;
  padding: 16px 24px;
  border-radius: 8px;
  text-align: center;
  margin: 16px 0;
  font-weight: 600;
}
```

---

## 📊 정보 공개 수준 비교표

| 정보 항목 | 미가입자 (프리뷰) | 가입자 (PENDING) | 가입자 (MEMBER+) |
|----------|------------------|------------------|------------------|
| **기본 정보** | ✅ 전체 | ✅ 전체 | ✅ 전체 |
| **공지사항** | ⚠️ 최근 2개 미리보기 | ✅ 전체 (읽기만) | ✅ 전체 (읽기/쓰기) |
| **멤버 목록** | ⚠️ 상위 5명만 | ✅ 전체 | ✅ 전체 + 연락처 |
| **채팅** | ❌ 접근 불가 | ⚠️ 보기만 가능 | ✅ 전체 |
| **파일** | ❌ 접근 불가 | ✅ 다운로드만 | ✅ 전체 |
| **캘린더** | ❌ 접근 불가 | ✅ 보기만 | ✅ 전체 |
| **할일** | ❌ 접근 불가 | ✅ 보기만 | ✅ 전체 |
| **화상통화** | ❌ 접근 불가 | ❌ 접근 불가 | ✅ 참여 가능 |
| **설정** | ❌ 접근 불가 | ❌ 접근 불가 | ⚠️ 권한에 따라 |
| **통계** | ⚠️ 요약만 | ✅ 개인 통계 | ✅ 전체 통계 |

범례:
- ✅ 전체 접근 가능
- ⚠️ 제한적 접근
- ❌ 접근 불가

---

## 🔐 비공개 스터디 특별 처리

### 초대 링크가 있는 경우
```javascript
// URL: /studies/123?invite=abc123def456

if (study.visibility === 'PRIVATE' && hasValidInviteToken()) {
  // 프리뷰 표시 (공개 스터디와 동일)
  return <StudyPreview study={study} isInvited={true} />
}
```

**추가 표시**:
```
⚠️ 초대 전용 스터디

이 스터디는 비공개 스터디입니다.
초대 링크를 통해서만 가입할 수 있습니다.

유효 기간: 2025.11.10까지
초대자: 김철수
```

### 초대 링크가 없는 경우
```javascript
if (study.visibility === 'PRIVATE' && !hasInviteToken()) {
  return <NotFoundPage />
}
```

---

## 🎯 가입 전환 유도 전략

### 1. 점진적 정보 공개 (Progressive Disclosure)
```
화면 상단 (20%): 기본 정보 + 가입 버튼
        ↓
화면 중단 (40%): 공지 미리보기 (흥미 유발)
        ↓
화면 하단 (40%): 잠긴 기능들 + CTA

→ 스크롤하면서 자연스럽게 "가입하고 싶다"는 욕구 증가
```

### 2. FOMO (Fear of Missing Out) 활용
```
💬 "지금 3명이 채팅 중입니다"
📁 "이번 주에 5개의 새 파일이 공유되었습니다"
✅ "12개의 할일이 진행 중입니다"

🔒 가입하고 놓치지 마세요!
```

### 3. 사회적 증거 (Social Proof)
```
👥 12명이 활발하게 활동 중
⭐ 4.8/5.0 (24명 평가)
🔥 이번 주 5회 활동
📈 멤버 수 증가 추세

"많은 사람들이 선택한 스터디"
```

### 4. CTA 버튼 배치 전략
```
위치 1: 헤더 카드 (상단 - 첫 인상)
위치 2: 공지 미리보기 후 (중간 - 흥미 유발 후)
위치 3: 하단 고정 (모바일 - 항상 보임)

→ 3번의 가입 기회 제공
```

---

## 💡 추가 고려사항

### 1. SEO 최적화
```html
<!-- 프리뷰 페이지 메타 태그 -->
<meta name="description" content="[스터디 설명 100자]">
<meta property="og:title" content="[스터디명]">
<meta property="og:description" content="[스터디 설명]">
<meta property="og:image" content="[스터디 썸네일]">
```

### 2. 공유 기능
```
📤 스터디 공유하기
→ 카카오톡, 페이스북, 트위터, 링크 복사
→ 공유 시 초대 토큰 자동 생성 (선택적)
```

### 3. 관심 스터디 등록
```
⭐ 관심 스터디로 추가
→ 비회원도 가능
→ 로그인 시 대시보드에서 확인
→ 나중에 가입 결정 가능
```

### 4. 미리보기 제한 우회 방지
```javascript
// API 레벨에서 검증
app.get('/api/v1/studies/:id/notices', checkMembership, async (req, res) => {
  const membership = req.membership
  
  if (!membership) {
    // 미가입자: 최근 2개만 미리보기
    return res.json({
      notices: await getRecentNotices(req.params.id, 2, true), // preview mode
      hasMore: true
    })
  }
  
  // 가입자: 전체 공지
  return res.json({
    notices: await getAllNotices(req.params.id),
    hasMore: false
  })
})
```

---

## 🔒 접근 제어
