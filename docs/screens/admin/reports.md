# 20. 관리자 - 신고 관리 (Admin Reports Management)

> **화면 ID**: `ADMIN-04`  
> **라우트**: `/admin/reports`  
> **레이아웃**: 반응형 비율 기반 (모든 해상도 대응)  
> **구조**: 좌측 Admin Nav(12%) + 메인 콘텐츠(58%) + 우측 위젯(30%)  
> **렌더링**: CSR (실시간 업데이트)  
> **권한**: SYSTEM_ADMIN  
> **색상**: 레드 계열 (관리자 테마)

---

## 📐 반응형 레이아웃 (비율 기반)

```
┌────────────┬────────────────────────────────────────────────────┬──────────────┐
│  Admin Nav │              Main Content (58%)                    │ Right Widget │
│   (12%)    │                                                    │   (30%)      │
│            │                                                    │              │
│            │  ┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓ │              │
│ 📊 대시보드 │  ┃  신고 관리              총 25건  [새로고침] ┃ │ ⚠️ 신고    │
│ 👥 사용자  │  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛ │   통계     │
│ 📚 스터디  │                                                    │              │
│ ⚠️ 신고   │  ┌────────────────────────────────────────────┐    │ 미처리: 12 │
│ 📈 통계   │  │ [전체▼] [미처리▼] [처리중▼] [완료▼]        │    │ 처리중: 5  │
│ ⚙️ 설정   │  │                                            │    │ 완료: 8    │
│           │  │ [유형▼] [우선순위▼]     🔍 검색...         │    │            │
│           │  └────────────────────────────────────────────┘    │ ━━━━━━━━━ │
│ ━━━━━━━━━ │                                                    │            │
│           │  ┌──────────────────────────────────────────────┐  │ 📊 유형별  │
│ 🏠 메인으로│  │☑│유형│대상│신고자│신고일│우선순위│상태│액션│ │   현황     │
│ 🚪 로그아웃│  ├──────────────────────────────────────────────┤  │            │
│           │  │☐│🔴│스팸│스터디A│김철수│11.15│긴급│미처리│[...]│ │ 스팸: 8건 │
│  12%      │  │☐│🟠│욕설│사용자B│이영희│11.14│높음│미처리│[...]│ │ 욕설: 5건 │
│           │  │☐│🟡│부적절│스터디C│박민수│11.13│중간│처리중│[...]│ │ 부적절:4건│
│           │  │☐│🟠│욕설│사용자D│최지은│11.12│높음│미처리│[...]│ │ 저작권:3건│
│           │  │☐│🔴│스팸│스터디E│정소현│11.11│긴급│미처리│[...]│ │ 기타: 5건 │
│           │  │☐│🟢│기타│스터디F│강민준│11.10│낮음│완료│[...]│ │            │
│           │  │☐│🟡│부적절│사용자G│윤서아│11.09│중간│완료│[...]│ │ ━━━━━━━━━ │
│           │  │☐│🔴│스팸│스터디H│장도윤│11.08│긴급│완료│[...]│ │            │
│           │  │☐│🔵│저작권│파일I│임하은│11.07│중간│처리중│[...]│ │ ⏱️ 처리   │
│           │  │☐│🟠│욕설│메시지J│한예준│11.06│높음│완료│[...]│ │   시간     │
│           │  │                                              │  │            │
│           │  │ [...]                                        │  │ 평균 3시간 │
│           │  └──────────────────────────────────────────────┘  │ 최장 2일   │
│           │                                                    │ 최단 10분  │
│           │  [☑ 선택한 신고 처리]                              │            │
│           │  [일괄 처리] [일괄 기각]                           │ ━━━━━━━━━ │
│           │                                                    │            │
│           │  ← [1] 2 3 ... 3 →  [10개씩▼]                     │ ⚡ 빠른    │
│           │                                                    │   액션     │
│           │                   58%                              │            │
│           │                                                    │ [긴급처리] │
│           │                                                    │ [엑셀추출] │
└────────────┴────────────────────────────────────────────────────┴──────────────┘
```

---

## 🎨 섹션별 상세 설계

### 1. 필터 및 검색 바 (상단)

```
┌──────────────────────────────────────────────────────────────┐
│ [전체 ▼] [미처리 ▼] [처리중 ▼] [완료 ▼]                      │
│                                                              │
│ [유형 ▼] [우선순위 ▼] [대상 타입 ▼]     🔍 검색... [고급검색]│
└──────────────────────────────────────────────────────────────┘
```

**필터 옵션**:
1. **상태**:
   - 전체
   - 미처리 (PENDING)
   - 처리중 (IN_PROGRESS)
   - 완료 (RESOLVED)
   - 기각 (REJECTED)

2. **유형**:
   - 스팸/광고
   - 욕설/비방
   - 부적절한 콘텐츠
   - 저작권 침해
   - 개인정보 유출
   - 기타

3. **우선순위**:
   - 긴급 (URGENT) - 24시간 내
   - 높음 (HIGH) - 48시간 내
   - 중간 (MEDIUM) - 1주일 내
   - 낮음 (LOW)

4. **대상 타입**:
   - 스터디
   - 사용자
   - 메시지
   - 공지
   - 파일

**고급 검색 모달**:
```
┌─────────────────────────────────────┐
│ 🔍 고급 검색                        │
├─────────────────────────────────────┤
│                                     │
│ 신고 기간                            │
│ [2025-11-01] ~ [2025-11-17]        │
│                                     │
│ 신고자                              │
│ [ _____________ ]                   │
│                                     │
│ 대상 ID                             │
│ [ _____________ ]                   │
│                                     │
│ 처리자                              │
│ [전체 ▼]                            │
│                                     │
│ 키워드                              │
│ [ _____________ ]                   │
│                                     │
│ [초기화] [검색]                      │
└─────────────────────────────────────┘
```

---

### 2. 신고 테이블 (메인)

```
┌────┬────┬────────┬────────┬────────┬────────┬────────┬────────┐
│ ☑  │ 🚨 │ 유형    │ 대상    │ 신고자  │ 우선순위│ 상태   │ 액션   │
├────┼────┼────────┼────────┼────────┼────────┼────────┼────────┤
│ ☐  │ 🔴 │ 스팸   │스터디  │김철수   │ 긴급   │미처리  │[...]   │
│    │    │        │코딩테스트│kim@... │ 2시간전│PENDING │        │
│    │    │        │(Study#1)│        │        │        │        │
├────┼────┼────────┼────────┼────────┼────────┼────────┼────────┤
│ ☐  │ 🟠 │ 욕설   │사용자  │이영희   │ 높음   │미처리  │[...]   │
│    │    │        │박민수   │lee@... │ 5시간전│PENDING │        │
│    │    │        │(User#2) │        │        │        │        │
├────┼────┼────────┼────────┼────────┼────────┼────────┼────────┤
│ ☐  │ 🟡 │부적절  │메시지  │최지은   │ 중간   │처리중  │[...]   │
│    │    │        │"..."    │choi@...│ 1일전  │PROGRESS│        │
│    │    │        │(Msg#123)│        │admin#1 │        │        │
├────┼────┼────────┼────────┼────────┼────────┼────────┼────────┤
│ ☐  │ 🟢 │ 기타   │공지    │정소현   │ 낮음   │완료    │[...]   │
│    │    │        │스터디소개│jung@...│ 2일전  │RESOLVED│        │
│    │    │        │(Note#45)│        │admin#1 │경고발송│
└────┴────┴────────┴────────┴────────┴────────┴────────┴────────┘
```

**컬럼 구성**:
1. **체크박스**: 다중 선택
2. **우선순위 아이콘**:
   - 🔴 긴급 (빨간색)
   - 🟠 높음 (오렌지)
   - 🟡 중간 (노란색)
   - 🟢 낮음 (초록색)
3. **유형**: 스팸, 욕설, 부적절, 저작권, 기타
4. **대상**: 
   - 타입 (스터디/사용자/메시지/공지/파일)
   - 이름 또는 일부 내용
   - ID
5. **신고자**: 
   - 이름
   - 이메일
6. **우선순위**: 
   - 긴급/높음/중간/낮음
   - 경과 시간
   - 처리자 (처리중/완료 시)
7. **상태**: 
   - 미처리 (빨간색)
   - 처리중 (노란색)
   - 완료 (초록색)
   - 기각 (회색)
8. **액션**: 드롭다운 메뉴

**우선순위 계산 로직**:
```javascript
// 자동 우선순위 할당
function calculatePriority(report) {
  let score = 0
  
  // 신고 유형별 점수
  if (report.type === 'SPAM') score += 3
  if (report.type === 'HARASSMENT') score += 3
  if (report.type === 'INAPPROPRIATE') score += 2
  if (report.type === 'COPYRIGHT') score += 2
  
  // 신고자 신뢰도
  score += report.reporter.trustScore / 10
  
  // 누적 신고 수 (같은 대상)
  score += report.targetReportCount
  
  // 우선순위 결정
  if (score >= 7) return 'URGENT'
  if (score >= 5) return 'HIGH'
  if (score >= 3) return 'MEDIUM'
  return 'LOW'
}
```

---

### 3. 액션 드롭다운 메뉴

```
[...] 클릭 시:

┌──────────────────────┐
│ 👁️ 상세 보기         │
│ 📊 관련 신고 보기     │
│ ━━━━━━━━━━━━━━━━━━  │
│ ✅ 처리 시작          │
│ ⚠️ 경고 발송         │
│ 🚫 계정 정지         │
│ 🗑️ 콘텐츠 삭제       │
│ ✓ 신고 기각          │
│ ━━━━━━━━━━━━━━━━━━  │
│ 🏷️ 우선순위 변경     │
│ 👤 처리자 할당       │
└──────────────────────┘
```

---

### 4. 신고 상세 모달

```
┌────────────────────────────────────────────────────────────┐
│ 신고 상세 정보                                  [✕]        │
├────────────────────────────────────────────────────────────┤
│                                                            │
│  ┌──────────────────────────────────────────────────────┐  │
│  │ 🔴 [스팸] 긴급 신고                                  │  │
│  │                                                      │  │
│  │ 신고 ID: #123                                        │  │
│  │ 상태: 미처리 (PENDING)                               │  │
│  │ 우선순위: 긴급 (2시간 경과)                          │  │
│  │ 신고일시: 2025-11-17 08:30                           │  │
│  └──────────────────────────────────────────────────────┘  │
│                                                            │
│  ┌────────────────┐  ┌──────────────────────────────┐     │
│  │ 신고자 정보     │  │ 대상 정보                    │     │
│  │                │  │                              │     │
│  │ 👤 김철수       │  │ 📚 코딩테스트 스터디          │     │
│  │ kim@...        │  │ ID: #1                       │     │
│  │ Google 계정    │  │ 그룹장: 이영희                │     │
│  │                │  │ 멤버: 12/20                  │     │
│  │ 신뢰도: 85%    │  │ 생성일: 2025-11-01           │     │
│  │ 이전 신고: 2건 │  │                              │     │
│  └────────────────┘  │ 이전 신고: 3건 ⚠️            │     │
│                      │ (다른 2명이 신고)             │     │
│                      └──────────────────────────────┘     │
│                                                            │
│  ┌────────────────────────────────────────────────────┐   │
│  │ 신고 사유                                          │   │
│  │                                                    │   │
│  │ "이 스터디에서 지속적으로 광고성 메시지를 보내고   │   │
│  │  있습니다. 스터디와 관계없는 상품을 판매하려고     │   │
│  │  합니다."                                          │   │
│  └────────────────────────────────────────────────────┘   │
│                                                            │
│  ┌────────────────────────────────────────────────────┐   │
│  │ 증거 자료                                          │   │
│  │                                                    │   │
│  │ 🖼️ 스크린샷 3장                                    │   │
│  │ [screenshot1.png] [screenshot2.png] [...]          │   │
│  │                                                    │   │
│  │ 💬 관련 메시지 5개                                 │   │
│  │ "상품 구매하세요..." (2025-11-16 10:30)            │   │
│  │ "할인 중입니다..." (2025-11-16 14:20)              │   │
│  │ [더보기]                                           │   │
│  └────────────────────────────────────────────────────┘   │
│                                                            │
│  ┌────────────────────────────────────────────────────┐   │
│  │ 처리 옵션                                          │   │
│  │                                                    │   │
│  │ ( ) ⚠️ 경고 발송 (1차 경고)                       │   │
│  │ ( ) 🚫 계정 정지 (7일/30일/영구)                  │   │
│  │ ( ) 🗑️ 콘텐츠 삭제 + 경고                        │   │
│  │ (•) ⭐ 콘텐츠 삭제 + 계정 정지 (7일)              │   │
│  │ ( ) ✓ 신고 기각 (부당 신고)                       │   │
│  │                                                    │   │
│  │ 처리 메모                                          │   │
│  │ ┌──────────────────────────────────────────────┐  │   │
│  │ │ 광고성 메시지 3회 반복 확인.                 │  │   │
│  │ │ 7일 정지 및 관련 메시지 전체 삭제 처리.      │  │   │
│  │ └──────────────────────────────────────────────┘  │   │
│  │                                                    │   │
│  │ ☑ 신고자에게 처리 결과 통보                       │   │
│  │ ☑ 대상에게 이메일 발송                            │   │
│  │ ☑ 관련 멤버들에게 알림                            │   │
│  └────────────────────────────────────────────────────┘   │
│                                                            │
│            [취소] [처리 완료]                              │
│                                                            │
└────────────────────────────────────────────────────────────┘
```

---

### 5. 일괄 처리 모달

```
┌─────────────────────────────────────┐
│ ✅ 일괄 처리                         │
├─────────────────────────────────────┤
│                                     │
│ 선택한 3건의 신고를 처리합니다       │
│                                     │
│ • [스팸] 코딩테스트 스터디           │
│ • [욕설] 박민수 사용자               │
│ • [스팸] 취업준비 스터디             │
│                                     │
│ 처리 방법                            │
│ (•) 경고 발송                       │
│ ( ) 계정 정지 (7일)                 │
│ ( ) 콘텐츠 삭제                     │
│                                     │
│ 처리 메모 (선택)                     │
│ ┌─────────────────────────────────┐ │
│ │                                 │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ☑ 신고자들에게 결과 통보            │
│                                     │
│ [취소] [일괄 처리]                   │
└─────────────────────────────────────┘
```

---

### 6. 우측 위젯 (30%)

#### 6.1 신고 통계

```
┌──────────────────┐
│ ⚠️ 신고 통계     │
├──────────────────┤
│                  │
│ 전체 신고         │
│   25건           │
│                  │
│ ━━━━━━━━━━━━━━  │
│                  │
│ 미처리: 12건     │
│ 처리중: 5건      │
│ 완료: 8건        │
│                  │
│ ━━━━━━━━━━━━━━  │
│                  │
│ 오늘 신고         │
│   3건            │
│                  │
│ 오늘 처리         │
│   2건            │
│                  │
└──────────────────┘
```

---

#### 6.2 유형별 현황

```
┌──────────────────┐
│ 📊 유형별 현황   │
├──────────────────┤
│                  │
│ 🔴 스팸/광고     │
│    8건           │
│ [검색]           │
│                  │
│ 🟠 욕설/비방     │
│    5건           │
│ [검색]           │
│                  │
│ 🟡 부적절        │
│    4건           │
│ [검색]           │
│                  │
│ 🔵 저작권        │
│    3건           │
│ [검색]           │
│                  │
│ 🟢 기타          │
│    5건           │
│ [검색]           │
│                  │
└──────────────────┘
```

---

#### 6.3 처리 시간

```
┌──────────────────┐
│ ⏱️ 처리 시간     │
├──────────────────┤
│                  │
│ 평균 처리 시간    │
│   3시간          │
│                  │
│ 최장 처리 시간    │
│   2일            │
│                  │
│ 최단 처리 시간    │
│   10분           │
│                  │
│ ━━━━━━━━━━━━━━  │
│                  │
│ 목표: 24시간 이내│
│ 달성률: 85%      │
│                  │
└──────────────────┘
```

---

#### 6.4 빠른 액션

```
┌──────────────────┐
│ ⚡ 빠른 액션     │
├──────────────────┤
│                  │
│ [긴급 신고만]    │
│ (우선순위 필터)  │
│                  │
│ [일괄 처리]      │
│ (선택 신고)      │
│                  │
│ [엑셀 추출]      │
│ (전체 목록)      │
│                  │
│ ━━━━━━━━━━━━━━  │
│                  │
│ [신고 유형 관리] │
│                  │
└──────────────────┘
```

---

## 🔄 인터랙션 플로우

### 1. 신고 처리

```
신고 선택
  ↓
[...] 메뉴 → [상세 보기]
  ↓
신고 상세 모달
  ↓
처리 방법 선택
  - 경고 발송
  - 계정 정지
  - 콘텐츠 삭제
  - 신고 기각
  ↓
처리 메모 작성
  ↓
[처리 완료] 클릭
  ↓
API: PATCH /api/v1/admin/reports/{reportId}/resolve
  Body: { action, reason, notifyReporter }
  ↓
성공 Toast
  ↓
테이블 업데이트
  ↓
신고자/대상에게 이메일 발송
```

### 2. 자동 우선순위 조정

```
신고 접수
  ↓
우선순위 계산
  - 신고 유형 점수
  - 신고자 신뢰도
  - 누적 신고 수
  ↓
24시간 경과 시
  ↓
우선순위 상승
  LOW → MEDIUM → HIGH → URGENT
  ↓
긴급 신고 알림
  - 관리자 이메일
  - 시스템 알림
```

---

## 📊 API 엔드포인트

### 1. 신고 목록 조회

```javascript
GET /api/v1/admin/reports?status=PENDING&type=SPAM&priority=URGENT

Response:
{
  reports: [
    {
      id: 1,
      type: 'SPAM',
      targetType: 'STUDY',
      targetId: 1,
      targetName: '코딩테스트 스터디',
      reporter: { id: 5, name: '김철수', email: 'kim@...', trustScore: 85 },
      reason: '광고성 메시지 반복',
      evidence: {
        screenshots: ['url1', 'url2'],
        messages: [{ id: 123, content: '...' }]
      },
      priority: 'URGENT',
      status: 'PENDING',
      assignee: null,
      createdAt: '2025-11-17T08:30:00Z',
      targetReportCount: 3
    },
    // ...
  ],
  pagination: { total: 25, page: 1, limit: 10 },
  stats: { pending: 12, inProgress: 5, resolved: 8 }
}
```

### 2. 신고 처리

```javascript
PATCH /api/v1/admin/reports/{reportId}/resolve

Body:
{
  action: 'SUSPEND_AND_DELETE', // WARN | SUSPEND | DELETE | REJECT
  duration: '7_DAYS',           // 정지 기간 (정지 시)
  reason: '광고성 메시지 반복 확인',
  memo: '...',
  notifyReporter: true,
  notifyTarget: true
}

Response:
{
  success: true,
  report: { id: 1, status: 'RESOLVED', resolvedBy: 1, resolvedAt: '...' },
  actions: {
    targetSuspended: true,
    contentDeleted: true,
    emailsSent: 2
  }
}
```

### 3. 우선순위 변경

```javascript
PATCH /api/v1/admin/reports/{reportId}/priority

Body:
{
  priority: 'URGENT',
  reason: '누적 신고 3건 도달'
}
```

---

## 📱 반응형 설계

### Mobile 카드 레이아웃

```
┌────────────────────────┐
│ 🔴 긴급 - 스팸 신고     │
│                        │
│ 대상: 코딩테스트 스터디 │
│ 신고자: 김철수         │
│                        │
│ 2시간 전 신고           │
│ 상태: 미처리           │
│                        │
│ [상세] [처리] [기각]   │
└────────────────────────┘
```

---

## ✅ 구현 체크리스트

- [ ] 신고 목록 API 연동
- [ ] 우선순위 자동 계산
- [ ] 신고 상세 모달
- [ ] 처리 액션 (경고/정지/삭제/기각)
- [ ] 일괄 처리
- [ ] 증거 자료 표시
- [ ] 처리 시간 통계
- [ ] 이메일 통보
- [ ] 우측 위젯
- [ ] 반응형

---

**다음 화면**: `21_admin-analytics.md` (통계 분석)
