# 스터디 프리뷰 (Study Preview)

> **화면 ID**: `STUDY-EXPLORE-03`  
> **라우트**: `/studies/[studyId]`  
> **목적**: 미가입자를 위한 스터디 상세 정보 (제한적)  
> **사용자 상태**: 미가입 (탐색 중)  
> **렌더링**: SSR (SEO 최적화)

---

## ? 화면 목적

**"가입 전 스터디 미리보기"**
- 가입 결정에 필요한 정보만 선별 제공
- 제한된 정보로 가입 욕구 자극 (FOMO)
- 큰 [가입하기] 버튼으로 전환 유도
- 가입 후 자동으로 `/my-studies/[studyId]`로 이동

---

## ? 레이아웃 구조 (FHD 최적화)

```
┌─────┬─────────────────────────────────────────────────────┬──────────────────┐
│     │ ← 스터디 탐색으로                                    │                  │
│ Nav ├─────────────────────────────────────────────────────┤  관련 정보       │
│ 12% │ ┌─────────────────────────────────────────────────┐ │  (280px)         │
│     │ │ ? 알고리즘 마스터 스터디        [? 탐색 중]   │ │                  │
│     │ │                                                 │ │  ? 스터디 정보   │
│     │ │ OWNER: 김철수 | 12/20명 | 프로그래밍            │ │  생성: 2025.10.01│
│     │ │                                                 │ │  활동: 매일       │
│     │ │ [? 가입하기 - 자동 승인]                       │ │  공개: 전체       │
│     │ │                                                 │ │                  │
│     │ │ ?? 가입 후 모든 기능 이용 가능                  │ │  ? 그룹장        │
│     │ └─────────────────────────────────────────────────┘ │  김철수          │
│     │                                                     │  백엔드 개발자    │
│     │ ┌───────────────────────────────────────────────┐   │                  │
│ ?  │ │ ? 스터디 소개                                 │   │  ? 멤버 (12명)  │
│ ?  │ │                                               │   │  ? 김철수 (OWNER)│
│ ?  │ │ 매일 아침 알고리즘 문제를 풀고                 │   │  ? 이영희 (ADMIN)│
│ ?  │ │ 서로의 풀이를 공유하며 성장하는 스터디         │   │  ? 박민수        │
│ ?  │ │                                               │   │  ? 최지은        │
│ ?  │ │ ? 매일 오전 9시 문제 공유                     │   │  ? 정소현        │
│     │ │ ? 저녁 8시 코드 리뷰                          │   │  ... 외 7명      │
│     │ │ ? 주 1회 모의 테스트                          │   │  ? 전체 멤버는  │
│     │ │                                               │   │     가입 후 확인 │
│     │ │ ?? #알고리즘 #코테 #매일 #백준               │   │                  │
│     │ └───────────────────────────────────────────────┘   │  ? 유사 스터디  │
│     │                                                     │  ? 코테 정복     │
│     │ ┌───────────────────────────────────────────────┐   │  ? 알고리즘 A-Z  │
│     │ │ ? 최근 공지 (2개만 미리보기)                  │   │  ? 면접 대비     │
│     │ │                                               │   │                  │
│     │ │ ? 이번 주 일정 안내                          │   │  ? 가입 혜택    │
│     │ │    김철수 · 2시간 전                          │   │  ? 실시간 채팅   │
│     │ │    이번 주는 백준 골드로... (2줄만)           │   │  ? 파일 공유     │
│     │ │    ? 전체 내용은 가입 후 확인                │   │  ? 일정 관리     │
│     │ │                                               │   │  ? 화상 스터디   │
│     │ │ ? 참고 자료 공유                             │   │                  │
│     │ │    이영희 · 1일 전                            │   │                  │
│     │ │    알고리즘 학습... (2줄만)                   │   │                  │
│     │ │    ? 전체 내용은 가입 후 확인                │   │                  │
│     │ │                                               │   │                  │
│     │ │ ?? 가입하면 모든 공지를 확인할 수 있습니다    │   │                  │
│     │ └───────────────────────────────────────────────┘   │                  │
│     │                                                     │                  │
│     │              [? 가입하기]                          │                  │
│     │                                                     │                  │
└─────┴─────────────────────────────────────────────────────┴──────────────────┘
```

**레이아웃 비율**:
- 좌측 네비게이션: 12% (240px)
- 메인 콘텐츠: 58% (최대 900px)
- 우측 정보: 30% (280px)

---

**레이아웃 비율** (해상도별 자동 조정):

### 🖥️ FHD (1920px) - 기본 기준
- 좌측 네비게이션: **12%** (min: 200px, max: 240px)
- 메인 콘텐츠: **58%** (min: 800px, max: 1100px)
- 우측 정보: **30%** (min: 260px, max: 320px)
- 갭(여백): **2%**

### 🖥️ QHD (2560px) - 고해상도
- 좌측 네비게이션: **10%** (min: 240px, max: 280px)
- 메인 콘텐츠: **60%** (min: 1100px, max: 1500px)
- 우측 정보: **28%** (min: 320px, max: 400px)
- 갭(여백): **2%**

### 🖥️ 4K (3840px) - 초고해상도
- 좌측 네비게이션: **8%** (min: 280px, max: 320px)
- 메인 콘텐츠: **62%** (min: 1500px, max: 2000px)
- 우측 정보: **28%** (min: 400px, max: 500px)
- 갭(여백): **2%**

### 📱 반응형 브레이크포인트
- **Desktop Small (1440px)**: 15% / 55% / 28%
- **Tablet (1024px)**: 5% / 65% / 28%
- **Mobile (<768px)**: 100% 단일 컬럼

---

## ? 섹션별 상세 설계

### 1. 페이지 헤더

```
┌──────────────────────────────────────────────────────────┐
│ ← 스터디 탐색으로                                         │
└──────────────────────────────────────────────────────────┘
```

**뒤로가기**:
- 클릭 → `/studies` (탐색 목록)
- 아이콘 + 텍스트 (명확성)

---

### 2. 스터디 헤더 카드 (상단 고정)

```
┌─────────────────────────────────────────────────────────┐
│ ? 알고리즘 마스터 스터디                [? 탐색 중]    │
│                                                         │
│ OWNER: 김철수  |  12/20명  |  프로그래밍               │
│                                                         │
│ [? 가입하기 - 자동 승인]    ← 큰 버튼, Primary        │
│                                                         │
│ ?? 가입하면 채팅, 파일, 캘린더 등 모든 기능을            │
│    이용할 수 있습니다                                    │
└─────────────────────────────────────────────────────────┘
```

**구성 요소**:

1. **스터디명 + 상태 배지**
   - 이모지 (48px)
   - 제목 (text-2xl, Bold)
   - [? 탐색 중] 배지 (회색, 우측 상단)

2. **메타 정보**
   - 그룹장, 멤버 수, 카테고리
   - text-sm, gray-600
   - 구분자: |

3. **[가입하기] 버튼**
   - 스타일: Primary, Large
   - 너비: 100%
   - 높이: 56px
   - 아이콘: ? (하트)
   - 텍스트: "가입하기 - 자동 승인" (또는 "가입 신청하기")

4. **안내 메시지**
   - 배경: yellow-50
   - 아이콘: ??
   - 가입 후 혜택 강조

**스타일**:
```css
.preview-header {
  background: white;
  border: 2px solid #6366F1;
  border-radius: 12px;
  padding: 24px;
  margin-bottom: 24px;
  box-shadow: 0 4px 12px rgba(99, 102, 241, 0.1);
}
```

---

### 3. 스터디 소개 섹션

```
┌─────────────────────────────────────────────────────────┐
│ ? 스터디 소개                                           │
│                                                         │
│ 매일 아침 알고리즘 문제를 풀고                           │
│ 서로의 풀이를 공유하며 성장하는 스터디입니다.             │
│                                                         │
│ ? 매일 오전 9시 문제 공유                               │
│ ? 저녁 8시 코드 리뷰                                    │
│ ? 주 1회 모의 코딩테스트                                │
│                                                         │
│ ? 목표: 3개월 안에 알고리즘 100문제 달성                │
│                                                         │
│ ?? #알고리즘 #코딩테스트 #매일 #백준 #프로그래머스      │
└─────────────────────────────────────────────────────────┘
```

**표시 정보**:
- ? 전체 소개글 (제한 없음)
- ? 운영 방식
- ? 목표
- ? 모든 태그

---

### 4. 최근 공지 미리보기 (제한적)

```
┌─────────────────────────────────────────────────────────┐
│ ? 최근 공지 (2개만 미리보기)                            │
│                                                         │
│ ┌───────────────────────────────────────────────────┐   │
│ │ ? 이번 주 일정 안내                               │   │
│ │    김철수 · 2시간 전                               │   │
│ │                                                   │   │
│ │    이번 주는 백준 골드 문제로 진행합니다.          │   │
│ │    월요일 오전 9시까지 풀이를...                   │   │
│ │    (최대 100자만 표시)                             │   │
│ │                                                   │   │
│ │    ? 전체 내용은 가입 후 확인                     │   │
│ └───────────────────────────────────────────────────┘   │
│                                                         │
│ ┌───────────────────────────────────────────────────┐   │
│ │ ? 참고 자료 공유                                  │   │
│ │    이영희 · 1일 전                                 │   │
│ │                                                   │   │
│ │    알고리즘 학습에 도움되는 자료를...              │   │
│ │    (최대 100자만 표시)                             │   │
│ │                                                   │   │
│ │    ? 전체 내용은 가입 후 확인                     │   │
│ └───────────────────────────────────────────────────┘   │
│                                                         │
│ ?? 가입하면 모든 공지를 확인하고 댓글을 작성할 수        │
│    있습니다                                             │
└─────────────────────────────────────────────────────────┘
```

**표시 제한**:
- 최근 2개만
- 제목 + 작성자 + 시간 (전체)
- 내용: 최대 100자 + "..." (말줄임)
- ? 잠금 아이콘으로 제한 강조
- 첨부파일 개수 표시 (다운로드 불가)

**스타일**:
```css
.preview-notice {
  background: #F9FAFB;
  border: 1px solid #E5E7EB;
  border-radius: 8px;
  padding: 16px;
  margin-bottom: 12px;
  position: relative;
  opacity: 0.9;
}

.preview-notice::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 40px;
  background: linear-gradient(
    to bottom,
    rgba(249, 250, 251, 0),
    rgba(249, 250, 251, 1)
  );
  border-radius: 0 0 8px 8px;
}
```

---

## ? 우측 정보 위젯 (280px)

### 1?? 스터디 정보

```
┌─────────────────────────────────────┐
│ ? 스터디 정보                       │
│                                     │
│ ? 생성일                            │
│    2025년 10월 1일                  │
│                                     │
│ ? 활동 빈도                         │
│    매일                             │
│                                     │
│ ?? 공개 설정                         │
│    전체 공개                         │
│                                     │
│ ? 가입 승인                         │
│    자동 승인                         │
│                                     │
│ ?? 카테고리                          │
│    프로그래밍 > 알고리즘/코테        │
└─────────────────────────────────────┘
```

---

### 2?? 그룹장 정보

```
┌─────────────────────────────────────┐
│ ? 그룹장                            │
│                                     │
│ [프로필 이미지]                      │
│                                     │
│ 김철수                               │
│ 백엔드 개발자                        │
│                                     │
│ "함께 성장하는 스터디를 만들어요!"   │
└─────────────────────────────────────┘
```

---

### 3?? 멤버 미리보기 (5명만)

```
┌─────────────────────────────────────┐
│ ? 멤버 (12명)                       │
│                                     │
│ ? 김철수 (OWNER)                    │
│ ? 이영희 (ADMIN)                    │
│ ? 박민수                             │
│ ? 최지은                             │
│ ? 정소현                             │
│                                     │
│ ... 외 7명                          │
│                                     │
│ ? 전체 멤버 및 연락처는             │
│    가입 후 확인 가능                 │
└─────────────────────────────────────┘
```

**제한**:
- 상위 5명만 표시
- 이름 + 역할만 (OWNER/ADMIN만)
- 온라인 상태 숨김
- 연락처 숨김

---

### 4?? 유사한 스터디 추천

```
┌─────────────────────────────────────┐
│ ? 유사한 스터디                     │
│                                     │
│ ? 코딩테스트 정복                   │
│    18/20명 · 프로그래밍              │
│    [미리보기]                       │
│                                     │
│ ? 알고리즘 A to Z                   │
│    12/15명 · 프로그래밍              │
│    [미리보기]                       │
│                                     │
│ ? 면접 대비 스터디                  │
│    8/10명 · 취업준비                 │
│    [미리보기]                       │
│                                     │
│ [더 많은 스터디 보기 →]             │
└─────────────────────────────────────┘
```

---

### 5?? 가입 혜택

```
┌─────────────────────────────────────┐
│ ? 가입하면 이용 가능                │
│                                     │
│ ? 실시간 채팅                        │
│   멤버들과 자유롭게 소통             │
│                                     │
│ ? 파일 공유                          │
│   자료, 문제, 풀이 공유              │
│                                     │
│ ? 일정 관리                          │
│   스터디 일정 확인 및 등록           │
│                                     │
│ ? 할일 관리                          │
│   개인/그룹 할일 관리                │
│                                     │
│ ? 화상 스터디                        │
│   실시간 화상 통화                   │
│                                     │
│ [지금 바로 가입하기 →]              │
└─────────────────────────────────────┘
```

---

## ? 사용자 인터랙션

### 1. 페이지 진입 시 가입 여부 체크

```javascript
// SSR 레벨에서 체크
export default async function StudyPreviewPage({ params }) {
  const session = await getServerSession()
  const { studyId } = params
  
  // 로그인된 경우 가입 여부 확인
  if (session) {
    const membership = await checkMembership(studyId, session.user.id)
    
    if (membership) {
      // 이미 가입됨 → 내 스터디로 리다이렉트
      redirect(`/my-studies/${studyId}`)
    }
  }
  
  // 미가입 → 프리뷰 표시
  const study = await getStudyPreview(studyId)
  
  if (!study) {
    notFound()
  }
  
  if (study.visibility === 'PRIVATE') {
    // 비공개 스터디는 초대 토큰 필요
    const inviteToken = searchParams.get('invite')
    if (!inviteToken || !validateInviteToken(inviteToken)) {
      notFound()
    }
  }
  
  return <StudyPreviewView study={study} />
}
```

---

### 2. [가입하기] 버튼 클릭

```javascript
const handleJoin = async () => {
  if (!session) {
    // 미로그인 → 로그인 페이지
    router.push(`/sign-in?redirect=/studies/${studyId}`)
    return
  }
  
  try {
    setIsJoining(true)
    
    // API 호출
    const response = await api.post(`/api/v1/studies/${studyId}/join`, {
      message: joinMessage // 선택적 가입 인사
    })
    
    // 성공 처리
    if (response.data.autoApprove) {
      // 자동 승인
      toast.success('가입이 완료되었습니다! ?')
      router.push(`/my-studies/${studyId}`)
    } else {
      // 수동 승인 대기
      toast.success('가입 신청이 완료되었습니다. 승인을 기다려주세요.')
      router.push(`/my-studies/${studyId}`) // PENDING 상태로 접근
    }
    
  } catch (error) {
    if (error.code === 'ALREADY_JOINED') {
      toast.info('이미 가입된 스터디입니다')
      router.push(`/my-studies/${studyId}`)
    } else if (error.code === 'STUDY_FULL') {
      toast.error('정원이 마감되었습니다')
    } else if (error.code === 'PRIVATE_STUDY') {
      toast.error('비공개 스터디입니다. 초대 링크가 필요합니다.')
    } else {
      toast.error('가입 신청 중 오류가 발생했습니다')
    }
  } finally {
    setIsJoining(false)
  }
}
```

---

### 3. API 엔드포인트 (프리뷰 전용)

```typescript
// GET /api/v1/studies/[studyId]/preview
export async function GET(
  request: Request,
  { params }: { params: { studyId: string } }
) {
  const { studyId } = params
  
  const study = await prisma.studyGroup.findUnique({
    where: { id: parseInt(studyId) },
    include: {
      owner: {
        select: {
          id: true,
          name: true,
          imageUrl: true,
          bio: true
        }
      },
      members: {
        take: 5, // 상위 5명만
        orderBy: { createdAt: 'asc' },
        include: {
          user: {
            select: {
              id: true,
              name: true,
              imageUrl: true
            }
          }
        }
      },
      notices: {
        take: 2, // 최근 2개만
        orderBy: { createdAt: 'desc' },
        select: {
          id: true,
          title: true,
          content: true,
          createdAt: true,
          author: {
            select: { name: true }
          },
          _count: {
            select: { attachments: true }
          }
        }
      },
      _count: {
        select: {
          members: true,
          notices: true,
          files: true
        }
      }
    }
  })
  
  if (!study) {
    return new Response('Not Found', { status: 404 })
  }
  
  // 민감한 정보 제거 및 제한
  const previewData = {
    ...study,
    notices: study.notices.map(notice => ({
      ...notice,
      content: notice.content.substring(0, 100) + '...', // 100자만
      hasAttachments: notice._count.attachments > 0,
      attachmentCount: notice._count.attachments
    })),
    memberCount: study._count.members,
    noticeCount: study._count.notices,
    fileCount: study._count.files,
    hasMoreMembers: study._count.members > 5,
    // 채팅, 파일, 일정, 할일 정보는 제외
  }
  
  return Response.json(previewData)
}
```

---

## ? 정보 접근 제한 상세

### ? 공개 정보 (100%)
- 스터디명, 소개
- 카테고리, 태그
- 그룹장 정보 (이름, 프로필, 소개)
- 멤버 수
- 생성일, 활동 빈도
- 공개 설정, 승인 방식

### ?? 제한적 정보 (미리보기)
- 최근 공지 2개 (제목 + 100자)
- 상위 멤버 5명 (이름 + 역할만)
- 활동 통계 (개수만)

### ? 접근 불가 (전체 숨김)
- 채팅 내용
- 파일 목록
- 캘린더 상세
- 할일 목록
- 멤버 연락처
- 온라인 상태

---

## ? 반응형 설계

### Desktop (1920px)
```css
.preview-layout {
  display: grid;
  grid-template-columns: 240px 1fr 280px;
  gap: 20px;
}
```

### Tablet (1024px)
```css
.preview-layout {
  grid-template-columns: 60px 1fr 240px;
  gap: 16px;
}
```

### Mobile (<768px)
```css
.preview-layout {
  display: flex;
  flex-direction: column;
}

.info-widgets {
  order: 3;
  margin-top: 24px;
}
```

---

## ? 구현 체크리스트

### Phase 1: 레이아웃
- [ ] 3컬럼 레이아웃
- [ ] 헤더 카드 (가입 버튼 강조)
- [ ] 우측 정보 위젯

### Phase 2: 정보 표시
- [ ] 스터디 소개 (전체)
- [ ] 공지 미리보기 (2개, 100자 제한)
- [ ] 멤버 미리보기 (5명)
- [ ] 스터디 정보
- [ ] 그룹장 정보

### Phase 3: 가입 기능
- [ ] 가입 여부 체크 (SSR)
- [ ] [가입하기] 버튼
- [ ] 가입 API 연동
- [ ] 자동 리다이렉트

### Phase 4: 제한 표시
- [ ] ? 잠금 아이콘
- [ ] 그라디언트 페이드 아웃
- [ ] "가입 후 확인" 메시지
- [ ] 가입 혜택 강조

### Phase 5: UX 개선
- [ ] 유사 스터디 추천
- [ ] 가입 혜택 리스트
- [ ] SEO 메타 태그
- [ ] 반응형 테스트

---

## ? UX 최적화 포인트 (FOMO 전략)

1. **제한된 정보**: 100자 미리보기로 호기심 자극
2. **시각적 제한**: ? 아이콘, 그라디언트로 잠금 강조
3. **혜택 강조**: "가입하면 이용 가능" 리스트
4. **큰 버튼**: [가입하기] 버튼을 상단/하단 2곳 배치
5. **즉시 전환**: 가입 후 바로 전체 기능으로 이동
6. **사회적 증거**: 멤버 수, 활동 빈도 강조

---

**다음 화면**: `04_my-study-list.md` (내 스터디 목록)
