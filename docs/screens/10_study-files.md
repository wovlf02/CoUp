# 10. 스터디 파일 공유 (Study Files)

> **화면 ID**: `STUDY-04`  
> **라우트**: `/studies/[studyId]/files`  
> **레이아웃**: 좌측 네비게이션(15%) + 우측 콘텐츠(85%)  
> **렌더링**: CSR

---

## 📐 화면 구조

```
┌────────┬───────────────────────────────────────────────────────┐
│        │  📚 코딩테스트 마스터 스터디                           │
│  Nav   │  ┌──────────────────────────────────────────────────┐ │
│  Bar   │  │ [개요] [채팅] [공지] [파일] [캘린더] [할일]       │ │
│        │  └──────────────────────────────────────────────────┘ │
│ 🏠     │                                                       │
│ 🔍     │  파일 공유                                             │
│ 👥     │                                                       │
│ 📋     │  ┌─────────────────────────────────────────────────┐  │
│ 🔔     │  │  파일을 드래그하거나 클릭하여 업로드               │  │
│ 👤     │  │           [파일 선택]                             │  │
│        │  │  최대 50MB (PDF, DOC, XLS, ZIP, 이미지)           │  │
│        │  └─────────────────────────────────────────────────┘  │
│        │                                                       │
│        │  전체 파일 (12개)                                      │
│        │                                                       │
│        │  ┌──────────────────────────────────────────────────┐ │
│        │  │ 📄 알고리즘_문제집.pdf                           │ │
│        │  │ 김철수 · 2.5MB · 2시간 전          [다운] [삭제] │ │
│        │  └──────────────────────────────────────────────────┘ │
│        │                                                       │
│        │  ┌──────────────────────────────────────────────────┐ │
│        │  │ 📊 면접_준비_자료.xlsx                           │ │
│        │  │ 이영희 · 1.2MB · 1일 전                [다운]    │ │
│        │  └──────────────────────────────────────────────────┘ │
│        │                                                       │
└────────┴───────────────────────────────────────────────────────┘
```

---

## 🎨 섹션별 상세 설계

### 1. 파일 업로드 영역
```
┌─────────────────────────────────────────────────────────┐
│                                                         │
│        파일을 드래그하거나 클릭하여 업로드               │
│                  [파일 선택]                             │
│                                                         │
│    최대 50MB (PDF, DOC, XLS, ZIP, 이미지)                │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

**드래그 앤 드롭 영역**:
- 높이: 200px
- 배경: gray-50
- 테두리: 2px dashed gray-300
- 둥근 모서리: 12px

**드래그 오버 시**:
- 배경: primary-50
- 테두리: primary-400

**업로드 중**:
```
┌─────────────────────────────────────────────────────────┐
│                                                         │
│        업로드 중... 45%                                  │
│  ████████████░░░░░░░░░░░░░░░░                           │
│                                                         │
│        알고리즘_문제집.pdf (2.5MB)                       │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

---

### 2. 파일 목록
```
전체 파일 (12개)                          [정렬: 최신순 ▼]

┌──────────────────────────────────────────────────────────┐
│ 📄 알고리즘_문제집.pdf                                    │
│ 김철수 · 2.5MB · 2시간 전                  [다운] [삭제] │
└──────────────────────────────────────────────────────────┘
```

**파일 카드**:
- 배경: white
- 테두리: 1px solid gray-200
- 패딩: 16px 20px
- Hover: shadow-sm

**파일 정보**:
1. 파일 아이콘 (좌측, 32px)
   - PDF: 📄, DOC: 📝, XLS: 📊, 이미지: 🖼️, 기타: 📦
2. 파일명 (text-base, Bold, gray-900)
   - 최대 1줄, 초과 시 ...
3. 메타 정보 (text-sm, gray-600)
   - 업로더 + 크기 + 업로드 시간
4. 액션 버튼 (우측)
   - [다운로드] (Primary, Icon)
   - [삭제] (Danger, Icon, 업로더/관리자만)

**정렬 옵션**:
- 최신순 (기본)
- 이름순
- 크기순

---

### 3. 파일 미리보기 모달 (이미지만)
```
┌────────────────────────────────────────────────────────┐
│ 알고리즘_다이어그램.png                          [X]   │
├────────────────────────────────────────────────────────┤
│                                                        │
│                                                        │
│                   [이미지 표시]                         │
│                                                        │
│                                                        │
├────────────────────────────────────────────────────────┤
│ 김철수 · 1.2MB · 2시간 전                              │
│                                      [다운로드] [닫기] │
└────────────────────────────────────────────────────────┘
```

---

## 🎬 인터랙션

### 파일 업로드 흐름
```javascript
const handleUpload = async (file) => {
  // 1. Pre-signed URL 요청
  const { uploadUrl, fileUrl } = await api.post(
    `/api/v1/studies/${studyId}/files/upload`,
    {
      fileName: file.name,
      fileType: file.type,
      fileSize: file.size
    }
  )
  
  // 2. S3에 직접 업로드
  await axios.put(uploadUrl, file, {
    headers: { 'Content-Type': file.type },
    onUploadProgress: (e) => {
      setProgress(Math.round((e.loaded * 100) / e.total))
    }
  })
  
  // 3. 메타데이터 저장
  await api.post(`/api/v1/studies/${studyId}/files`, {
    name: file.name,
    url: fileUrl,
    size: file.size,
    mimeType: file.type
  })
  
  toast.success('파일이 업로드되었습니다!')
  refetch()
}
```

### 파일 다운로드
```javascript
const handleDownload = (fileUrl, fileName) => {
  const link = document.createElement('a')
  link.href = fileUrl
  link.download = fileName
  link.click()
}
```

### 파일 삭제
```javascript
const handleDelete = async (fileId) => {
  if (!confirm('파일을 삭제하시겠습니까?')) return
  
  await api.delete(`/api/v1/studies/${studyId}/files/${fileId}`)
  
  toast.success('파일이 삭제되었습니다!')
  refetch()
}
```

---

## 🔒 제한 사항

### 파일 크기
- 최대: 50MB
- 초과 시: "파일 크기는 50MB를 초과할 수 없습니다."

### 파일 형식
- 허용: PDF, DOC, DOCX, XLS, XLSX, PPT, PPTX, ZIP, JPG, PNG, GIF
- 거부: 실행 파일 (EXE, BAT, SH 등)

### 권한
- 업로드: 모든 멤버
- 삭제: 업로더 본인 또는 관리자

---

## 📱 반응형 설계

### Desktop
- 파일 카드: 전체 너비
- 2컬럼 그리드 (선택적)

### Mobile
- 파일 카드: 전체 너비
- 1컬럼
- 액션 버튼: 아이콘만

---

## 📐 ASCII 스케치

```
┌──────┬──────────────────────────────────────────────────┐
│      │ 📚 코딩테스트 스터디                              │
│ 🏠   │ [개요] [채팅] [공지] [파일] [캘린더] [할일]       │
│ 🔍   │                                                  │
│ 👥   │ 파일 공유                                         │
│ 📋   │                                                  │
│ 🔔   │ ┌──────────────────────────────────────────────┐│
│ 👤   │ │ 파일 드래그 또는 [파일 선택]                  ││
│      │ └──────────────────────────────────────────────┘│
│      │                                                  │
│      │ 전체 파일 (12개)                                  │
│      │                                                  │
│      │ ┌──────────────────────────────────────────────┐│
│      │ │ 📄 알고리즘_문제집.pdf    [다운] [삭제]      ││
│      │ │ 김철수 · 2.5MB · 2시간 전                    ││
│      │ └──────────────────────────────────────────────┘│
│      │                                                  │
└──────┴──────────────────────────────────────────────────┘
```

---

## ✅ 완료 체크리스트

- [ ] 드래그 앤 드롭 업로드
- [ ] 파일 선택 버튼
- [ ] S3 Pre-signed URL 업로드
- [ ] 업로드 진행률 표시
- [ ] 파일 목록 표시
- [ ] 파일 다운로드
- [ ] 파일 삭제 (권한 체크)
- [ ] 파일 크기/형식 검증
- [ ] 이미지 미리보기 모달

---

**다음 화면**: `11_study-calendar.md` (캘린더)
