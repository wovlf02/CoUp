# Production 기능 명세: 02. 그룹 관리 자동화 (그룹 마스터 시스템)

## 1. 개요

- 스터디 그룹 운영에서 발생하는 반복적이고 번거로운 관리 업무(출결, 벌금, 규칙 공지 등)를 자동화하여, 그룹장과 그룹원 모두가 스터디 본연의 목적에만 집중할 수 있도록 돕는다.
- 이 자동화 시스템을 '그룹 마스터'로 명명한다.

## 2. 사용자 스토리 (User Stories)

### 2.1. 규칙 설정

- **US-1.1**: 그룹장은 '그룹 관리' 페이지에서 그룹 마스터 설정을 활성화할 수 있다.
- **US-1.2**: 그룹장은 다음과 같은 자동화 규칙을 설정할 수 있다.
  - **출석 체크 규칙**: "매주 월, 수, 금 21:00 ~ 21:10 사이에 화상 스터디 참여 시 출석 인정"
  - **지각/결석 벌금 규칙**: "지각 시 1,000원, 결석 시 3,000원 벌금 부과"
  - **과제 제출 규칙**: "매주 일요일 23:59까지 칸반 보드의 '이번 주 과제' 카드 제출"
  - **규칙 리마인더**: "스터디 시작 10분 전, 과제 마감 1일 전에 그룹 채팅으로 자동 알림"

### 2.2. 예치금 및 벌금 시스템

- **US-2.1**: 그룹장은 그룹 규칙의 일환으로 멤버들에게 예치금을 걷도록 설정할 수 있다.
- **US-2.2**: 그룹에 가입하는 멤버는 설정된 예치금을 플랫폼 내 가상 지갑 또는 연동된 결제 수단을 통해 납부해야 가입이 완료된다.
- **US-2.3**: 그룹 마스터는 설정된 규칙에 따라 지각/결석/과제 미제출 시, 해당 멤버의 예치금에서 벌금을 자동으로 차감하여 그룹의 공동 벌금 계좌로 이체한다.
- **US-2.4**: 모든 벌금 부과 내역은 투명하게 기록되어 모든 그룹 멤버가 확인할 수 있다.
- **US-2.5**: 스터디 종료 시, 누적된 공동 벌금은 그룹장의 설정에 따라 멤버들에게 균등하게 분배되거나, 특정 목적(예: 커피 기프티콘)으로 사용될 수 있다.

### 2.3. 자동 출석 체크

- **US-3.1**: 그룹장이 설정한 출석 체크 시간에 화상 스터디 세션에 참여하면, 그룹 마스터가 자동으로 출석을 기록한다.
- **US-3.2**: 출석 인정 시간 내에 입장하지 않으면 `지각`으로, 세션에 아예 참여하지 않으면 `결석`으로 자동 처리된다.
- **US-3.3**: 그룹 멤버는 '출석부' 페이지에서 자신의 출석 현황(출석, 지각, 결석 횟수)을 한눈에 볼 수 있다.
- **US-3.4**: 그룹장은 수동으로 멤버의 출석 상태를 수정할 수 있다. (예: 부득이한 사정으로 불참한 경우 `결석`을 `출석`으로 변경)

### 2.4. 자동 리마인더

- **US-4.1**: 그룹 마스터는 설정된 규칙에 따라, 그룹 채팅 채널에 자동으로 알림 메시지를 보낸다.
  - 예: "(자동 알림) 스터디 시작 10분 전입니다."
  - 예: "(자동 알림) 이번 주 과제 마감일이 24시간 남았습니다."

## 3. 기술 아키텍처

- **스케줄링 (Scheduling)**: 설정된 시간에 특정 작업을 자동으로 실행하기 위해 **Quartz Scheduler** 또는 Spring의 내장 `@Scheduled` 어노테이션을 사용한다. 대규모 스케줄링이 필요할 경우, 별도의 스케줄러 서버를 구축하거나 AWS EventBridge와 같은 클라우드 서비스를 활용한다.
- **결제 연동**: 예치금 및 벌금 시스템을 위해 **Toss Payments, I'mport** 등 외부 PG(결제 대행)사와의 연동이 필요하다.
- **이벤트 기반 아키텍처**: '출석 체크', '벌금 부과' 등 각 이벤트는 비즈니스 서버에서 발생하고, 그 결과는 Redis Pub/Sub을 통해 시그널링 서버에 전달되어 클라이언트에게 실시간으로 알림을 보낸다.
